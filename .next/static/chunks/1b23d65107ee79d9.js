(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,949563,e=>{"use strict";let t;var a=e.i(726151),i=e.i(923041),r=e.i(662582),s=e.i(278124),l=e.i(269871);let n=({children:e,className:t,variant:n,duration:o=.4,delay:c=0,yOffset:d=6,inView:x=!1,inViewMargin:m="-50px",blur:u="6px"})=>{let h=(0,i.useRef)(null),p=(0,l.useInView)(h,{once:!0,margin:m}),b={hidden:{y:d,opacity:0,filter:`blur(${u})`},visible:{y:-d,opacity:1,filter:"blur(0px)"}};return(0,a.jsx)(s.AnimatePresence,{children:(0,a.jsx)(r.motion.div,{ref:h,initial:"hidden",animate:!x||p?"visible":"hidden",exit:"hidden",variants:n||b,transition:{delay:.04+c,duration:o,ease:"easeOut"},className:t,children:e})})};var o=e.i(832446),c=e.i(129828),d=e.i(557265),x=e.i(34345),m=e.i(728694),u=e.i(413698),h=e.i(86066),p=e.i(576161),b=e.i(718248),b=b,g=e.i(51278),f=e.i(651555),v=e.i(274453),k=e.i(843762),j=e.i(746115),y=e.i(305383),N=e.i(311977);e.i(621586);var w=e.i(910158),z=e.i(946200),C=e.i(850402),A=e.i(334905);let S=(0,i.createContext)(null),M={isSignedIn:!1,isLoading:!0,isCollaborator:!1,isAdmin:!1,collaborator:null,privateTracks:[],isLoadingTracks:!1,hasPrivateAccess:!1};function P({children:e}){let{isSignedIn:t,isLoaded:r}=(0,z.useUser)(),s=(0,C.useQuery)(A.api.privateMusic.getMyCollaboratorStatus,t?{}:"skip"),l=(0,C.useQuery)(A.api.privateMusic.getMyPrivateTracks,s?.isCollaborator?{}:"skip"),n=(0,C.useMutation)(A.api.privateMusic.linkCollaboratorAccount);(0,i.useEffect)(()=>{t&&s&&!s.isCollaborator&&n().catch(()=>{})},[t,s,n]);let o=!r||t&&void 0===s,c=s?.isCollaborator&&void 0===l,d={isSignedIn:!!t,isLoading:o,isCollaborator:s?.isCollaborator??!1,isAdmin:s?.isAdmin??!1,collaborator:s?.collaborator??null,privateTracks:l??[],isLoadingTracks:!!c,hasPrivateAccess:!!s?.isCollaborator};return(0,a.jsx)(S.Provider,{value:d,children:e})}function T({children:e}){let[t,r]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{r(!0)},[]),t)?(0,a.jsx)(P,{children:e}):(0,a.jsx)(S.Provider,{value:M,children:e})}var $=e.i(413527),U=e.i(305583),E=e.i(364050),L=e.i(752153),I=e.i(8722),R=e.i(591372),D=e.i(739571),D=D;let V={type:"spring",stiffness:300,damping:30},O={type:"tween",duration:.15,ease:"easeOut"};function B({type:e="text",placeholder:t,value:i,onChange:r,icon:s,showToggle:l,onToggle:n,autoFocus:o}){return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[#3a4a45] pointer-events-none",children:(0,a.jsx)(s,{className:"w-3 h-3"})}),(0,a.jsx)("input",{type:e,value:i,onChange:e=>r(e.target.value),placeholder:t,autoFocus:o,autoComplete:"email"===e?"email":"password"===e?"current-password":"off",className:"w-full bg-[#697d75] border-2 border-[#1a2420] rounded-sm px-7 py-1.5 text-xs font-mono text-[#1a2420] placeholder:text-[#4a5a55] focus:outline-none focus:bg-[#7a8d85] transition-colors",style:{textShadow:"1px 1px 0 rgba(255,255,255,0.1)",boxShadow:"inset 2px 2px 0 rgba(0,0,0,0.2)"}}),l&&n&&(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),n()},className:"absolute right-2 top-1/2 -translate-y-1/2 text-[#3a4a45] hover:text-[#1a2420] transition-colors",children:"password"===e?(0,a.jsx)(x.Eye,{className:"w-3 h-3"}):(0,a.jsx)(m.EyeOff,{className:"w-3 h-3"})})]})}function _({onClick:e,disabled:t,loading:i,children:r,variant:s="primary"}){return(0,a.jsx)("button",{onClick:e,disabled:t||i,className:`w-full py-1.5 px-3 text-xs font-mono font-bold rounded-sm border-2 transition-all active:scale-95 ${"primary"===s?"bg-[#1a2420] border-[#1a2420] text-[#8fa39a] hover:bg-[#2a3a35] disabled:opacity-50":"bg-transparent border-[#3a4a45] text-[#1a2420] hover:bg-[#697d75] disabled:opacity-50"}`,style:{boxShadow:"primary"===s?"2px 2px 0 #0a1410":"none",textShadow:"primary"===s?"1px 1px 0 rgba(0,0,0,0.3)":"none"},children:(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[i&&(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}),r]})})}function F({onClose:e,onSuccess:t}){let{signIn:l,setActive:n,isLoaded:o}=(0,$.useSignIn)(),{signUp:d,setActive:x,isLoaded:m}=(0,$.useSignUp)(),{isSignedIn:u,user:h}=(0,z.useUser)(),[p,b]=(0,i.useState)("menu"),[g,f]=(0,i.useState)(""),[v,k]=(0,i.useState)(""),[j,y]=(0,i.useState)(!1),[N,w]=(0,i.useState)(""),[C,A]=(0,i.useState)(!1),[S,M]=(0,i.useState)(null),[P,T]=(0,i.useState)(0);(0,i.useEffect)(()=>{u&&h&&(b("success"),setTimeout(t,1e3))},[u,h,t]);let F=[{id:"signin",label:"Sign In",icon:D.default},{id:"signup",label:"Create Account",icon:U.User},{id:"back",label:"Back",icon:R.X}],Q=async()=>{if(o&&l){A(!0),M(null);try{let e=await l.create({identifier:g,password:v});"complete"===e.status&&(await n({session:e.createdSessionId}),b("success"),setTimeout(t,1500))}catch(i){let e=i?.errors?.[0]?.code,a=i?.errors?.[0]?.message||"Sign in failed";if("session_exists"===e||a.toLowerCase().includes("session")){b("success"),setTimeout(t,1500);return}M(a)}finally{A(!1)}}},W=async()=>{if(m&&d){A(!0),M(null);try{await d.create({emailAddress:g,password:v}),await d.prepareEmailAddressVerification({strategy:"email_code"}),b("verify")}catch(e){M(e?.errors?.[0]?.message||"Sign up failed")}finally{A(!1)}}},Y=async()=>{if(m&&d){A(!0),M(null);try{let e=await d.attemptEmailAddressVerification({code:N});"complete"===e.status&&(await x({session:e.createdSessionId}),b("success"),setTimeout(t,1500))}catch(e){M(e?.errors?.[0]?.message||"Invalid code")}finally{A(!1)}}};return(0,a.jsxs)("div",{className:"min-h-[200px] flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2 px-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(c.Lock,{className:"w-3 h-3 text-[#1a2420]"}),(0,a.jsxs)("span",{className:"text-[10px] font-bold text-[#1a2420] uppercase tracking-wider font-mono",children:["menu"===p&&"Private Access","signin"===p&&"Sign In","signup"===p&&"Create Account","verify"===p&&"Verify Email","success"===p&&"Welcome!"]})]}),"menu"!==p&&"success"!==p&&(0,a.jsx)("button",{onClick:()=>b("menu"),className:"text-[10px] font-mono text-[#3a4a45] hover:text-[#1a2420] transition-colors",children:"BACK"})]}),(0,a.jsxs)(s.AnimatePresence,{mode:"wait",children:["menu"===p&&(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:O,className:"flex-1",children:[(0,a.jsx)("div",{className:"space-y-1",children:F.map((t,i)=>(0,a.jsxs)("button",{onClick:()=>{var a;"back"===(a=t.id)?e():(b(a),M(null))},onFocus:()=>T(i),onMouseEnter:()=>T(i),className:`w-full flex items-center gap-2 p-2 rounded-sm transition-all font-mono ${P===i?"bg-[#1a2420] text-[#8fa39a]":"text-[#1a2420] hover:bg-[#697d75]"}`,children:[(0,a.jsx)(t.icon,{className:"w-3 h-3"}),(0,a.jsx)("span",{className:"text-xs font-medium flex-1 text-left",children:t.label}),(0,a.jsx)(L.ChevronRight,{className:"w-3 h-3 opacity-50"})]},t.id))}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t-2 border-[#697d75]",children:(0,a.jsx)("p",{className:"text-[9px] text-[#3a4a45] font-mono text-center leading-relaxed",children:"Sign in to access unreleased tracks and collaborator-only content."})})]},"menu"),"signin"===p&&(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:O,className:"flex-1 space-y-3",children:[(0,a.jsx)(B,{type:"email",placeholder:"Email",value:g,onChange:f,icon:E.Mail,autoFocus:!0}),(0,a.jsx)(B,{type:j?"text":"password",placeholder:"Password",value:v,onChange:k,icon:D.default,showToggle:!0,onToggle:()=>y(!j)}),S&&(0,a.jsx)(r.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"p-2 bg-red-900/30 border border-red-800/50 rounded-sm",children:(0,a.jsx)("p",{className:"text-[9px] text-red-300 font-mono",children:S})}),(0,a.jsx)(_,{onClick:Q,disabled:!g||!v,loading:C,children:"SIGN IN"}),(0,a.jsx)("button",{onClick:()=>{b("signup"),M(null)},className:"w-full text-[9px] text-[#3a4a45] font-mono hover:text-[#1a2420] transition-colors",children:"Need an account? Sign up"})]},"signin"),"signup"===p&&(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:O,className:"flex-1 space-y-3",children:[(0,a.jsx)(B,{type:"email",placeholder:"Email",value:g,onChange:f,icon:E.Mail,autoFocus:!0}),(0,a.jsx)(B,{type:j?"text":"password",placeholder:"Password (8+ chars)",value:v,onChange:k,icon:D.default,showToggle:!0,onToggle:()=>y(!j)}),S&&(0,a.jsx)(r.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"p-2 bg-red-900/30 border border-red-800/50 rounded-sm",children:(0,a.jsx)("p",{className:"text-[9px] text-red-300 font-mono",children:S})}),(0,a.jsx)(_,{onClick:W,disabled:!g||v.length<8,loading:C,children:"CREATE ACCOUNT"}),(0,a.jsx)("button",{onClick:()=>{b("signin"),M(null)},className:"w-full text-[9px] text-[#3a4a45] font-mono hover:text-[#1a2420] transition-colors",children:"Already have an account? Sign in"})]},"signup"),"verify"===p&&(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:O,className:"flex-1 space-y-3",children:[(0,a.jsx)("div",{className:"p-2 bg-[#697d75] border-2 border-[#1a2420] rounded-sm",children:(0,a.jsx)("p",{className:"text-[9px] text-[#1a2420] font-mono text-center",children:"Check your email for a 6-digit code"})}),(0,a.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,autoFocus:!0,className:"w-full bg-[#697d75] border-2 border-[#1a2420] rounded-sm px-3 py-2 text-center text-lg font-mono font-bold text-[#1a2420] placeholder:text-[#4a5a55] focus:outline-none focus:bg-[#7a8d85] tracking-[0.5em]",style:{textShadow:"1px 1px 0 rgba(255,255,255,0.1)",boxShadow:"inset 2px 2px 0 rgba(0,0,0,0.2)"}}),S&&(0,a.jsx)(r.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"p-2 bg-red-900/30 border border-red-800/50 rounded-sm",children:(0,a.jsx)("p",{className:"text-[9px] text-red-300 font-mono",children:S})}),(0,a.jsx)(_,{onClick:Y,disabled:6!==N.length,loading:C,children:"VERIFY"})]},"verify"),"success"===p&&(0,a.jsxs)(r.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:V,className:"flex-1 flex flex-col items-center justify-center",children:[(0,a.jsx)(r.motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,...V},className:"w-12 h-12 bg-[#1a2420] rounded-full flex items-center justify-center mb-3",children:(0,a.jsx)(I.Check,{className:"w-6 h-6 text-[#8fa39a]"})}),(0,a.jsx)(r.motion.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-sm font-mono font-bold text-[#1a2420]",children:"Welcome!"}),(0,a.jsx)(r.motion.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-[9px] font-mono text-[#3a4a45] mt-1",children:"Loading your tracks..."})]},"success")]})]})}var Q=e.i(183904),W=e.i(815418),W=W,Y=e.i(55841),G=e.i(254862),H=e.i(835185),K=e.i(974478);let q={initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2}},X={initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.15}};function J({onClose:e}){let[t,l]=(0,i.useState)("tracks");return(0,a.jsx)(r.motion.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,children:(0,a.jsxs)(r.motion.div,{className:"w-full max-w-2xl bg-gradient-to-b from-[#f5f5f5] to-[#e8e8e8] dark:from-zinc-800 dark:to-zinc-900 rounded-2xl shadow-2xl overflow-hidden",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-zinc-200 dark:border-zinc-700 bg-gradient-to-r from-zinc-100 to-zinc-50 dark:from-zinc-800 dark:to-zinc-850",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/40",children:(0,a.jsx)(u.Settings,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-zinc-800 dark:text-zinc-100",children:"Music Admin"}),(0,a.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"Manage tracks, collaborators & playlists"})]})]}),(0,a.jsx)("button",{onClick:e,className:"p-2 rounded-lg hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors",children:(0,a.jsx)(R.X,{className:"w-5 h-5 text-zinc-500"})})]}),(0,a.jsx)("div",{className:"flex gap-1 mt-4 p-1 bg-zinc-200/50 dark:bg-zinc-700/50 rounded-lg",children:[{id:"tracks",label:"Tracks",icon:d.Music2},{id:"collaborators",label:"Collaborators",icon:Q.Users},{id:"playlists",label:"Playlists",icon:W.default}].map(e=>(0,a.jsxs)("button",{onClick:()=>l(e.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${t===e.id?"bg-white dark:bg-zinc-600 text-zinc-800 dark:text-white shadow-sm":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300"}`,children:[(0,a.jsx)(e.icon,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.id))})]}),(0,a.jsx)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:(0,a.jsxs)(s.AnimatePresence,{mode:"wait",children:["tracks"===t&&(0,a.jsx)(Z,{},"tracks"),"collaborators"===t&&(0,a.jsx)(ee,{},"collaborators"),"playlists"===t&&(0,a.jsx)(et,{},"playlists")]})})]})})}function Z(){let e=(0,C.useQuery)(A.api.privateMusic.listAllPrivateTracks)||[],t=(0,C.useMutation)(A.api.privateMusic.addPrivateTrack),l=(0,C.useMutation)(A.api.privateMusic.deletePrivateTrack),[n,o]=(0,i.useState)(!1),[c,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)({title:"",artist:"",album:"",audioUrl:"",albumArt:"",notes:""}),h=async()=>{if(m.title&&m.artist&&m.audioUrl){x(!0);try{await t({title:m.title,artist:m.artist,album:m.album||void 0,audioUrl:m.audioUrl,albumArt:m.albumArt||void 0,notes:m.notes||void 0}),u({title:"",artist:"",album:"",audioUrl:"",albumArt:"",notes:""}),o(!1)}finally{x(!1)}}},p=async e=>{confirm("Delete this track?")&&await l({trackId:e})};return(0,a.jsxs)(r.motion.div,{...q,children:[(0,a.jsxs)("button",{onClick:()=>o(!n),className:"w-full flex items-center justify-center gap-2 p-3 mb-4 rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 hover:border-emerald-400 dark:hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors text-zinc-500 dark:text-zinc-400 hover:text-emerald-600 dark:hover:text-emerald-400",children:[(0,a.jsx)(Y.Plus,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Add Track"})]}),(0,a.jsx)(s.AnimatePresence,{children:n&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:(0,a.jsxs)("div",{className:"p-4 bg-zinc-100 dark:bg-zinc-800 rounded-lg space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Title *",value:m.title,onChange:e=>u({...m,title:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Artist *",value:m.artist,onChange:e=>u({...m,artist:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"})]}),(0,a.jsx)("input",{type:"text",placeholder:"Audio URL *",value:m.audioUrl,onChange:e=>u({...m,audioUrl:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Album (optional)",value:m.album,onChange:e=>u({...m,album:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Album Art URL (optional)",value:m.albumArt,onChange:e=>u({...m,albumArt:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"})]}),(0,a.jsx)("textarea",{placeholder:"Notes (optional)",value:m.notes,onChange:e=>u({...m,notes:e.target.value}),rows:2,className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400 resize-none"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>o(!1),className:"px-3 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200",children:"Cancel"}),(0,a.jsxs)("button",{onClick:h,disabled:c||!m.title||!m.artist||!m.audioUrl,className:"px-4 py-1.5 text-sm font-medium text-white bg-emerald-500 hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-md flex items-center gap-2",children:[c?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(I.Check,{className:"w-3 h-3"}),"Add Track"]})]})]})})}),(0,a.jsx)("div",{className:"space-y-2",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400 text-sm",children:"No private tracks yet. Add one above."}):e.map((e,t)=>(0,a.jsxs)(r.motion.div,{...X,transition:{delay:.05*t},className:"flex items-center gap-3 p-3 bg-white dark:bg-zinc-800/50 rounded-lg border border-zinc-200 dark:border-zinc-700 group",children:[e.albumArt?(0,a.jsx)("img",{src:e.albumArt,alt:"",className:"w-10 h-10 rounded object-cover"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded bg-zinc-200 dark:bg-zinc-700 flex items-center justify-center",children:(0,a.jsx)(d.Music2,{className:"w-5 h-5 text-zinc-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 truncate",children:[e.artist," ",e.album&&`â€¢ ${e.album}`]})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)("button",{onClick:()=>p(e.id),className:"p-1.5 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-zinc-400 hover:text-red-500 transition-colors",title:"Delete track",children:(0,a.jsx)(G.Trash2,{className:"w-4 h-4"})})})]},e.id))})]})}function ee(){let e=(0,C.useQuery)(A.api.privateMusic.listCollaborators)||[],t=(0,C.useMutation)(A.api.privateMusic.addCollaborator),l=(0,C.useMutation)(A.api.privateMusic.removeCollaborator),n=(0,C.useMutation)(A.api.privateMusic.updateCollaborator),[o,c]=(0,i.useState)(!1),[d,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)({email:"",displayName:"",role:"collaborator"}),h=async()=>{if(m.email){x(!0);try{await t({email:m.email,displayName:m.displayName||void 0,role:m.role}),u({email:"",displayName:"",role:"collaborator"}),c(!1)}finally{x(!1)}}},p=async e=>{confirm("Remove this collaborator?")&&await l({collaboratorId:e})},b=async(e,t)=>{await n({collaboratorId:e,isActive:!t})};return(0,a.jsxs)(r.motion.div,{...q,children:[(0,a.jsxs)("button",{onClick:()=>c(!o),className:"w-full flex items-center justify-center gap-2 p-3 mb-4 rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 hover:border-emerald-400 dark:hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors text-zinc-500 dark:text-zinc-400 hover:text-emerald-600 dark:hover:text-emerald-400",children:[(0,a.jsx)(H.UserPlus,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Invite Collaborator"})]}),(0,a.jsx)(s.AnimatePresence,{children:o&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:(0,a.jsxs)("div",{className:"p-4 bg-zinc-100 dark:bg-zinc-800 rounded-lg space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-md bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:[(0,a.jsx)(E.Mail,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5"}),(0,a.jsx)("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Enter the email they'll use to sign in. When they sign in with Clerk, they'll automatically get access."})]}),(0,a.jsx)("input",{type:"email",placeholder:"Email address *",value:m.email,onChange:e=>u({...m,email:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Display name (optional)",value:m.displayName,onChange:e=>u({...m,displayName:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsxs)("select",{value:m.role,onChange:e=>u({...m,role:e.target.value}),className:"px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200",children:[(0,a.jsx)("option",{value:"collaborator",children:"Collaborator"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>c(!1),className:"px-3 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200",children:"Cancel"}),(0,a.jsxs)("button",{onClick:h,disabled:d||!m.email,className:"px-4 py-1.5 text-sm font-medium text-white bg-emerald-500 hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-md flex items-center gap-2",children:[d?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(H.UserPlus,{className:"w-3 h-3"}),"Invite"]})]})]})})}),(0,a.jsx)("div",{className:"space-y-2",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400 text-sm",children:"No collaborators yet. Invite someone above."}):e.map((e,t)=>(0,a.jsxs)(r.motion.div,{...X,transition:{delay:.05*t},className:`flex items-center gap-3 p-3 rounded-lg border group ${e.isActive?"bg-white dark:bg-zinc-800/50 border-zinc-200 dark:border-zinc-700":"bg-zinc-100 dark:bg-zinc-800/30 border-zinc-200 dark:border-zinc-700/50 opacity-60"}`,children:[(0,a.jsx)("div",{className:`p-2 rounded-full ${"admin"===e.role?"bg-amber-100 dark:bg-amber-900/30":"bg-zinc-100 dark:bg-zinc-700"}`,children:"admin"===e.role?(0,a.jsx)(K.Shield,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}):(0,a.jsx)(U.User,{className:"w-4 h-4 text-zinc-500 dark:text-zinc-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.displayName||e.email}),e.isPending&&(0,a.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 rounded",children:"Pending"}),"admin"===e.role&&(0,a.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-zinc-200 dark:bg-zinc-700 text-zinc-600 dark:text-zinc-300 rounded",children:"Admin"})]}),(0,a.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 truncate",children:e.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:()=>b(e.id,e.isActive),className:`p-1.5 rounded transition-colors ${e.isActive?"hover:bg-amber-100 dark:hover:bg-amber-900/30 text-zinc-400 hover:text-amber-500":"hover:bg-emerald-100 dark:hover:bg-emerald-900/30 text-zinc-400 hover:text-emerald-500"}`,title:e.isActive?"Deactivate":"Activate",children:e.isActive?(0,a.jsx)(R.X,{className:"w-4 h-4"}):(0,a.jsx)(I.Check,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>p(e.id),className:"p-1.5 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-zinc-400 hover:text-red-500 transition-colors",title:"Remove",children:(0,a.jsx)(G.Trash2,{className:"w-4 h-4"})})]})]},e.id))})]})}function et(){let e=(0,C.useQuery)(A.api.privateMusic.listAllPlaylists)||[],t=(0,C.useQuery)(A.api.privateMusic.listAllPrivateTracks)||[],l=(0,C.useQuery)(A.api.privateMusic.listCollaborators)||[],n=(0,C.useMutation)(A.api.privateMusic.createPlaylist),o=(0,C.useMutation)(A.api.privateMusic.deletePlaylist),c=(0,C.useMutation)(A.api.privateMusic.addTrackToPlaylist),x=(0,C.useMutation)(A.api.privateMusic.removeTrackFromPlaylist),m=(0,C.useMutation)(A.api.privateMusic.grantPlaylistAccess),u=(0,C.useMutation)(A.api.privateMusic.revokePlaylistAccess),[h,p]=(0,i.useState)(!1),[b,g]=(0,i.useState)(!1),[f,v]=(0,i.useState)({name:"",description:""}),[k,y]=(0,i.useState)(null),N=async()=>{if(f.name){g(!0);try{await n({name:f.name,description:f.description||void 0}),v({name:"",description:""}),p(!1)}finally{g(!1)}}},w=async e=>{confirm("Delete this playlist?")&&await o({playlistId:e})},z=async(e,t,a)=>{a?await x({playlistId:e,trackId:t}):await c({playlistId:e,trackId:t})},S=async(e,t,a)=>{a?await u({playlistId:e,userId:t}):await m({playlistId:e,userId:t})};return(0,a.jsxs)(r.motion.div,{...q,children:[(0,a.jsxs)("button",{onClick:()=>p(!h),className:"w-full flex items-center justify-center gap-2 p-3 mb-4 rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 hover:border-emerald-400 dark:hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 transition-colors text-zinc-500 dark:text-zinc-400 hover:text-emerald-600 dark:hover:text-emerald-400",children:[(0,a.jsx)(Y.Plus,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Create Playlist"})]}),(0,a.jsx)(s.AnimatePresence,{children:h&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:(0,a.jsxs)("div",{className:"p-4 bg-zinc-100 dark:bg-zinc-800 rounded-lg space-y-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Playlist name *",value:f.name,onChange:e=>v({...f,name:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("textarea",{placeholder:"Description (optional)",value:f.description,onChange:e=>v({...f,description:e.target.value}),rows:2,className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400 resize-none"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>p(!1),className:"px-3 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200",children:"Cancel"}),(0,a.jsxs)("button",{onClick:N,disabled:b||!f.name,className:"px-4 py-1.5 text-sm font-medium text-white bg-emerald-500 hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-md flex items-center gap-2",children:[b?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(I.Check,{className:"w-3 h-3"}),"Create"]})]})]})})}),(0,a.jsx)("div",{className:"space-y-2",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400 text-sm",children:"No playlists yet. Create one above."}):e.map((e,i)=>{let n=k===e.id;return(0,a.jsxs)(r.motion.div,{...X,transition:{delay:.05*i},className:"bg-white dark:bg-zinc-800/50 rounded-lg border border-zinc-200 dark:border-zinc-700 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>y(n?null:e.id),className:"w-full flex items-center gap-3 p-3 hover:bg-zinc-50 dark:hover:bg-zinc-800 transition-colors",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/30",children:(0,a.jsx)(W.default,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"})}),(0,a.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[e.trackIds.length," tracks â€¢ ",e.allowedUserIds.length," users"]})]}),(0,a.jsx)(L.ChevronRight,{className:`w-4 h-4 text-zinc-400 transition-transform ${n?"rotate-90":""}`})]}),(0,a.jsx)(s.AnimatePresence,{children:n&&(0,a.jsx)(r.motion.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:(0,a.jsxs)("div",{className:"px-4 pb-4 space-y-4 border-t border-zinc-100 dark:border-zinc-700 pt-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 mb-2 flex items-center gap-1",children:[(0,a.jsx)(d.Music2,{className:"w-3 h-3"})," Tracks"]}),(0,a.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:t.map(t=>{let i=e.trackIds.includes(t.id);return(0,a.jsxs)("button",{onClick:()=>z(e.id,t.id,i),className:`w-full flex items-center gap-2 p-2 rounded text-left text-sm transition-colors ${i?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300":"hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-400"}`,children:[i?(0,a.jsx)(I.Check,{className:"w-3 h-3"}):(0,a.jsx)(Y.Plus,{className:"w-3 h-3 opacity-50"}),(0,a.jsx)("span",{className:"truncate",children:t.title})]},t.id)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 mb-2 flex items-center gap-1",children:[(0,a.jsx)(Q.Users,{className:"w-3 h-3"})," Access"]}),(0,a.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:l.filter(e=>"admin"!==e.role).map(t=>{let i=e.allowedUserIds.includes(t.userId);return(0,a.jsxs)("button",{onClick:()=>S(e.id,t.userId,i),className:`w-full flex items-center gap-2 p-2 rounded text-left text-sm transition-colors ${i?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300":"hover:bg-zinc-100 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-400"}`,children:[i?(0,a.jsx)(I.Check,{className:"w-3 h-3"}):(0,a.jsx)(Y.Plus,{className:"w-3 h-3 opacity-50"}),(0,a.jsx)("span",{className:"truncate",children:t.displayName||t.email})]},t.id)})})]}),(0,a.jsxs)("button",{onClick:()=>w(e.id),className:"w-full flex items-center justify-center gap-2 p-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:[(0,a.jsx)(G.Trash2,{className:"w-4 h-4"}),"Delete Playlist"]})]})})})]},e.id)})})]})}var ea=e.i(271119);function ei({tracks:e,currentTrack:t,isPlaying:l,onSelectAlbum:n,onSelectTrack:o,onTogglePlay:c}){let d,x=(d=new Map,e.forEach(e=>{let t=`${e.album}-${e.artist}`;d.has(t)||d.set(t,{name:e.album,artist:e.artist,albumArt:e.albumArt,tracks:[]}),d.get(t).tracks.push(e)}),Array.from(d.values())),[m,u]=(0,i.useState)(0),[b,g]=(0,i.useState)(0),f=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=x.findIndex(e=>e.tracks.some(e=>e.id===t.id));-1!==e&&e!==m&&(g(e>m?1:-1),u(e))},[t.id,x,m]);let v=(0,i.useCallback)(()=>{x.length<=1||(g(1),u(e=>(e+1)%x.length))},[x.length]),k=(0,i.useCallback)(()=>{x.length<=1||(g(-1),u(e=>(e-1+x.length)%x.length))},[x.length]);(0,i.useEffect)(()=>{let e=e=>{"ArrowLeft"===e.key?(e.preventDefault(),k()):"ArrowRight"===e.key?(e.preventDefault(),v()):("Enter"===e.key||" "===e.key)&&(e.preventDefault(),n(x[m]))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[v,k,m,x,n]);let j=x[m],y=j?.tracks.some(e=>e.id===t.id);return j?(0,a.jsxs)("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{ref:f,className:"relative w-full flex items-center justify-center",style:{perspective:"1000px"},children:[x.length>1&&(0,a.jsx)("button",{onClick:k,className:"absolute left-0 z-20 p-1.5 rounded-full bg-black/20 hover:bg-black/40 text-white/80 hover:text-white transition-all","aria-label":"Previous album",children:(0,a.jsx)(ea.ChevronLeft,{className:"w-5 h-5"})}),(0,a.jsx)(r.motion.div,{className:"relative cursor-pointer",drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,onDragEnd:(e,t)=>{t.offset.x>50?k():t.offset.x<-50&&v()},onClick:()=>n(j),whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,a.jsx)(s.AnimatePresence,{mode:"wait",custom:b,children:(0,a.jsxs)(r.motion.div,{custom:b,variants:{enter:e=>({x:e>0?300:-300,opacity:0,scale:.8,rotateY:e>0?45:-45}),center:{x:0,opacity:1,scale:1,rotateY:0},exit:e=>({x:e<0?300:-300,opacity:0,scale:.8,rotateY:e<0?45:-45})},initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2},scale:{duration:.2},rotateY:{duration:.3}},className:"relative",style:{transformStyle:"preserve-3d"},children:[(0,a.jsxs)(r.motion.div,{className:"absolute top-1/2 left-1/2 w-[90%] h-[90%] rounded-full bg-gradient-to-br from-zinc-900 via-zinc-800 to-zinc-900 shadow-2xl",style:{transform:"translate(-50%, -50%)",zIndex:-1},animate:{x:y&&l?30:0,rotate:y&&l?[0,360]:0},transition:{x:{duration:.5,ease:"easeOut"},rotate:{duration:3,repeat:1/0,ease:"linear"}},children:[(0,a.jsx)("div",{className:"absolute inset-4 rounded-full border border-zinc-700/50"}),(0,a.jsx)("div",{className:"absolute inset-8 rounded-full border border-zinc-700/30"}),(0,a.jsx)("div",{className:"absolute inset-12 rounded-full border border-zinc-700/20"}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 w-8 h-8 -translate-x-1/2 -translate-y-1/2 rounded-full bg-gradient-to-br from-amber-600 to-amber-800 flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-zinc-900"})})]}),(0,a.jsx)("div",{className:"w-32 h-32 sm:w-36 sm:h-36 rounded-lg overflow-hidden shadow-2xl bg-zinc-800 ring-1 ring-white/10",children:j.albumArt?(0,a.jsx)("img",{src:j.albumArt,alt:`${j.name} cover`,className:"w-full h-full object-cover",draggable:!1}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-4xl",children:"ðŸŽµ"})}),y&&(0,a.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 rounded-lg bg-black/30 flex items-center justify-center",children:(0,a.jsx)(r.motion.div,{className:"p-2 rounded-full bg-white/20 backdrop-blur-sm",animate:{scale:l?[1,1.1,1]:1},transition:{duration:1,repeat:1/0},children:l?(0,a.jsx)(p.Pause,{className:"w-6 h-6 text-white"}):(0,a.jsx)(h.Play,{className:"w-6 h-6 text-white ml-0.5"})})})]},m)})}),x.length>1&&(0,a.jsx)("button",{onClick:v,className:"absolute right-0 z-20 p-1.5 rounded-full bg-black/20 hover:bg-black/40 text-white/80 hover:text-white transition-all","aria-label":"Next album",children:(0,a.jsx)(L.ChevronRight,{className:"w-5 h-5"})})]}),(0,a.jsxs)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"mt-3 text-center",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-[#1a2420] dark:text-[#8fa39a] font-mono truncate max-w-[180px]",children:j.name}),(0,a.jsx)("p",{className:"text-xs text-[#3a4a45] dark:text-[#5a6a65] font-mono truncate max-w-[180px]",children:j.artist}),(0,a.jsxs)("p",{className:"text-[10px] text-[#5a6a65] dark:text-[#4a5a55] font-mono mt-0.5",children:[j.tracks.length," ",1===j.tracks.length?"track":"tracks"]})]},m),x.length>1&&(0,a.jsx)("div",{className:"flex gap-1.5 mt-2",children:x.map((e,t)=>(0,a.jsx)("button",{onClick:()=>{g(t>m?1:-1),u(t)},className:`w-1.5 h-1.5 rounded-full transition-all ${t===m?"bg-[#1a2420] dark:bg-[#8fa39a] w-3":"bg-[#5a6a65] dark:bg-[#3a4a45] hover:bg-[#3a4a45] dark:hover:bg-[#5a6a65]"}`,"aria-label":`Go to album ${t+1}`},t))}),(0,a.jsx)("p",{className:"text-[9px] text-[#5a6a65] dark:text-[#4a5a55] font-mono mt-2 opacity-60",children:"Tap album to view tracks â€¢ Swipe or use arrow keys"})]}):null}var er=e.i(345347);try{t=(()=>{let e=Error("Cannot find module '../../convex/_generated/api'");throw e.code="MODULE_NOT_FOUND",e})().api?.userManagement}catch{t=null}let es={humans:"areas",studio:"areas",vault:"areas",calendar:"areas",prototyping:"areas",privateMusic:"privateMusic",designCanvas:"designCanvas",security:"security",analytics:"analytics"},el=["humans","studio","vault","calendar","prototyping"];var en=e.i(188671),eo=e.i(72029),ec=e.i(735174),ed=e.i(754401),ex=e.i(574238),em=e.i(165558),eu=e.i(360166),eu=eu,eh=e.i(310010),W=W,ep=e.i(594728),eb=e.i(726152),eg=e.i(973493),ef=e.i(122429),ev=e.i(487611);function ek({context:e,isAdmin:t=!1,onSuggestUpdate:l}){let{currentTrack:n}=(0,N.useMusic)(),[o,c]=(0,i.useState)(!1),[d,x]=(0,i.useState)(""),[m,u]=(0,i.useState)(!1),h=(0,i.useRef)(null),p=(0,i.useRef)(null),b=["You are helping with music annotation and metadata. Keep responses concise and helpful.",t?"The user is an admin managing the music library.":"",n?`Current track: "${n.title}" by ${n.artist} from album "${n.album}".`:"",e].filter(Boolean).join(" "),{messages:g,isStreaming:f,sendMessage:v,clearMessages:j}=(0,ev.useStreamingChat)({model:"haiku",themeContext:b,onStreamStart:()=>u(!0),onStreamEnd:()=>{p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{o||u(!1)},3e4)}});(0,i.useEffect)(()=>()=>{p.current&&clearTimeout(p.current)},[]);let y=g.filter(e=>"assistant"===e.role).slice(-1)[0],w=(0,i.useCallback)(async e=>{if(e?.preventDefault(),!d.trim()||f)return;let t=d.trim();x(""),await v(t)},[d,f,v]),z=(0,i.useCallback)(()=>{u(!1),p.current&&clearTimeout(p.current)},[]);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(s.AnimatePresence,{children:m&&y&&(0,a.jsx)(r.motion.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{type:"spring",stiffness:400,damping:30},className:"absolute bottom-full mb-3 left-0 right-0",children:(0,a.jsxs)("div",{className:"relative bg-white/95 dark:bg-zinc-800/95 backdrop-blur-xl rounded-2xl p-3 shadow-lg border border-zinc-200/50 dark:border-zinc-700/50",children:[(0,a.jsx)("button",{onClick:z,className:"absolute -top-2 -right-2 p-1 rounded-full bg-zinc-200 dark:bg-zinc-700 text-zinc-500 dark:text-zinc-400 hover:bg-zinc-300 dark:hover:bg-zinc-600 transition-colors",children:(0,a.jsx)(R.X,{className:"w-3 h-3"})}),(0,a.jsx)("div",{className:"text-sm text-zinc-700 dark:text-zinc-300 leading-relaxed",children:y.isStreaming?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.motion.span,{className:"inline-block w-1.5 h-1.5 rounded-full bg-yellow-500",animate:{opacity:[1,.3,1]},transition:{duration:1.2,repeat:1/0}}),y.content||"Thinking..."]}):y.content}),(0,a.jsx)("div",{className:"absolute -bottom-2 left-6 w-4 h-4 bg-white/95 dark:bg-zinc-800/95 border-r border-b border-zinc-200/50 dark:border-zinc-700/50 transform rotate-45"})]})})}),(0,a.jsx)(s.AnimatePresence,{mode:"wait",children:o?(0,a.jsxs)(r.motion.form,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",stiffness:500,damping:35},onSubmit:w,className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"flex gap-1.5 overflow-x-auto pb-1 scrollbar-hide",children:(t?[{label:"Credits",prompt:"Help me add credits for this track"},{label:"Tags",prompt:"Suggest tags for this track"},{label:"Genre",prompt:"What genre is this track?"}]:[{label:"Similar",prompt:"Recommend similar tracks"},{label:"About",prompt:"Tell me about this track"}]).map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>{x(e.prompt),h.current?.focus()},className:"flex-shrink-0 px-2.5 py-1 text-xs rounded-full bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors border border-zinc-200 dark:border-zinc-700",children:e.label},e.label))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{ref:h,type:"text",value:d,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w()),"Escape"===e.key&&(c(!1),u(!1))},placeholder:"Ask about this track...",disabled:f,className:"w-full px-4 py-2.5 pr-10 text-sm rounded-full bg-zinc-100 dark:bg-zinc-800 text-zinc-800 dark:text-zinc-200 placeholder-zinc-400 dark:placeholder-zinc-500 border border-zinc-200 dark:border-zinc-700 focus:outline-none focus:border-yellow-500/50 focus:ring-2 focus:ring-yellow-500/20 transition-all disabled:opacity-50"}),(0,a.jsx)("button",{type:"submit",disabled:!d.trim()||f,className:"absolute right-1.5 top-1/2 -translate-y-1/2 p-1.5 rounded-full bg-yellow-500 text-white disabled:opacity-30 disabled:bg-zinc-400 hover:bg-yellow-400 transition-colors",children:(0,a.jsx)(eb.Send,{className:"w-3.5 h-3.5"})})]}),(0,a.jsx)("button",{type:"button",onClick:()=>c(!1),className:"p-2 rounded-full bg-zinc-100 dark:bg-zinc-800 text-zinc-500 dark:text-zinc-400 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors border border-zinc-200 dark:border-zinc-700",children:(0,a.jsx)(eg.ChevronDown,{className:"w-4 h-4"})})]})]},"expanded"):(0,a.jsxs)(r.motion.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",stiffness:500,damping:35},onClick:()=>{c(!0),setTimeout(()=>h.current?.focus(),100)},className:"group w-full flex items-center gap-2 px-4 py-2.5 rounded-full bg-zinc-100/80 dark:bg-zinc-800/80 backdrop-blur-sm border border-zinc-200/50 dark:border-zinc-700/50 hover:bg-zinc-100 dark:hover:bg-zinc-800 hover:border-zinc-300 dark:hover:border-zinc-600 transition-all",children:[(0,a.jsx)(k.Sparkles,{className:"w-4 h-4 text-yellow-500"}),(0,a.jsx)("span",{className:"flex-1 text-left text-sm text-zinc-500 dark:text-zinc-400 group-hover:text-zinc-600 dark:group-hover:text-zinc-300 transition-colors",children:"Ask 8gent..."}),(0,a.jsx)(ef.Mic,{className:"w-3.5 h-3.5 text-zinc-400 dark:text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity"})]},"collapsed")})]})}function ej({currentTime:e,duration:t,onSeek:r}){let s=(0,i.useRef)(null),[l,n]=(0,i.useState)(!1),o=(0,i.useMemo)(()=>Array.from({length:80},(e,t)=>Math.max(.1,Math.min(1,.5*Math.sin(t/80*Math.PI)+.5+.4*Math.random()-.2))),[]),c=t>0?e/t:0;return(0,a.jsxs)("div",{ref:s,className:"relative h-24 cursor-pointer select-none",onClick:e=>{if(!s.current||t<=0)return;let a=s.current.getBoundingClientRect();r((e.clientX-a.left)/a.width*t)},children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center gap-[2px]",children:o.map((e,t)=>{let i=t/o.length<=c;return(0,a.jsx)("div",{className:"w-[3px] rounded-full transition-all duration-150 ease-out",style:{height:`${100*e}%`,backgroundColor:i?"rgb(202 138 4)":"rgb(161 161 170)",transform:i?"scaleY(1.05)":"scaleY(1)"}},t)})}),(0,a.jsx)("div",{className:"absolute top-0 bottom-0 w-[2px] bg-yellow-400 shadow-[0_0_8px_rgba(250,204,21,0.5)] transition-[left] duration-100 ease-linear",style:{left:`${100*c}%`}})]})}function ey(e){if(isNaN(e)||e<0)return"0:00";let t=Math.floor(e/60),a=Math.floor(e%60);return`${t}:${a.toString().padStart(2,"0")}`}function eN({onClick:e,children:t,className:i="",title:s}){return(0,a.jsx)(r.motion.button,{onClick:e,className:i,whileTap:{scale:.92},transition:{type:"spring",stiffness:500,damping:30},title:s,children:t})}function ew({onShowQueue:e,onShowPlaylist:t}){let{currentTrack:s,isPlaying:l,currentTime:n,duration:o,togglePlay:c,skipToNext:d,skipToPrevious:x,audioRef:m}=(0,N.useMusic)(),[u,b]=(0,i.useState)("off"),[g,f]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-transparent text-zinc-800 dark:text-white p-4",children:[(0,a.jsxs)(r.motion.div,{className:"text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:300,damping:25,delay:.1},children:[(0,a.jsx)("h2",{className:"text-xl font-semibold truncate text-zinc-800 dark:text-white",children:s.title}),(0,a.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 text-sm",children:s.artist})]}),(0,a.jsx)(r.motion.div,{className:"relative mx-auto w-full max-w-[280px] aspect-square rounded-lg overflow-hidden mb-6 shadow-2xl",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:25},children:s.albumArt?(0,a.jsx)("img",{src:s.albumArt,alt:s.album,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-zinc-300 dark:bg-zinc-800 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-6xl",children:"ðŸŽµ"})})}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(ej,{currentTime:n,duration:o,onSeek:e=>{m.current&&(m.current.currentTime=e)}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-zinc-500 dark:text-zinc-400 mb-6 font-mono",children:[(0,a.jsx)("span",{children:ey(n)}),(0,a.jsxs)("span",{children:["-",ey(Math.max(0,o-n))]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-6 mb-6",children:[(0,a.jsx)(eN,{onClick:x,className:"p-2 text-zinc-600 dark:text-white/80 hover:text-zinc-900 dark:hover:text-white transition-colors",title:"Previous",children:(0,a.jsx)(ed.SkipBack,{className:"w-7 h-7",fill:"currentColor"})}),(0,a.jsx)(r.motion.button,{onClick:c,className:"p-4 bg-zinc-800 dark:bg-white rounded-full text-white dark:text-black hover:bg-zinc-700 dark:hover:bg-zinc-200 transition-colors",whileTap:{scale:.9},whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:25},children:(0,a.jsx)(r.motion.div,{initial:!1,animate:{rotate:0},transition:{type:"spring",stiffness:300,damping:20},children:l?(0,a.jsx)(p.Pause,{className:"w-8 h-8",fill:"currentColor"}):(0,a.jsx)(h.Play,{className:"w-8 h-8 ml-1",fill:"currentColor"})})}),(0,a.jsx)(eN,{onClick:d,className:"p-2 text-zinc-600 dark:text-white/80 hover:text-zinc-900 dark:hover:text-white transition-colors",title:"Next",children:(0,a.jsx)(ex.SkipForward,{className:"w-7 h-7",fill:"currentColor"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-8 mb-4",children:[(0,a.jsx)(eN,{onClick:()=>f(!g),className:`p-2 transition-colors ${g?"text-yellow-600 dark:text-yellow-400":"text-zinc-400 dark:text-zinc-500 hover:text-zinc-600 dark:hover:text-zinc-300"}`,title:"Shuffle",children:(0,a.jsx)(eh.Shuffle,{className:"w-5 h-5"})}),(0,a.jsx)(eN,{onClick:()=>{b(e=>"off"===e?"all":"all"===e?"one":"off")},className:`p-2 transition-colors ${"off"!==u?"text-yellow-600 dark:text-yellow-400":"text-zinc-400 dark:text-zinc-500 hover:text-zinc-600 dark:hover:text-zinc-300"}`,title:"Repeat",children:"one"===u?(0,a.jsx)(eu.default,{className:"w-5 h-5"}):(0,a.jsx)(em.Repeat,{className:"w-5 h-5"})}),(0,a.jsx)(eN,{onClick:e||(()=>{}),className:"p-2 text-zinc-400 dark:text-zinc-500 hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors",title:"Queue",children:(0,a.jsx)(W.default,{className:"w-5 h-5"})}),(0,a.jsx)(eN,{onClick:()=>{},className:"p-2 text-zinc-400 dark:text-zinc-500 hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors",title:"Share",children:(0,a.jsx)(ep.Share,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"mt-auto pt-2 border-t border-zinc-200/50 dark:border-zinc-700/50",children:(0,a.jsx)(ek,{})})]})}var ez=e.i(92768),eC=e.i(431529);function eA({name:e,artist:t,albumArt:i,trackCount:r,onClick:s}){return(0,a.jsxs)("button",{onClick:s,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-zinc-200/50 dark:hover:bg-zinc-800/50 transition-colors text-left group",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-md overflow-hidden bg-zinc-300 dark:bg-zinc-800 flex-shrink-0",children:i?(0,a.jsx)("img",{src:i,alt:e,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:"ðŸŽµ"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-zinc-800 dark:text-white font-medium truncate",children:e}),(0,a.jsxs)("div",{className:"text-zinc-500 dark:text-zinc-400 text-sm truncate",children:[t," Â· ",r," track",1!==r?"s":""]})]}),(0,a.jsx)(h.Play,{className:"w-5 h-5 text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity"})]})}function eS({track:e,index:t,isPlaying:i,isCurrent:r,onPlay:s}){return(0,a.jsxs)("button",{onClick:s,className:`flex items-center gap-3 w-full p-3 rounded-lg transition-colors text-left group ${r?"bg-zinc-300 dark:bg-zinc-800":"hover:bg-zinc-200/50 dark:hover:bg-zinc-800/50"}`,children:[(0,a.jsx)("span",{className:"w-6 text-center text-sm text-zinc-500 font-mono",children:r&&i?(0,a.jsx)("span",{className:"text-yellow-400",children:"â–¶"}):t+1}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:`font-medium truncate ${r?"text-yellow-600 dark:text-yellow-400":"text-zinc-800 dark:text-white"}`,children:e.title}),(0,a.jsx)("div",{className:"text-zinc-500 dark:text-zinc-400 text-sm truncate",children:e.artist})]}),(0,a.jsx)("button",{className:"p-1 text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(eC.MoreHorizontal,{className:"w-4 h-4"})})]})}function eM({onClose:e}){let{currentTrack:t,isPlaying:l,selectTrack:n}=(0,N.useMusic)(),[o,c]=(0,i.useState)("library"),[d,x]=(0,i.useState)(null),[m,u]=(0,i.useState)(""),p=(0,i.useMemo)(()=>(function(e){let t=new Map;for(let a of e){let e=`${a.album}::${a.artist}`;t.has(e)||t.set(e,{artist:a.artist,albumArt:a.albumArt,tracks:[]}),t.get(e).tracks.push(a)}return t})(y.tracks),[]),b=(0,i.useMemo)(()=>Array.from(p.entries()).map(([e,t])=>({key:e,name:e.split("::")[0],...t})),[p]),g=(0,i.useMemo)(()=>{if(!m)return b;let e=m.toLowerCase();return b.filter(t=>t.name.toLowerCase().includes(e)||t.artist.toLowerCase().includes(e))},[b,m]),f=d?p.get(d):null,v=d?.split("::")[0]||"";return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-transparent text-zinc-800 dark:text-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 border-b border-zinc-300 dark:border-zinc-700",children:["album"===o&&(0,a.jsx)("button",{onClick:()=>{c("library"),x(null)},className:"p-1 text-zinc-400 hover:text-white transition-colors",children:(0,a.jsx)(ea.ChevronLeft,{className:"w-6 h-6"})}),(0,a.jsx)("h2",{className:"text-lg font-semibold flex-1",children:"library"===o?"Library":v}),"library"===o&&(0,a.jsx)("button",{className:"p-1 text-zinc-400 hover:text-white transition-colors",children:(0,a.jsx)(ez.Search,{className:"w-5 h-5"})})]}),"library"===o&&(0,a.jsx)("div",{className:"p-4 pb-2",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(ez.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,a.jsx)("input",{type:"text",placeholder:"Search albums...",value:m,onChange:e=>u(e.target.value),className:"w-full bg-zinc-200/50 dark:bg-zinc-800/50 border border-zinc-300 dark:border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-sm text-zinc-800 dark:text-white placeholder-zinc-500 focus:outline-none focus:border-zinc-400 dark:focus:border-zinc-600"})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsx)(s.AnimatePresence,{mode:"wait",children:"library"===o?(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},exit:{opacity:0,x:-15},transition:{type:"spring",stiffness:350,damping:30},className:"p-4 pt-2 space-y-1",children:[g.map(e=>(0,a.jsx)(eA,{name:e.name,artist:e.artist,albumArt:e.albumArt,trackCount:e.tracks.length,onClick:()=>{x(e.key),c("album")}},e.key)),0===g.length&&(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500",children:"No albums found"})]},"library"):(0,a.jsxs)(r.motion.div,{initial:{opacity:0,x:15},animate:{opacity:1,x:0},exit:{opacity:0,x:15},transition:{type:"spring",stiffness:350,damping:30},children:[f&&(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-lg overflow-hidden bg-zinc-300 dark:bg-zinc-800 flex-shrink-0 shadow-lg",children:f.albumArt?(0,a.jsx)("img",{src:f.albumArt,alt:v,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-3xl",children:"ðŸŽµ"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold truncate text-zinc-800 dark:text-white",children:v}),(0,a.jsx)("p",{className:"text-zinc-500 dark:text-zinc-400 text-sm",children:f.artist}),(0,a.jsxs)("p",{className:"text-zinc-400 dark:text-zinc-500 text-sm",children:[f.tracks.length," track",1!==f.tracks.length?"s":""]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{f&&f.tracks.length>0&&n(f.tracks[0])},className:"flex-1 flex items-center justify-center gap-2 bg-yellow-400 text-black font-medium py-2 rounded-lg hover:bg-yellow-300 transition-colors",children:[(0,a.jsx)(h.Play,{className:"w-4 h-4",fill:"currentColor"}),"Play"]}),(0,a.jsx)("button",{className:"px-4 py-2 bg-zinc-300 dark:bg-zinc-800 text-zinc-800 dark:text-white rounded-lg hover:bg-zinc-400 dark:hover:bg-zinc-700 transition-colors",children:(0,a.jsx)(Y.Plus,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"px-2",children:f?.tracks.map((e,i)=>(0,a.jsx)(eS,{track:e,index:i,isPlaying:l,isCurrent:e.id===t.id,onPlay:()=>{n(e)}},e.id))})]},"album")})})]})}var eP=e.i(541956),eT=e.i(465231),e$=e.i(981779),eU=e.i(432827),eE=e.i(610724),eL=e.i(573138),eI=e.i(555603),W=W;function eR(){let e=(0,C.useQuery)(A.api.privateMusic.listAllPrivateTracks)||[],t=(0,C.useQuery)(A.api.collaborators.listCollaboratorsWithResources)||[],l=(0,C.useMutation)(A.api.privateMusic.addPrivateTrack),n=(0,C.useMutation)(A.api.privateMusic.deletePrivateTrack),o=(0,C.useMutation)(A.api.collaborators.assignToResource),c=(0,C.useMutation)(A.api.collaborators.removeFromResource),[x,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(!1),[p,b]=(0,i.useState)(!1),[g,f]=(0,i.useState)(null),[v,k]=(0,i.useState)(!1),[y,N]=(0,i.useState)(null),w=(0,i.useRef)(null),[z,S]=(0,i.useState)({title:"",artist:"",album:"",audioUrl:"",albumArt:"",notes:""}),M=(0,C.useQuery)(A.api.collaborators.listResourceCollaborators,y?{resourceType:"track",resourceId:y}:"skip")||[],P=(0,i.useCallback)(async(e,t)=>{try{let a=new FormData;a.append("file",e),a.append("type",t);let i=await fetch("/api/tracks/upload",{method:"POST",body:a});if(!i.ok){let e=await i.json();throw Error(e.error||"Upload failed")}return(await i.json()).url}catch(e){return console.error("Upload error:",e),null}},[]),T=(0,i.useCallback)(async e=>{e.preventDefault(),k(!1);let t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("audio/")||e.name.endsWith(".mp3")||e.name.endsWith(".m4a")||e.name.endsWith(".wav"));if(0!==t.length){for(let e of(b(!0),t)){f(`Uploading ${e.name}...`);let t=await P(e,"audio");if(t){let a=e.name.replace(/\.[^/.]+$/,"").replace(/_/g," ");f(`Adding ${a}...`),await l({title:a,artist:"Unknown Artist",audioUrl:t})}}b(!1),f(null)}},[P,l]),$=(0,i.useCallback)(e=>{e.preventDefault(),k(!0)},[]),U=(0,i.useCallback)(e=>{e.preventDefault(),k(!1)},[]),E=(0,i.useCallback)(async e=>{let t=e.target.files;if(t&&0!==t.length){for(let e of(b(!0),Array.from(t))){f(`Uploading ${e.name}...`);let t=await P(e,"audio");if(t){let a=e.name.replace(/\.[^/.]+$/,"").replace(/_/g," ");f(`Adding ${a}...`),await l({title:a,artist:"Unknown Artist",audioUrl:t})}}b(!1),f(null),w.current&&(w.current.value="")}},[P,l]),L=async()=>{if(z.title&&z.artist&&z.audioUrl){h(!0);try{await l({title:z.title,artist:z.artist,album:z.album||void 0,audioUrl:z.audioUrl,albumArt:z.albumArt||void 0,notes:z.notes||void 0}),S({title:"",artist:"",album:"",audioUrl:"",albumArt:"",notes:""}),m(!1)}finally{h(!1)}}},R=async e=>{confirm("Delete this track?")&&await n({trackId:e})},D=async(e,t)=>{await o({managedUserId:t,resourceType:"track",resourceId:e,accessLevel:"view"})},V=async(e,t)=>{await c({managedUserId:t,resourceType:"track",resourceId:e})},O=t.filter(e=>!e.permissions.privateMusic&&"owner"!==e.role&&"admin"!==e.role);return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-transparent text-zinc-800 dark:text-white",onDrop:T,onDragOver:$,onDragLeave:U,children:[(0,a.jsx)(s.AnimatePresence,{children:v&&(0,a.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-amber-500/20 backdrop-blur-sm border-2 border-dashed border-amber-500 rounded-2xl flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(eP.Upload,{className:"w-12 h-12 text-amber-500 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-amber-600 dark:text-amber-400 font-medium",children:"Drop audio files here"}),(0,a.jsx)("p",{className:"text-sm text-amber-500/70",children:"MP3, M4A, WAV supported"})]})})}),(0,a.jsx)(s.AnimatePresence,{children:p&&(0,a.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(j.Loader2,{className:"w-8 h-8 text-amber-500 animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-zinc-800 dark:text-zinc-200 font-medium",children:g})]})})}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 border-b border-zinc-300 dark:border-zinc-700",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-amber-100 dark:bg-amber-900/40",children:(0,a.jsx)(d.Music2,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Tracks"}),(0,a.jsxs)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[e.length," private tracks"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 relative",children:[(0,a.jsx)("input",{ref:w,type:"file",accept:"audio/*",multiple:!0,onChange:E,className:"hidden"}),(0,a.jsxs)("button",{onClick:()=>w.current?.click(),className:"w-full flex flex-col items-center justify-center gap-2 p-4 mb-4 rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 hover:border-amber-400 dark:hover:border-amber-500 hover:bg-amber-50 dark:hover:bg-amber-900/20 transition-colors text-zinc-500 dark:text-zinc-400 hover:text-amber-600 dark:hover:text-amber-400",children:[(0,a.jsx)(eP.Upload,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Drop files or click to upload"}),(0,a.jsx)("span",{className:"text-xs opacity-60",children:"MP3, M4A, WAV"})]}),(0,a.jsxs)("button",{onClick:()=>m(!x),className:"w-full flex items-center justify-center gap-2 p-2 mb-4 rounded-lg text-zinc-500 dark:text-zinc-400 hover:text-amber-600 dark:hover:text-amber-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors text-sm",children:[(0,a.jsx)(Y.Plus,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Add by URL"})]}),(0,a.jsx)(s.AnimatePresence,{children:x&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:(0,a.jsxs)("div",{className:"p-3 bg-zinc-100 dark:bg-zinc-800 rounded-lg space-y-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Title *",value:z.title,onChange:e=>S({...z,title:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Artist *",value:z.artist,onChange:e=>S({...z,artist:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Audio URL *",value:z.audioUrl,onChange:e=>S({...z,audioUrl:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Album (optional)",value:z.album,onChange:e=>S({...z,album:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Album Art URL (optional)",value:z.albumArt,onChange:e=>S({...z,albumArt:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)("button",{onClick:()=>m(!1),className:"px-3 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200",children:"Cancel"}),(0,a.jsxs)("button",{onClick:L,disabled:u||!z.title||!z.artist||!z.audioUrl,className:"px-4 py-1.5 text-sm font-medium text-white bg-amber-500 hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-md flex items-center gap-2",children:[u?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(I.Check,{className:"w-3 h-3"}),"Add"]})]})]})})}),(0,a.jsx)("div",{className:"space-y-2",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400 text-sm",children:"No private tracks yet"}):e.map((e,t)=>{let i=y===e.id;return(0,a.jsxs)(r.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.03*t},className:"bg-white/50 dark:bg-zinc-800/50 rounded-lg border border-zinc-200 dark:border-zinc-700 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-2 group",children:[e.albumArt?(0,a.jsx)("img",{src:e.albumArt,alt:"",className:"w-10 h-10 rounded object-cover"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded bg-zinc-200 dark:bg-zinc-700 flex items-center justify-center",children:(0,a.jsx)(d.Music2,{className:"w-5 h-5 text-zinc-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 truncate",children:e.artist})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[O.length>0&&(0,a.jsx)("button",{onClick:()=>{var t;N(y===(t=e.id)?null:t)},className:"p-1.5 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors",title:"Manage access",children:(0,a.jsx)(Q.Users,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>R(e.id),className:"p-1.5 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-zinc-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",title:"Delete track",children:(0,a.jsx)(G.Trash2,{className:"w-4 h-4"})})]})]}),(0,a.jsx)(s.AnimatePresence,{children:i&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-zinc-200 dark:border-zinc-700",children:(0,a.jsxs)("div",{className:"p-3 bg-zinc-50 dark:bg-zinc-800/50",children:[(0,a.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 mb-2",children:"Grant access to specific collaborators:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[O.map(t=>{let i=M.some(e=>e.managedUserId===t.id);return(0,a.jsxs)("button",{onClick:()=>i?V(e.id,t.id):D(e.id,t.id),className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs transition-colors ${i?"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300":"bg-zinc-100 dark:bg-zinc-700 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-200 dark:hover:bg-zinc-600"}`,children:[i&&(0,a.jsx)(I.Check,{className:"w-3 h-3"}),t.displayName||t.email.split("@")[0]]},t.id)}),0===O.length&&(0,a.jsx)("p",{className:"text-xs text-zinc-400 italic",children:"All collaborators have full music access"})]})]})})})]},e.id)})})]})]})}function eD(){let e=(0,C.useQuery)(A.api.collaborators.listCollaboratorsWithResources)||[],t=(0,C.useQuery)(A.api.collaborators.listPendingInvites)||[],l=(0,C.useMutation)(A.api.collaborators.createInvite),n=(0,C.useMutation)(A.api.collaborators.revokeInvite),o=(0,C.useMutation)(A.api.collaborators.regenerateInvite);(0,C.useMutation)(A.api.privateMusic.removeCollaborator),(0,C.useMutation)(A.api.privateMusic.updateCollaborator);let[c,d]=(0,i.useState)(!1),[x,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),[p,b]=(0,i.useState)(null),[g,f]=(0,i.useState)({email:"",displayName:"",role:"collaborator",privateMusic:!0}),v=async()=>{if(g.email){m(!0);try{let e=await l({email:g.email,role:g.role,permissions:{areas:[],privateMusic:g.privateMusic,designCanvas:!1,clawAI:!0,security:!1,analytics:!1,manageUsers:"admin"===g.role,managePasscodes:"admin"===g.role,manageContent:"admin"===g.role}});if(e.success&&e.token){let t=`${window.location.origin}/invite/${e.token}`;b(t),navigator.clipboard.writeText(t)}}finally{m(!1)}}},k=async e=>{let t=`${window.location.origin}/invite/${e}`;await navigator.clipboard.writeText(t),h(e),setTimeout(()=>h(null),2e3)},y=async e=>{let t=await o({inviteId:e});if(t.success&&t.token){let e=`${window.location.origin}/invite/${t.token}`;await navigator.clipboard.writeText(e),h(t.token),setTimeout(()=>h(null),2e3)}},N=async e=>{confirm("Revoke this invite? The link will no longer work.")&&await n({inviteId:e})},w=()=>{f({email:"",displayName:"",role:"collaborator",privateMusic:!0}),b(null),d(!1)},z=t.filter(e=>!e.acceptedAt&&!e.isRevoked&&!e.isExpired);return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-transparent text-zinc-800 dark:text-white",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 border-b border-zinc-300 dark:border-zinc-700",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-amber-100 dark:bg-amber-900/40",children:(0,a.jsx)(Q.Users,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Collaborators"}),(0,a.jsxs)("p",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[e.length," people",z.length>0&&` \xb7 ${z.length} pending`]})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,a.jsxs)("button",{onClick:()=>d(!c),className:"w-full flex items-center justify-center gap-2 p-3 mb-4 rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 hover:border-amber-400 dark:hover:border-amber-500 hover:bg-amber-50 dark:hover:bg-amber-900/20 transition-colors text-zinc-500 dark:text-zinc-400 hover:text-amber-600 dark:hover:text-amber-400",children:[(0,a.jsx)(H.UserPlus,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Invite Collaborator"})]}),(0,a.jsx)(s.AnimatePresence,{children:c&&(0,a.jsx)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mb-4",children:(0,a.jsx)("div",{className:"p-3 bg-zinc-100 dark:bg-zinc-800 rounded-lg space-y-3",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-md bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800",children:[(0,a.jsx)(eU.CheckCircle,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-xs text-emerald-700 dark:text-emerald-300",children:"Invite link created and copied to clipboard!"})]}),(0,a.jsx)("div",{className:"p-2 bg-zinc-200 dark:bg-zinc-700 rounded-md",children:(0,a.jsx)("p",{className:"text-xs text-zinc-600 dark:text-zinc-400 break-all font-mono",children:p})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>navigator.clipboard.writeText(p),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200 bg-zinc-200 dark:bg-zinc-700 rounded-md",children:[(0,a.jsx)(e$.Copy,{className:"w-4 h-4"}),"Copy Again"]}),(0,a.jsx)("button",{onClick:w,className:"flex-1 px-3 py-2 text-sm font-medium text-white bg-amber-500 hover:bg-amber-600 rounded-md",children:"Done"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start gap-2 p-2 rounded-md bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800",children:[(0,a.jsx)(eT.Link2,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Generate a unique invite link they can use to join"})]}),(0,a.jsx)("input",{type:"email",placeholder:"Email *",value:g.email,onChange:e=>f({...g,email:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400"}),(0,a.jsxs)("select",{value:g.role,onChange:e=>f({...g,role:e.target.value}),className:"w-full px-3 py-2 rounded-md bg-white dark:bg-zinc-700 border border-zinc-200 dark:border-zinc-600 text-sm text-zinc-800 dark:text-zinc-200",children:[(0,a.jsx)("option",{value:"viewer",children:"Viewer (read-only)"}),(0,a.jsx)("option",{value:"collaborator",children:"Collaborator"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-zinc-600 dark:text-zinc-400",children:[(0,a.jsx)("input",{type:"checkbox",checked:g.privateMusic,onChange:e=>f({...g,privateMusic:e.target.checked}),className:"rounded border-zinc-300 dark:border-zinc-600 text-amber-500 focus:ring-amber-500"}),(0,a.jsx)(eI.Music,{className:"w-4 h-4"}),"Access to all private music"]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)("button",{onClick:w,className:"px-3 py-1.5 text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-800 dark:hover:text-zinc-200",children:"Cancel"}),(0,a.jsxs)("button",{onClick:v,disabled:x||!g.email,className:"px-4 py-1.5 text-sm font-medium text-white bg-amber-500 hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-md flex items-center gap-2",children:[x?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(eT.Link2,{className:"w-3 h-3"}),"Generate Link"]})]})]})})})}),z.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 uppercase tracking-wider mb-2",children:"Pending Invites"}),(0,a.jsx)("div",{className:"space-y-2",children:z.map(e=>(0,a.jsxs)(r.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"flex items-center gap-3 p-2 bg-amber-50/50 dark:bg-amber-900/10 rounded-lg border border-amber-200/50 dark:border-amber-800/30",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-amber-100 dark:bg-amber-900/40",children:(0,a.jsx)(eE.Clock,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.email}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:["Expires ",new Date(e.expiresAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>k(e.token),className:"p-1.5 rounded hover:bg-amber-200/50 dark:hover:bg-amber-800/30 text-amber-600 dark:text-amber-400 transition-colors",title:"Copy invite link",children:u===e.token?(0,a.jsx)(eU.CheckCircle,{className:"w-4 h-4 text-emerald-500"}):(0,a.jsx)(e$.Copy,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>y(e.id),className:"p-1.5 rounded hover:bg-amber-200/50 dark:hover:bg-amber-800/30 text-amber-600 dark:text-amber-400 transition-colors",title:"Regenerate link",children:(0,a.jsx)(eL.RefreshCw,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>N(e.id),className:"p-1.5 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-zinc-400 hover:text-red-500 transition-colors",title:"Revoke invite",children:(0,a.jsx)(R.X,{className:"w-4 h-4"})})]})]},e.id))})]}),(0,a.jsx)("div",{className:"space-y-2",children:0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-zinc-500 dark:text-zinc-400 text-sm",children:"No collaborators yet"}):e.map((e,t)=>(0,a.jsxs)(r.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.03*t},className:`flex items-center gap-3 p-2 rounded-lg border group ${e.isActive?"bg-white/50 dark:bg-zinc-800/50 border-zinc-200 dark:border-zinc-700":"bg-zinc-100/50 dark:bg-zinc-900/50 border-zinc-200/50 dark:border-zinc-800 opacity-60"}`,children:[(0,a.jsx)("div",{className:`p-2 rounded-full ${"owner"===e.role?"bg-gradient-to-br from-amber-100 to-orange-100 dark:from-amber-900/40 dark:to-orange-900/40":"admin"===e.role?"bg-amber-100 dark:bg-amber-900/40":"bg-zinc-100 dark:bg-zinc-800"}`,children:"owner"===e.role?(0,a.jsx)(K.Shield,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}):"admin"===e.role?(0,a.jsx)(K.Shield,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}):(0,a.jsx)(U.User,{className:"w-4 h-4 text-zinc-500 dark:text-zinc-400"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-zinc-800 dark:text-zinc-200 truncate",children:e.displayName||e.email.split("@")[0]}),"owner"===e.role&&(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-full uppercase tracking-wider",children:"Owner"})]}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500 dark:text-zinc-400 truncate flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.email}),e.totalResources>0&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[e.resourceCounts.tracks>0&&(0,a.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,a.jsx)(eI.Music,{className:"w-3 h-3"}),e.resourceCounts.tracks]}),e.resourceCounts.playlists>0&&(0,a.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,a.jsx)(W.default,{className:"w-3 h-3"}),e.resourceCounts.playlists]})]})]})]}),"owner"!==e.role&&(0,a.jsx)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.hasPendingInvite&&e.inviteToken&&(0,a.jsx)("button",{onClick:()=>k(e.inviteToken),className:"p-1.5 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors",title:"Copy invite link",children:u===e.inviteToken?(0,a.jsx)(eU.CheckCircle,{className:"w-4 h-4 text-emerald-500"}):(0,a.jsx)(eT.Link2,{className:"w-4 h-4"})})})]},e.id))})]})]})}var eV=e.i(885918);function eO(){let{currentTrack:e,isPlaying:l,currentTime:A,duration:M,isVideo:P,togglePlay:T,skipToNext:$,skipToPrevious:U,selectTrack:E,setVideoElement:L}=(0,N.useMusic)(),{morphProgress:I,morphState:R,isDragging:D,isMobile:V,ipodScale:O,ipodBorderRadius:B,panelOpacity:_,expand:Q,collapse:W,toggleExpanded:Y}=function(){let[e,t]=(0,i.useState)("ipod"),[a,r]=(0,i.useState)(!1),[s,l]=(0,i.useState)(!1),n=(0,en.useMotionValue)(0),[o,c]=(0,i.useState)(0);(0,i.useEffect)(()=>n.on("change",e=>{c(e)}),[n]),(0,i.useEffect)(()=>{let e=()=>{l(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let d=(0,eo.useTransform)(n,[0,.5,1],s?[1,.5,.35]:[1,.98,.95]),x=(0,eo.useTransform)(n,[0,.5,1],s?[32,24,22]:[32,30,28]),m=(0,eo.useTransform)(n,[0,.5,1],s?[300,180,140]:[300,300,300]),u=(0,eo.useTransform)(n,[0,.5,1],s?["auto","70px","52px"]:["auto","auto","auto"]),h=(0,eo.useTransform)(n,[0,.15,.5,1],[0,0,.7,1]),p=(0,i.useCallback)(e=>{(0,ec.animate)(n,e,{type:"spring",stiffness:260,damping:28,mass:.9})},[n]),b=(0,i.useCallback)(()=>{t("expanded"),p(1)},[p]),g=(0,i.useCallback)(()=>{t("ipod"),p(0)},[p]),f=(0,i.useCallback)(()=>{"expanded"===e?g():b()},[e,b,g]),v=(0,i.useCallback)(()=>{r(!0),t("morphing")},[]),k=(0,i.useCallback)(e=>{let t=Math.max(0,Math.min(1,e));n.set(t)},[n]),j=(0,i.useCallback)(()=>{r(!1);let e=n.get();s?e<.25?(t("ipod"),p(0)):e<.75?(t("island"),p(.5)):(t("expanded"),p(1)):e<.5?(t("ipod"),p(0)):(t("expanded"),p(1))},[n,s,p]),y=(0,i.useCallback)(e=>{n.set(Math.max(0,Math.min(1,e)))},[n]);return{morphProgress:o,morphState:e,isDragging:a,isMobile:s,progress:n,ipodScale:d,ipodBorderRadius:x,ipodWidth:m,ipodHeight:u,panelOpacity:h,expand:b,collapse:g,toggleExpanded:f,onDragStart:v,onDrag:k,onDragEnd:j,setMorphProgress:y}}(),G=I>.5,H=I>.3&&!V,K=(0,i.useRef)(null);(0,i.useEffect)(()=>(P&&K.current&&L(K.current),()=>{P&&L(null)}),[P,L,e.id]);let{hasPrivateAccess:q,isCollaborator:X,isAdmin:Z,privateTracks:ee,collaborator:et,isLoadingTracks:ea}=function(){let e=(0,i.useContext)(S);if(!e)throw Error("usePrivateMusic must be used within a PrivateMusicProvider");return e}(),{hasAccess:ed}=function(e){let{user:a,isLoaded:r}=(0,z.useUser)(),{isAuthenticated:s,isLoading:l}=(0,er.useAdminSession)(),[n,o]=(0,i.useState)(!1),c=a?.id,d=(0,C.useQuery)(t?.getManagedUserByClerkId,c?{clerkId:c}:"skip"),x=!r||l||!!(c&&void 0===d),m=(0,i.useMemo)(()=>{if(x)return{hasAccess:!1,reason:"Loading..."};if(s)return{hasAccess:!0};if(!a)return{hasAccess:!1,reason:"This feature requires an account. Sign in or request access."};if(!d)return{hasAccess:!1,reason:"This feature is available to invited collaborators."};if(!d.isActive)return{hasAccess:!1,reason:"Your account has been deactivated. Contact the owner for assistance."};if("owner"===d.role||"admin"===d.role)return{hasAccess:!0};let t=es[e];return el.includes(e)?d.permissions?.areas?.includes(e)?{hasAccess:!0}:{hasAccess:!1,reason:`This area is reserved for users with ${e} access.`}:d.permissions?.[t]?{hasAccess:!0}:{hasAccess:!1,reason:`This feature requires ${e} permission.`}},[x,s,a,d,e]),u=(0,i.useCallback)(()=>{o(!0)},[]),h=(0,i.useCallback)(()=>{o(!1)},[]);return{hasAccess:m.hasAccess,isLoading:x,reason:m.reason,showAccessGate:u,hideAccessGate:h,isGateOpen:n}}("privateMusic"),[ex,em]=(0,i.useState)("carousel"),[eu,eh]=(0,i.useState)(null),[ep,eb]=(0,i.useState)(!1),[eg,ef]=(0,i.useState)(!1),[ev,ek]=(0,i.useState)(!1),[ej,ey]=(0,i.useState)(!1),[eN,ez]=(0,i.useState)(""),[eC,eA]=(0,i.useState)(30),[eS,eP]=(0,i.useState)(!1),[eT,e$]=(0,i.useState)(""),[eU,eE]=(0,i.useState)(),[eL,eI]=(0,i.useState)(),{generate:eO,isGenerating:eB,progress:e_,error:eF,result:eQ,reset:eW}=(0,eV.useMusicGeneration)(),eY=(0,i.useRef)(null),eG="auth"===ex;(0,i.useEffect)(()=>{q&&ee.length>0&&!ej&&ey(!0)},[q,ee.length,ej]);let eH=(0,i.useMemo)(()=>ej&&q&&ee.length>0?ee.map(e=>({id:e.id,title:e.title,artist:e.artist,album:e.album,albumArt:e.albumArt,audioSrc:e.audioSrc,lyrics:e.lyrics})):y.tracks,[ej,q,ee]);(0,i.useEffect)(()=>{eH.length>0&&!eH.find(t=>t.id===e.id)&&E(eH[0])},[eH,e.id,E]);let eK=e=>{if(isNaN(e))return"0:00";let t=Math.floor(e/60),a=Math.floor(e%60);return`${t}:${a.toString().padStart(2,"0")}`},eq=M?A/M*100:0,eX=()=>{em("auth")},eJ=()=>{em("carousel")},eZ=e=>{eh(e),em("album")},e0=e=>{E(e),em("nowPlaying")};return(0,a.jsx)(w.PageTransition,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-background flex flex-col items-center justify-start",children:[ej&&q&&et&&(0,a.jsx)(n,{delay:.05,children:(0,a.jsx)("div",{className:"fixed top-6 left-6 z-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-100 dark:bg-emerald-900/30 border border-emerald-200 dark:border-emerald-800",children:[(0,a.jsx)(d.Music2,{className:"w-3.5 h-3.5 text-emerald-600 dark:text-emerald-400"}),(0,a.jsxs)("span",{className:"text-xs font-medium text-emerald-700 dark:text-emerald-300",children:[et.displayName,Z&&" (Admin)"]}),(0,a.jsx)("button",{onClick:()=>ey(!1),className:"ml-1 p-0.5 rounded-full hover:bg-emerald-200 dark:hover:bg-emerald-800 transition-colors",title:"Switch to public tracks",children:(0,a.jsx)(x.Eye,{className:"w-3 h-3 text-emerald-600 dark:text-emerald-400"})}),Z&&(0,a.jsx)("button",{onClick:()=>ef(!0),className:"ml-1 p-0.5 rounded-full hover:bg-emerald-200 dark:hover:bg-emerald-800 transition-colors",title:"Admin settings",children:(0,a.jsx)(u.Settings,{className:"w-3 h-3 text-emerald-600 dark:text-emerald-400"})})]})})}),!ej&&q&&ee.length>0&&(0,a.jsx)(n,{delay:.1,children:(0,a.jsxs)("button",{onClick:()=>ey(!0),className:"fixed top-6 left-6 z-50 flex items-center gap-2 px-3 py-1.5 rounded-full bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors group",title:"Switch to private tracks",children:[(0,a.jsx)(m.EyeOff,{className:"w-3.5 h-3.5 text-zinc-500 group-hover:text-zinc-700 dark:group-hover:text-zinc-300"}),(0,a.jsx)("span",{className:"text-xs text-zinc-500 group-hover:text-zinc-700 dark:group-hover:text-zinc-300",children:"Private"})]})}),(0,a.jsx)(r.motion.div,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm pointer-events-none z-10",initial:{opacity:0},animate:{opacity:+!!G},transition:{duration:.3,ease:"easeOut"}}),(0,a.jsxs)("div",{className:"flex flex-col items-center pt-16 pb-32 px-4 relative z-20",children:[(0,a.jsx)(n,{delay:.04,children:(0,a.jsxs)("div",{className:"relative flex items-center justify-center",children:[!V&&(0,a.jsx)(r.motion.div,{className:"absolute right-full mr-6 w-[320px] h-[520px]",initial:{opacity:0,x:50,scale:.95},animate:{opacity:+!!H,x:50*!H,scale:H?1:.95,pointerEvents:H?"auto":"none"},transition:{type:"spring",stiffness:400,damping:35,mass:.8},children:(0,a.jsx)("div",{className:"h-full rounded-2xl bg-gradient-to-b from-[#f5f5f5] to-[#d4d4d4] dark:from-zinc-800 dark:to-zinc-900 border border-white/20 overflow-hidden shadow-2xl",children:ev?(0,a.jsx)(eR,{}):(0,a.jsx)(eM,{onClose:W})})}),!V&&(0,a.jsx)(r.motion.div,{className:"absolute left-full ml-6 w-[320px] h-[520px]",initial:{opacity:0,x:-50,scale:.95},animate:{opacity:+!!H,x:H?0:-50,scale:H?1:.95,pointerEvents:H?"auto":"none"},transition:{type:"spring",stiffness:400,damping:35,mass:.8},children:(0,a.jsx)("div",{className:"h-full rounded-2xl bg-gradient-to-b from-[#f5f5f5] to-[#d4d4d4] dark:from-zinc-800 dark:to-zinc-900 border border-white/20 overflow-hidden shadow-2xl",children:ev?(0,a.jsx)(eD,{}):(0,a.jsx)(ew,{})})}),(0,a.jsx)(r.motion.div,{className:"relative",style:{scale:O},transition:{type:"spring",stiffness:400,damping:30},children:(0,a.jsxs)(r.motion.div,{className:"bg-gradient-to-b from-[#f5f5f5] to-[#d4d4d4] dark:from-zinc-800 dark:to-zinc-900 rounded-[32px] p-4 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.4)] border border-white/20 w-[300px] max-w-[calc(100vw-32px)]",initial:{y:20,opacity:0},animate:{y:0,opacity:1},style:{borderRadius:B,boxShadow:D?"0 35px 60px -15px rgba(0,0,0,0.5), 0 0 40px rgba(250,204,21,0.15)":"0 25px 50px -12px rgba(0,0,0,0.4)"},transition:{duration:.6,ease:"easeOut"},whileHover:D?void 0:{y:-2},children:[(0,a.jsxs)("div",{ref:eY,className:"bg-[#8fa39a] dark:bg-[#2a3a35] rounded-lg p-3 mb-4 shadow-inner border-2 border-[#6b7c74] dark:border-zinc-700 relative overflow-hidden cursor-pointer min-h-[240px]",onClick:()=>{q||"carousel"!==ex||eX()},children:[(0,a.jsx)(s.AnimatePresence,{mode:"wait",children:"auth"===ex?(0,a.jsx)(r.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",stiffness:400,damping:30},children:(0,a.jsx)(F,{onClose:eJ,onSuccess:()=>{em("carousel"),window.location.reload()}})},"auth"):"carousel"===ex?(0,a.jsx)(r.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"min-h-[200px] flex items-center justify-center",children:(0,a.jsx)(ei,{tracks:eH,currentTrack:e,isPlaying:l,onSelectAlbum:eZ,onSelectTrack:e0,onTogglePlay:T})},"carousel"):"album"===ex&&eu?(0,a.jsxs)(r.motion.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.2},className:"min-h-[200px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded overflow-hidden shadow-md flex-shrink-0",children:eu.albumArt?(0,a.jsx)("img",{src:eu.albumArt,alt:eu.name,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-[#697d75] dark:bg-[#1e2a26] flex items-center justify-center text-xl",children:"ðŸŽµ"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-xs font-bold text-[#1a2420] dark:text-[#8fa39a] truncate font-mono",children:eu.name}),(0,a.jsx)("div",{className:"text-[10px] text-[#3a4a45] dark:text-[#5a6a65] truncate font-mono",children:eu.artist})]})]}),(0,a.jsx)("div",{className:"space-y-1 max-h-[140px] overflow-y-auto",children:eu.tracks.map((t,i)=>(0,a.jsx)("button",{onClick:()=>e0(t),className:`w-full text-left p-2 rounded transition-colors ${t.id===e.id?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"hover:bg-[#697d75] dark:hover:bg-[#1e2a26] text-[#1a2420] dark:text-[#8fa39a]"}`,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-mono opacity-50 w-4",children:i+1}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"text-xs font-medium truncate font-mono",children:t.title})}),t.id===e.id&&l&&(0,a.jsxs)("div",{className:"flex gap-0.5",children:[(0,a.jsx)(r.motion.div,{className:"w-0.5 h-3 bg-current rounded-full",animate:{scaleY:[.3,1,.3]},transition:{duration:.5,repeat:1/0,delay:0}}),(0,a.jsx)(r.motion.div,{className:"w-0.5 h-3 bg-current rounded-full",animate:{scaleY:[1,.3,1]},transition:{duration:.5,repeat:1/0,delay:.1}}),(0,a.jsx)(r.motion.div,{className:"w-0.5 h-3 bg-current rounded-full",animate:{scaleY:[.5,1,.5]},transition:{duration:.5,repeat:1/0,delay:.2}})]})]})},t.id))})]},"album"):"playlist"===ex?(0,a.jsxs)(r.motion.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.2},className:"min-h-[200px]",children:[(0,a.jsx)("div",{className:"text-[10px] font-bold text-[#1a2420] dark:text-[#8fa39a] uppercase tracking-wider mb-2 font-mono",children:"All Tracks"}),(0,a.jsx)("div",{className:"space-y-1 max-h-[180px] overflow-y-auto",children:eH.map((t,i)=>(0,a.jsx)("button",{onClick:()=>e0(t),className:`w-full text-left p-2 rounded transition-colors ${t.id===e.id?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"hover:bg-[#697d75] dark:hover:bg-[#1e2a26] text-[#1a2420] dark:text-[#8fa39a]"}`,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-mono opacity-50",children:i+1}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-xs font-medium truncate font-mono",children:t.title}),(0,a.jsx)("div",{className:"text-[10px] opacity-70 truncate font-mono",children:t.artist})]})]})},t.id))})]},"playlist"):"create"===ex?(0,a.jsx)(r.motion.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.2},className:"min-h-[200px]",children:eB?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-4",children:[(0,a.jsx)(r.motion.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center mb-4",animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},children:(0,a.jsx)(k.Sparkles,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("div",{className:"text-xs text-[#1a2420] dark:text-[#8fa39a] font-mono mb-2",children:"Creating your track..."}),(0,a.jsx)("div",{className:"w-full max-w-[200px] h-2 bg-[#5a6a65]/30 dark:bg-[#1a2420]/50 rounded-full overflow-hidden",children:(0,a.jsx)(r.motion.div,{className:"h-full bg-violet-500",initial:{width:0},animate:{width:`${e_}%`},transition:{duration:.3}})}),(0,a.jsxs)("div",{className:"text-[10px] text-[#3a4a45] dark:text-[#5a6a65] mt-1 font-mono",children:[e_,"% complete"]}),(0,a.jsx)("button",{onClick:()=>eW(),className:"mt-3 text-[10px] text-red-500 hover:text-red-400 font-mono",children:"Cancel"})]}):eQ?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-4",children:[(0,a.jsx)(r.motion.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300},children:(0,a.jsx)(d.Music2,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("div",{className:"text-sm font-bold text-[#1a2420] dark:text-[#8fa39a] font-mono mb-1",children:"Track Created!"}),(0,a.jsxs)("div",{className:"text-[10px] text-[#3a4a45] dark:text-[#5a6a65] font-mono mb-3",children:[eN.slice(0,30),"..."]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{eW(),em("nowPlaying")},className:"px-3 py-1.5 text-[10px] font-mono bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420] rounded-full",children:"Play"}),(0,a.jsx)("button",{onClick:()=>{eW(),ez("")},className:"px-3 py-1.5 text-[10px] font-mono bg-[#5a6a65]/30 text-[#1a2420] dark:text-[#8fa39a] rounded-full",children:"Create Another"})]})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"text-[10px] font-bold text-[#1a2420] dark:text-[#8fa39a] uppercase tracking-wider font-mono",children:"Create with AI"}),(0,a.jsx)("input",{type:"text",value:eN,onChange:e=>ez(e.target.value),placeholder:"Describe your track...",className:"w-full px-3 py-2 text-xs font-mono bg-[#5a6a65]/20 dark:bg-[#1a2420]/50 border border-[#5a6a65]/30 dark:border-[#3a4a45]/30 rounded-lg text-[#1a2420] dark:text-[#8fa39a] placeholder-[#3a4a45]/50 dark:placeholder-[#5a6a65]/50 focus:outline-none focus:ring-1 focus:ring-violet-500"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(eV.MUSIC_PRESETS).slice(0,4).map(([e,t])=>(0,a.jsx)("button",{onClick:()=>ez(t.prompt),className:"px-2 py-1 text-[9px] font-mono bg-[#5a6a65]/20 dark:bg-[#1a2420]/50 text-[#1a2420] dark:text-[#8fa39a] rounded-full hover:bg-violet-500/20 transition-colors",children:t.prompt.split(" ").slice(0,2).join(" ")},e))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-[9px] font-mono text-[#3a4a45] dark:text-[#5a6a65] w-12",children:[eC,"s"]}),(0,a.jsx)("input",{type:"range",min:"10",max:"60",value:eC,onChange:e=>eA(Number(e.target.value)),className:"flex-1 h-1 bg-[#5a6a65]/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-violet-500"})]}),(0,a.jsx)("button",{onClick:()=>eP(!eS),className:"text-[9px] font-mono text-[#3a4a45] dark:text-[#5a6a65] hover:text-violet-500 transition-colors",children:eS?"â–² Less options":"â–¼ More options"}),(0,a.jsx)(s.AnimatePresence,{children:eS&&(0,a.jsxs)(r.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-2 overflow-hidden",children:[(0,a.jsx)("textarea",{value:eT,onChange:e=>e$(e.target.value),placeholder:"[Verse] Add lyrics here...",rows:3,className:"w-full px-3 py-2 text-[10px] font-mono bg-[#5a6a65]/20 dark:bg-[#1a2420]/50 border border-[#5a6a65]/30 dark:border-[#3a4a45]/30 rounded-lg text-[#1a2420] dark:text-[#8fa39a] placeholder-[#3a4a45]/50 dark:placeholder-[#5a6a65]/50 focus:outline-none focus:ring-1 focus:ring-violet-500 resize-none"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"number",value:eU||"",onChange:e=>eE(e.target.value?Number(e.target.value):void 0),placeholder:"BPM",className:"w-16 px-2 py-1 text-[10px] font-mono bg-[#5a6a65]/20 dark:bg-[#1a2420]/50 border border-[#5a6a65]/30 dark:border-[#3a4a45]/30 rounded text-[#1a2420] dark:text-[#8fa39a] placeholder-[#3a4a45]/50 focus:outline-none"}),(0,a.jsxs)("select",{value:eL||"",onChange:e=>eI(e.target.value||void 0),className:"flex-1 px-2 py-1 text-[10px] font-mono bg-[#5a6a65]/20 dark:bg-[#1a2420]/50 border border-[#5a6a65]/30 dark:border-[#3a4a45]/30 rounded text-[#1a2420] dark:text-[#8fa39a] focus:outline-none",children:[(0,a.jsx)("option",{value:"",children:"Key (auto)"}),(0,a.jsx)("option",{value:"C major",children:"C major"}),(0,a.jsx)("option",{value:"G major",children:"G major"}),(0,a.jsx)("option",{value:"D major",children:"D major"}),(0,a.jsx)("option",{value:"A minor",children:"A minor"}),(0,a.jsx)("option",{value:"E minor",children:"E minor"})]})]})]})}),(0,a.jsx)("button",{onClick:()=>{eN.trim()&&eO({prompt:eN,duration:eC,lyrics:eT||void 0,bpm:eU,key:eL})},disabled:!eN.trim(),className:"w-full py-2 text-xs font-mono font-bold bg-gradient-to-r from-violet-500 to-purple-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:from-violet-600 hover:to-purple-700 transition-all",children:"âœ¨ Generate Track"}),eF&&(0,a.jsx)("div",{className:"text-[10px] text-red-500 font-mono",children:eF})]})},"create"):(0,a.jsxs)(r.motion.div,{initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.2},children:[(0,a.jsxs)("div",{className:"w-full aspect-square bg-[#697d75] dark:bg-[#1e2a26] rounded-lg mb-3 flex items-center justify-center overflow-hidden shadow-lg relative",children:[P?(0,a.jsx)("video",{ref:K,src:e.audioSrc,className:"w-full h-full object-cover",playsInline:!0,preload:"metadata",onClick:e=>{e.stopPropagation(),T()}}):e.albumArt&&!ep?(0,a.jsx)("img",{src:e.albumArt,alt:`${e.album} cover`,className:"w-full h-full object-cover",onError:()=>eb(!0)}):(0,a.jsx)("span",{className:"text-5xl",children:"ðŸŽµ"}),(!P||!l)&&(0,a.jsx)(r.motion.div,{className:"absolute inset-0 flex items-center justify-center bg-black/20",initial:{opacity:0},animate:{opacity:+!l},whileHover:{opacity:1},onClick:e=>{e.stopPropagation(),T()},children:(0,a.jsx)(r.motion.div,{className:"p-3 rounded-full bg-white/30 backdrop-blur-sm cursor-pointer",whileHover:{scale:1.1},whileTap:{scale:.95},children:l?(0,a.jsx)(p.Pause,{className:"w-6 h-6 text-white"}):(0,a.jsx)(h.Play,{className:"w-6 h-6 text-white ml-0.5"})})})]}),(0,a.jsxs)("div",{className:"text-center mb-2",children:[(0,a.jsx)("div",{className:"text-[#1a2420] dark:text-[#8fa39a] font-bold text-sm truncate font-mono",children:e.title}),(0,a.jsx)("div",{className:"text-[#3a4a45] dark:text-[#5a6a65] text-xs truncate font-mono",children:e.artist})]}),(0,a.jsx)("div",{className:"relative h-2 bg-[#5a6a65] dark:bg-[#1a2420] rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"absolute left-0 top-0 h-full bg-[#1a2420] dark:bg-[#8fa39a] transition-all duration-150",style:{width:`${eq}%`}})}),(0,a.jsxs)("div",{className:"flex justify-between text-[10px] text-[#3a4a45] dark:text-[#5a6a65] mt-1 font-mono",children:[(0,a.jsx)("span",{children:eK(A)}),(0,a.jsx)("span",{children:eK(M)})]})]},"playing")}),"auth"!==ex&&(0,a.jsx)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-2 flex justify-center gap-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-0.5 px-2 py-1 rounded-full bg-[#697d75]/50 dark:bg-[#1a2420]/50 border border-[#5a6a65]/30 dark:border-[#3a4a45]/30",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),e&&em("nowPlaying")},className:`p-1.5 rounded-full transition-all ${"nowPlaying"===ex?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:"Now Playing",children:l?(0,a.jsx)(d.Music2,{className:"w-3 h-3"}):(0,a.jsx)(h.Play,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),em("carousel"),eh(null)},className:`p-1.5 rounded-full transition-all ${"carousel"===ex?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:"Albums",children:(0,a.jsx)(b.default,{className:"w-3 h-3"})}),eu&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),em("album")},className:`p-1.5 rounded-full transition-all ${"album"===ex?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:eu.name,children:(0,a.jsx)(g.Home,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),em("playlist")},className:`p-1.5 rounded-full transition-all ${"playlist"===ex?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:"All Tracks",children:(0,a.jsx)(o.List,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),em("create")},className:`p-1.5 rounded-full transition-all ${"create"===ex?"bg-violet-600 dark:bg-violet-500 text-white":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:"Create with AI",children:eB?(0,a.jsx)(j.Loader2,{className:"w-3 h-3 animate-spin"}):(0,a.jsx)(k.Sparkles,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),q?ey(!ej):eX()},className:`p-1.5 rounded-full transition-all ${ej&&q?"bg-emerald-600 dark:bg-emerald-500 text-white":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:q?ej?"Viewing Private":"View Private":"Private Access",children:(0,a.jsx)(c.Lock,{className:"w-3 h-3"})}),ed&&(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),ek(!ev),ev||G||Q()},className:`p-1.5 rounded-full transition-all ${ev?"bg-amber-500 dark:bg-amber-400 text-white":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:ev?"Exit admin mode":"Admin settings",children:(0,a.jsx)(u.Settings,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),ev&&ek(!1),Y()},className:`p-1.5 rounded-full transition-all ${G?"bg-[#1a2420] dark:bg-[#8fa39a] text-[#8fa39a] dark:text-[#1a2420]":"text-[#1a2420]/70 dark:text-[#8fa39a]/70 hover:text-[#1a2420] dark:hover:text-[#8fa39a] hover:bg-[#5a6a65]/30 dark:hover:bg-[#3a4a45]/30"}`,title:G?"Collapse":"Expand",children:G?(0,a.jsx)(v.Minimize2,{className:"w-3 h-3"}):(0,a.jsx)(f.Maximize2,{className:"w-3 h-3"})})]})})]}),(0,a.jsxs)("div",{className:"relative mx-auto w-[200px] h-[200px]",children:[(0,a.jsxs)("div",{className:"absolute inset-0 rounded-full bg-gradient-to-b from-[#f0f0f0] to-[#c0c0c0] dark:from-zinc-700 dark:to-zinc-800 shadow-lg",children:[(0,a.jsx)("button",{onClick:()=>{"carousel"===ex?em("playlist"):"nowPlaying"===ex?em("album"):"album"===ex?(em("carousel"),eh(null)):"playlist"===ex?em("carousel"):"auth"===ex?eJ():"create"===ex&&(eW(),em("carousel"))},className:"absolute top-3 left-1/2 -translate-x-1/2 text-[10px] font-bold text-zinc-600 dark:text-zinc-400 tracking-wider hover:text-zinc-900 dark:hover:text-white transition-colors flex items-center gap-1",children:"auth"===ex?"BACK":"nowPlaying"===ex?"ALBUM":"album"===ex||"playlist"===ex||"create"===ex?"BACK":"MENU"}),(0,a.jsx)("button",{onClick:U,disabled:eG,className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white transition-colors disabled:opacity-30",title:"Previous track",children:(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M19 20L9 12l10-8v16zM7 19V5H5v14h2z"})})}),(0,a.jsx)("button",{onClick:$,disabled:eG,className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white transition-colors disabled:opacity-30",title:"Next track",children:(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M5 4l10 8-10 8V4zm12 1v14h2V5h-2z"})})}),(0,a.jsx)("button",{onClick:T,disabled:eG,className:"absolute bottom-3 left-1/2 -translate-x-1/2 text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-white transition-colors disabled:opacity-30",title:l?"Pause":"Play",children:(0,a.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:l?(0,a.jsx)("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"}):(0,a.jsx)("path",{d:"M8 5v14l11-7z"})})})]}),(0,a.jsx)("button",{onClick:()=>{if("auth"!==ex)if("carousel"===ex){if(eu||eH.length>0){let t=eH.find(t=>t.id===e.id);t&&eZ({name:t.album,artist:t.artist,albumArt:t.albumArt,tracks:eH.filter(e=>e.album===t.album&&e.artist===t.artist)})}}else"album"===ex&&eu?eu.tracks.some(t=>t.id===e.id)?T():e0(eu.tracks[0]):"playlist"===ex?Z?ef(!0):T():"nowPlaying"===ex&&T()},className:"absolute inset-0 m-auto w-[70px] h-[70px] rounded-full bg-gradient-to-b from-[#fafafa] to-[#e0e0e0] dark:from-zinc-600 dark:to-zinc-700 shadow-md hover:from-white hover:to-[#e8e8e8] dark:hover:from-zinc-500 dark:hover:to-zinc-600 transition-all active:shadow-inner flex items-center justify-center",title:"carousel"===ex?"Open album":"playlist"===ex&&Z?"Admin Settings":"Play/Pause",children:Z&&"playlist"===ex&&(0,a.jsx)(u.Settings,{className:"w-6 h-6 text-zinc-500 dark:text-zinc-400"})})]})]})})]})}),(0,a.jsx)(s.AnimatePresence,{children:V&&G&&(0,a.jsxs)(r.motion.div,{className:"fixed inset-0 top-20 bg-black/95 backdrop-blur-xl z-30 overflow-auto",initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},transition:{type:"spring",stiffness:400,damping:35},children:[(0,a.jsxs)("div",{className:"max-w-md mx-auto p-4 space-y-6 pb-32",children:[(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-white font-semibold text-lg mb-3",children:"Now Playing"}),(0,a.jsx)("div",{className:"rounded-xl overflow-hidden",children:(0,a.jsx)(ew,{})})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-white font-semibold text-lg mb-3",children:"Library"}),(0,a.jsx)("div",{className:"rounded-xl bg-black/60 border border-white/10 h-[400px] overflow-hidden",children:(0,a.jsx)(eM,{onClose:W})})]})]}),(0,a.jsx)(r.motion.button,{className:"fixed top-4 right-4 z-40 p-3 rounded-full bg-white/10 backdrop-blur-sm text-white hover:bg-white/20 transition-colors",onClick:W,whileTap:{scale:.95},children:(0,a.jsx)(v.Minimize2,{className:"w-5 h-5"})})]})}),(0,a.jsx)(s.AnimatePresence,{children:D&&(0,a.jsxs)(r.motion.div,{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 px-4 py-2 bg-black/80 backdrop-blur-sm rounded-full text-white text-sm font-mono",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:[(100*I).toFixed(0),"%"]})}),e.lyrics&&"nowPlaying"===ex&&(0,a.jsx)(n,{delay:.12,children:(0,a.jsxs)("div",{className:"w-full max-w-[320px] mt-8",children:[(0,a.jsx)("h2",{className:"text-xs font-mono uppercase tracking-widest text-zinc-500 dark:text-zinc-500 mb-3 text-center",children:"Lyrics"}),(0,a.jsx)("div",{className:"bg-white/60 dark:bg-zinc-900/60 backdrop-blur-sm rounded-xl p-5 border border-zinc-200 dark:border-zinc-800 shadow-sm",children:(0,a.jsx)("pre",{className:"text-zinc-700 dark:text-zinc-300 text-sm leading-relaxed whitespace-pre-wrap font-mono text-center",children:e.lyrics})})]})}),eH.length>1&&"carousel"===ex&&(0,a.jsx)(n,{delay:.16,children:(0,a.jsxs)("button",{onClick:()=>em("playlist"),className:"mt-6 flex items-center gap-2 text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200 transition-colors text-sm",children:[(0,a.jsx)(o.List,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["View all ",eH.length," tracks"]})]})}),ej&&q&&ea&&(0,a.jsx)(n,{delay:.16,children:(0,a.jsx)("div",{className:"mt-6 text-sm text-zinc-500 dark:text-zinc-400",children:"Loading your tracks..."})}),ej&&q&&!ea&&0===ee.length&&(0,a.jsx)(n,{delay:.16,children:(0,a.jsxs)("div",{className:"mt-6 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"No tracks assigned to you yet."}),(0,a.jsx)("p",{className:"text-xs text-zinc-400 dark:text-zinc-500 mt-1",children:"Check back later or contact the administrator."}),(0,a.jsx)("button",{onClick:()=>ey(!1),className:"mt-3 text-xs text-emerald-600 dark:text-emerald-400 hover:underline",children:"View public tracks"})]})})]}),(0,a.jsx)(s.AnimatePresence,{children:eg&&(Z||ed)&&(0,a.jsx)(J,{onClose:()=>ef(!1)})})]})})}function eB(){return(0,a.jsx)(T,{children:(0,a.jsx)(eO,{})})}e.s(["MusicClient",()=>eB],949563)},146664,e=>{e.n(e.i(949563))}]);