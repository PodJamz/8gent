(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,692028,259371,e=>{"use strict";let t=(0,e.i(699528).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["default",()=>t],259371),e.s(["Calendar",()=>t],692028)},58977,e=>{"use strict";let t=(0,e.i(699528).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>t])},271119,e=>{"use strict";var t=e.i(58977);e.s(["ChevronLeft",()=>t.default])},200423,e=>{"use strict";let t=(0,e.i(699528).default)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);e.s(["default",()=>t])},165558,e=>{"use strict";var t=e.i(200423);e.s(["Repeat",()=>t.default])},200441,e=>{"use strict";var t=e.i(726151),s=e.i(923041),a=e.i(662582),i=e.i(278124),l=e.i(850402),r=e.i(334905),n=e.i(271119),c=e.i(55841),d=e.i(610724),o=e.i(692028),m=e.i(165558),x=e.i(254862),h=e.i(726152),u=e.i(591372),g=e.i(746115),p=e.i(801365),b=e.i(546840),f=e.i(140113),w=e.i(975157),j=e.i(946200);let y={whatsapp:"WhatsApp",imessage:"iMessage",telegram:"Telegram",slack:"Slack",discord:"Discord",email:"Email"},N={one_time:{icon:d.Clock,label:"One-time",color:"text-blue-400"},recurring:{icon:m.Repeat,label:"Recurring",color:"text-emerald-400"},trigger:{icon:b.Bell,label:"Trigger",color:"text-amber-400"}},v={pending:{label:"Pending",color:"text-amber-400",bg:"bg-amber-500/20"},sending:{label:"Sending",color:"text-blue-400",bg:"bg-blue-500/20"},sent:{label:"Sent",color:"text-emerald-400",bg:"bg-emerald-500/20"},failed:{label:"Failed",color:"text-red-400",bg:"bg-red-500/20"},cancelled:{label:"Cancelled",color:"text-gray-400",bg:"bg-gray-500/20"}};function k({message:e,onCancel:s,onDelete:i,isCancelling:l,isDeleting:r}){let n=N[e.scheduleType],c=v[e.status],b=n?.icon||d.Clock;return(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,w.cn)("p-1.5 rounded-lg bg-white/5",n?.color),children:(0,t.jsx)(b,{className:"w-4 h-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-white",children:e.title||"Scheduled Message"}),(0,t.jsx)("span",{className:(0,w.cn)("text-xs",n?.color),children:n?.label})]})]}),(0,t.jsx)("span",{className:(0,w.cn)("text-xs px-2 py-0.5 rounded-full",c?.color,c?.bg),children:c?.label})]}),(0,t.jsx)("div",{className:"mb-3 p-3 rounded-lg bg-black/20",children:(0,t.jsx)("p",{className:"text-sm text-white/80 line-clamp-2",children:"ai_generated"===e.messageType?(0,t.jsx)("span",{className:"italic text-white/60",children:"AI will generate content at send time"}):e.content})}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-white/50 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(o.Calendar,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:function(e){if(!e)return"Not scheduled";let t=new Date(e),s=new Date,a=t.toDateString()===s.toDateString(),i=new Date(s);i.setDate(i.getDate()+1);let l=t.toDateString()===i.toDateString(),r=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return a?`Today at ${r}`:l?`Tomorrow at ${r}`:t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}(e.nextSendAt)})]}),e.cronExpression&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(m.Repeat,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.cronExpression})]}),e.sendCount>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Send,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:["Sent ",e.sendCount,"x"]})]})]}),e.targetPlatforms&&e.targetPlatforms.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:e.targetPlatforms.map(e=>(0,t.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-white/60",children:y[e]||e},e))}),e.error&&(0,t.jsxs)("div",{className:"mb-3 p-2 rounded-lg bg-red-500/10 border border-red-500/20 flex items-start gap-2",children:[(0,t.jsx)(p.AlertCircle,{className:"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5"}),(0,t.jsx)("p",{className:"text-xs text-red-200",children:e.error})]}),"pending"===e.status&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:s,disabled:l,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-white/70 bg-white/5 hover:bg-white/10 transition-colors disabled:opacity-50",children:[l?(0,t.jsx)(g.Loader2,{className:"w-3 h-3 animate-spin"}):(0,t.jsx)(u.X,{className:"w-3 h-3"}),"Cancel"]}),(0,t.jsx)("button",{onClick:i,disabled:r,className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors disabled:opacity-50",children:r?(0,t.jsx)(g.Loader2,{className:"w-3 h-3 animate-spin"}):(0,t.jsx)(x.Trash2,{className:"w-3 h-3"})})]}),("sent"===e.status||"cancelled"===e.status||"failed"===e.status)&&(0,t.jsxs)("button",{onClick:i,disabled:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors disabled:opacity-50",children:[r?(0,t.jsx)(g.Loader2,{className:"w-3 h-3 animate-spin"}):(0,t.jsx)(x.Trash2,{className:"w-3 h-3"}),"Delete"]})]})}function C({isOpen:e,onClose:i,onCreate:l,isCreating:r}){let[n,c]=(0,s.useState)(""),[o,x]=(0,s.useState)(""),[h,p]=(0,s.useState)("one_time"),[b,f]=(0,s.useState)(""),[j,y]=(0,s.useState)("09:00"),[N,v]=(0,s.useState)("0 9 * * *");return e?(0,t.jsx)(a.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:i,children:(0,t.jsxs)(a.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md bg-zinc-900 rounded-2xl border border-white/10 overflow-hidden max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"p-4 border-b border-white/10 flex items-center justify-between sticky top-0 bg-zinc-900 z-10",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Schedule Message"}),(0,t.jsx)("button",{onClick:i,className:"p-1 rounded-lg hover:bg-white/10 transition-colors",children:(0,t.jsx)(u.X,{className:"w-5 h-5 text-white/60"})})]}),(0,t.jsxs)("form",{onSubmit:e=>{let t;if(e.preventDefault(),n.trim()){if("one_time"===h&&b){let[e,s,a]=b.split("-").map(Number),[i,l]=j.split(":").map(Number);t=new Date(e,s-1,a,i,l).getTime()}l({content:n.trim(),scheduleType:h,scheduledFor:t,cronExpression:"recurring"===h?N:void 0,title:o.trim()||void 0,category:"custom"})}},className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:"Title (optional)"}),(0,t.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),placeholder:"e.g., Morning check-in",className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Message ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:"What would you like 8gent to send?",rows:3,required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Schedule Type"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>p("one_time"),className:(0,w.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors","one_time"===h?"bg-primary text-primary-foreground":"bg-white/5 text-white/70 hover:bg-white/10"),children:[(0,t.jsx)(d.Clock,{className:"w-4 h-4"}),"One-time"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>p("recurring"),className:(0,w.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors","recurring"===h?"bg-primary text-primary-foreground":"bg-white/5 text-white/70 hover:bg-white/10"),children:[(0,t.jsx)(m.Repeat,{className:"w-4 h-4"}),"Recurring"]})]})]}),"one_time"===h&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Date ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("input",{type:"date",value:b,onChange:e=>f(e.target.value),min:new Date().toISOString().split("T")[0],required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white focus:outline-none focus:border-white/30 transition-colors"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Time ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("input",{type:"time",value:j,onChange:e=>y(e.target.value),required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white focus:outline-none focus:border-white/30 transition-colors"})]})]}),"recurring"===h&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Cron Expression ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:N,onChange:e=>v(e.target.value),placeholder:"0 9 * * *",required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors"}),(0,t.jsx)("p",{className:"text-xs text-white/40 mt-1",children:"Example: 0 9 * * * = every day at 9:00 AM"})]}),(0,t.jsx)("button",{type:"submit",disabled:r||!n.trim(),className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-sm font-medium text-white bg-[hsl(142_70%_45%)] hover:bg-[hsl(142_70%_40%)] transition-colors disabled:opacity-50",children:r?(0,t.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Clock,{className:"w-4 h-4"}),"Schedule Message"]})})]})]})}):null}function S(){let{user:e,isLoaded:o}=(0,j.useUser)(),m=e?.id||"",[x,h]=(0,s.useState)(!1),[u,b]=(0,s.useState)(!1),[w,y]=(0,s.useState)(null),[N,v]=(0,s.useState)(null),[S,M]=(0,s.useState)(null),T=(0,l.useQuery)(r.api.scheduledMessages.getUserScheduledMessages,m?{userId:m}:"skip"),D=(0,l.useMutation)(r.api.scheduledMessages.createScheduledMessage),P=(0,l.useMutation)(r.api.scheduledMessages.cancelScheduledMessage),I=(0,l.useMutation)(r.api.scheduledMessages.deleteScheduledMessage),A=async e=>{if(!m)return void M("Please sign in to schedule messages.");b(!0),M(null);try{await D({userId:m,content:e.content,messageType:"text",scheduleType:e.scheduleType,scheduledFor:e.scheduledFor,cronExpression:e.cronExpression,title:e.title,category:e.category}),h(!1)}catch(e){console.error("Failed to create scheduled message:",e),M("Failed to schedule message. Please try again.")}finally{b(!1)}},_=async e=>{y(e),M(null);try{await P({messageId:e})}catch(e){console.error("Failed to cancel message:",e),M("Failed to cancel message. Please try again.")}finally{y(null)}},F=async e=>{v(e),M(null);try{await I({messageId:e})}catch(e){console.error("Failed to delete message:",e),M("Failed to delete message. Please try again.")}finally{v(null)}},L=T?.filter(e=>"pending"===e.status)||[],R=T?.filter(e=>"pending"!==e.status)||[];return(0,t.jsxs)("div",{className:"min-h-screen bg-zinc-950",children:[(0,t.jsx)("header",{className:"sticky top-0 z-40 bg-zinc-950/80 backdrop-blur-xl border-b border-white/10",children:(0,t.jsxs)("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(f.default,{href:"/messages",className:"p-2 -ml-2 rounded-lg hover:bg-white/10 transition-colors","aria-label":"Back to messages",children:(0,t.jsx)(n.ChevronLeft,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-white",children:"Scheduled"})]}),(0,t.jsx)("button",{onClick:()=>h(!0),className:"p-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:(0,t.jsx)(c.Plus,{className:"w-5 h-5"})})]})}),(0,t.jsxs)("main",{className:"max-w-lg mx-auto px-4 py-6",children:[S&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-start gap-3",children:[(0,t.jsx)(p.AlertCircle,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),(0,t.jsx)("p",{className:"text-sm text-red-200/80",children:S})]}),o&&T?(0,t.jsxs)("div",{className:"space-y-6",children:[L.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-sm font-medium text-white/60 uppercase tracking-wider mb-3",children:["Upcoming (",L.length,")"]}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsx)(i.AnimatePresence,{children:L.map(e=>(0,t.jsx)(k,{message:e,onCancel:()=>_(e.messageId),onDelete:()=>F(e.messageId),isCancelling:w===e.messageId,isDeleting:N===e.messageId},e.messageId))})})]}),R.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-sm font-medium text-white/60 uppercase tracking-wider mb-3",children:["History (",R.length,")"]}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsx)(i.AnimatePresence,{children:R.map(e=>(0,t.jsx)(k,{message:e,onCancel:()=>_(e.messageId),onDelete:()=>F(e.messageId),isCancelling:w===e.messageId,isDeleting:N===e.messageId},e.messageId))})})]}),0===L.length&&0===R.length&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 flex items-center justify-center",children:(0,t.jsx)(d.Clock,{className:"w-8 h-8 text-white/30"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No scheduled messages"}),(0,t.jsx)("p",{className:"text-sm text-white/50 mb-6",children:"Schedule messages to be sent at specific times or on a recurring basis."}),(0,t.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary/90 transition-colors",children:[(0,t.jsx)(c.Plus,{className:"w-4 h-4"}),"Schedule a Message"]})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(g.Loader2,{className:"w-6 h-6 text-white/50 animate-spin"})})]}),(0,t.jsx)(i.AnimatePresence,{children:x&&(0,t.jsx)(C,{isOpen:x,onClose:()=>h(!1),onCreate:A,isCreating:u})})]})}e.s(["default",()=>S])}]);