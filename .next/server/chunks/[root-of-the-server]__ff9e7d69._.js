module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},666680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},504446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},755004,(e,t,r)=>{t.exports=e.x("tls",()=>require("tls"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},879389,e=>{"use strict";var t=e.i(848920);let r=null;async function a(e,a,i){try{let o,s=(null===r&&process.env.NEXT_PUBLIC_CONVEX_URL&&(r=new t.ConvexHttpClient(process.env.NEXT_PUBLIC_CONVEX_URL)),r);if(!s){console.warn("[Security] Convex client not available, logging to console only"),console.log("[Security Event]",e.eventType,e.message);return}let l=n(a),c=a.headers.get("user-agent")||"unknown",d=(o={},/bot|crawler|spider|crawling/i.test(c)?o.deviceType="bot":/mobile|android|iphone|ipad|ipod|blackberry|windows phone/i.test(c)?/ipad|tablet|playbook|silk/i.test(c)?o.deviceType="tablet":o.deviceType="mobile":o.deviceType="desktop",/firefox/i.test(c)?o.browser="Firefox":/edg/i.test(c)?o.browser="Edge":/chrome|chromium|crios/i.test(c)?o.browser="Chrome":/safari/i.test(c)?o.browser="Safari":/opera|opr/i.test(c)?o.browser="Opera":/msie|trident/i.test(c)?o.browser="IE":o.browser="Unknown",/windows/i.test(c)?o.os="Windows":/macintosh|mac os x/i.test(c)?o.os="macOS":/linux/i.test(c)?o.os="Linux":/android/i.test(c)?o.os="Android":/iphone|ipad|ipod/i.test(c)?o.os="iOS":o.os="Unknown",o),u=function(e,t,r){let a=`${e}|${t}|`,n=0;for(let e=0;e<a.length;e++)n=(n<<5)-n+a.charCodeAt(e),n&=n;return Math.abs(n).toString(16).padStart(8,"0")}(l,c),p=(0,t.makeFunctionReference)("security:logSecurityEvent");await s.mutation(p,{eventType:e.eventType,severity:e.severity,actorType:e.actorType,actorId:e.actorId,actorEmail:e.actorEmail,message:e.message,metadata:e.metadata,targetResource:e.targetResource,targetId:e.targetId,ipAddress:l,userAgent:c,fingerprint:u,deviceType:d.deviceType,browser:d.browser,os:d.os,country:i?.country,region:i?.region,city:i?.city}),console.log("[Security] Event logged:",e.eventType,e.severity)}catch(t){console.error("[Security] Failed to log event to Convex:",t),console.log("[Security Event Fallback]",e.eventType,e.message)}}function n(e){let t=e.headers,r=t.get("x-vercel-forwarded-for");if(r)return r.split(",")[0].trim();let a=t.get("cf-connecting-ip");if(a)return a;let n=t.get("x-forwarded-for");if(n)return n.split(",")[0].trim();let i=t.get("x-real-ip");return i||"unknown"}let i=new Map;function o(e,t){let r=Date.now(),a=i.get(e);if(!a||a.resetAt<r){let a=r+t.windowMs;return i.set(e,{count:1,resetAt:a}),{allowed:!0,remaining:t.maxRequests-1,resetAt:a}}return a.count>=t.maxRequests?{allowed:!1,remaining:0,resetAt:a.resetAt}:(a.count++,{allowed:!0,remaining:t.maxRequests-a.count,resetAt:a.resetAt})}"u">typeof setInterval&&setInterval(()=>{let e=Date.now();for(let[t,r]of i.entries())r.resetAt<e&&i.delete(t)},6e4);let s=new Map;function l(e,t={maxAttempts:5,windowMs:9e5}){let r=Date.now(),a=s.get(e);return!a||r-a.firstAttempt>t.windowMs?(s.set(e,{count:1,firstAttempt:r}),!1):(a.count++,a.count>=t.maxAttempts)}function c(e){s.delete(e)}e.s(["checkRateLimit",()=>o,"clearFailedAttempts",()=>c,"getClientIp",()=>n,"logSecurityEvent",()=>a,"recordFailedAttempt",()=>l])},514509,e=>{"use strict";var t=e.i(457375),r=e.i(174015),a=e.i(116384),n=e.i(63831),i=e.i(868001),o=e.i(842780),s=e.i(763077),l=e.i(502964),c=e.i(993216),d=e.i(783900),u=e.i(295731),p=e.i(726839),m=e.i(775778),g=e.i(40992),h=e.i(432128),v=e.i(193695);e.i(44807);var x=e.i(989978),f=e.i(39334),w=e.i(879389);let y=new Map,R={windowMs:6e4,maxRequests:60},E=[{id:"nano-banana",name:"Nano Banana",description:"Fast image generation with Gemini 2.5 Flash",provider:"gemini",capabilities:["text-to-image","image-to-image"]},{id:"nano-banana-pro",name:"Nano Banana Pro",description:"High-quality image generation with Gemini 3 Pro",provider:"gemini",capabilities:["text-to-image","image-to-image"]}];async function b(e){let t=[],r="https://api.replicate.com/v1/models",a=0;for(;r&&a<5;){let n=await fetch(r,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw Error(`Replicate API error: ${n.status}`);let i=await n.json();if(i.results)for(let e of i.results){let r=[],a=`${e.name} ${e.description??""}`.toLowerCase();a.includes("video")||a.includes("animate")?a.includes("img2vid")||a.includes("image-to-video")?r.push("image-to-video"):r.push("text-to-video"):(r.push("text-to-image"),(a.includes("img2img")||a.includes("image-to-image"))&&r.push("image-to-image")),t.push({id:`${e.owner}/${e.name}`,name:e.name,description:e.description,provider:"replicate",capabilities:r,coverImage:e.cover_image_url})}r=i.next||null,a++}return t}async function A(e){let t=["text-to-image","image-to-image","text-to-video","image-to-video"],r={};e&&(r.Authorization=`Key ${e}`);let a=await fetch("https://api.fal.ai/v1/models?status=active",{headers:r});if(!a.ok)throw Error(`fal.ai API error: ${a.status}`);let n=await a.json();return n.models?n.models.filter(e=>t.includes(e.metadata.category)).map(e=>({id:e.endpoint_id,name:e.metadata.display_name,description:e.metadata.description,provider:"fal",capabilities:[e.metadata.category],coverImage:e.metadata.thumbnail_url})):[]}function C(e,t){let r=t.toLowerCase();return e.filter(e=>e.name.toLowerCase().includes(r)||e.description?.toLowerCase().includes(r)||e.id.toLowerCase().includes(r))}async function T(e){try{let t=(0,w.getClientIp)(e),r=(0,w.checkRateLimit)(`providers-models:${t}`,R);if(!r.allowed)return f.NextResponse.json({success:!1,error:"Rate limit exceeded. Please try again later."},{status:429,headers:{"Retry-After":String(Math.ceil((r.resetAt-Date.now())/1e3))}});let a=e.nextUrl.searchParams.get("provider"),n=e.nextUrl.searchParams.get("search")||void 0,i="true"===e.nextUrl.searchParams.get("refresh"),o=e.nextUrl.searchParams.get("capabilities"),s=o?o.split(","):null,l=process.env.REPLICATE_API_KEY,c=process.env.FAL_API_KEY,d=[],u={};if(!a||"gemini"===a){let e=E;n&&(e=C(e,n)),d.push(...e),u.gemini={success:!0,count:e.length,cached:!0}}if((!a||"replicate"===a)&&l){let e=`replicate-${n||"all"}`,t=null,r=!1;if(!i){let a=y.get(e);a&&Date.now()-a.timestamp<3e5&&(t=a.models,r=!0,n&&(t=C(t,n)))}if(!t)try{t=await b(l),y.set(e,{models:t,timestamp:Date.now()}),n&&(t=C(t,n))}catch(e){u.replicate={success:!1,count:0,error:e instanceof Error?e.message:"Unknown error"}}t&&(d.push(...t),u.replicate={success:!0,count:t.length,cached:r})}if((!a||"fal"===a)&&c){let e=`fal-${n||"all"}`,t=null,r=!1;if(!i){let a=y.get(e);a&&Date.now()-a.timestamp<3e5&&(t=a.models,r=!0)}if(!t)try{t=await A(c),y.set(e,{models:t,timestamp:Date.now()}),n&&(t=C(t,n))}catch(e){u.fal={success:!1,count:0,error:e instanceof Error?e.message:"Unknown error"}}t&&(d.push(...t),u.fal={success:!0,count:t.length,cached:r})}let p=d;return s&&s.length>0&&(p=d.filter(e=>e.capabilities.some(e=>s.includes(e)))),p.sort((e,t)=>e.provider!==t.provider?e.provider.localeCompare(t.provider):e.name.localeCompare(t.name)),f.NextResponse.json({success:!0,models:p,providers:u})}catch(e){return console.error("[Models API] Error:",e),f.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["GET",()=>T],48865);var k=e.i(48865);let P=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/providers/models/route",pathname:"/api/providers/models",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/providers/models/route.ts",nextConfigOutput:"",userland:k}),{workAsyncStorage:q,workUnitAsyncStorage:_,serverHooks:I}=P;function N(){return(0,a.patchFetch)({workAsyncStorage:q,workUnitAsyncStorage:_})}async function S(e,t,a){P.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/providers/models/route";f=f.replace(/\/index$/,"")||"/";let w=await P.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:y,params:R,nextConfig:E,parsedUrl:b,isDraftMode:A,prerenderManifest:C,routerServerContext:T,isOnDemandRevalidate:k,revalidateOnlyGenerated:q,resolvedPathname:_,clientReferenceManifest:I,serverActionsManifest:N}=w,S=(0,s.normalizeAppPath)(f),U=!!(C.dynamicRoutes[S]||C.routes[_]),O=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,b,!1):t.end("This page could not be found"),null);if(U&&!A){let e=!!C.routes[_],t=C.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await O();throw new v.NoFallbackError}}let j=null;!U||P.isDev||A||(j="/index"===(j=_)?"/":j);let M=!0===P.isDev||!U,$=U&&!M;N&&I&&(0,o.setManifestsSingleton)({page:f,clientReferenceManifest:I,serverActionsManifest:N});let D=e.method||"GET",H=(0,i.getTracer)(),L=H.getActiveScopeSpan(),F={params:R,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>P.onRequestError(e,t,a,n,T)},sharedContext:{buildId:y}},K=new l.NodeNextRequest(e),B=new l.NodeNextResponse(t),X=c.NextRequestAdapter.fromNodeNextRequest(K,(0,c.signalFromNodeResponse)(t));try{let o=async e=>P.handle(X,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=H.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${D} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${f}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!s&&k&&q&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await o(n);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=F.renderOpts.collectedTags;if(!U)return await (0,p.sendResponse)(K,B,i,F.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[h.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,a=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await P.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:k})},!1,T),t}},d=await P.handleResponse({req:e,nextConfig:E,cacheKey:j,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:k,revalidateOnlyGenerated:q,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:s});if(!U)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",k?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let v=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return s&&U||v.delete(h.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||v.get("Cache-Control")||v.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,p.sendResponse)(K,B,new Response(d.value.body,{headers:v,status:d.value.status||200})),null};L?await l(L):await H.withPropagatedContext(e.headers,()=>H.trace(d.BaseServerSpan.handleRequest,{spanName:`${D} ${f}`,kind:i.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},l))}catch(t){if(t instanceof v.NoFallbackError||await P.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:k})},!1,T),U)throw t;return await (0,p.sendResponse)(K,B,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>N,"routeModule",()=>P,"serverHooks",()=>I,"workAsyncStorage",()=>q,"workUnitAsyncStorage",()=>_],514509)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ff9e7d69._.js.map