module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},666680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},504446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},755004,(e,t,r)=>{t.exports=e.x("tls",()=>require("tls"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},879389,e=>{"use strict";var t=e.i(848920);let r=null;async function o(e,o,n){try{let i,a=(null===r&&process.env.NEXT_PUBLIC_CONVEX_URL&&(r=new t.ConvexHttpClient(process.env.NEXT_PUBLIC_CONVEX_URL)),r);if(!a){console.warn("[Security] Convex client not available, logging to console only"),console.log("[Security Event]",e.eventType,e.message);return}let l=s(o),p=o.headers.get("user-agent")||"unknown",c=(i={},/bot|crawler|spider|crawling/i.test(p)?i.deviceType="bot":/mobile|android|iphone|ipad|ipod|blackberry|windows phone/i.test(p)?/ipad|tablet|playbook|silk/i.test(p)?i.deviceType="tablet":i.deviceType="mobile":i.deviceType="desktop",/firefox/i.test(p)?i.browser="Firefox":/edg/i.test(p)?i.browser="Edge":/chrome|chromium|crios/i.test(p)?i.browser="Chrome":/safari/i.test(p)?i.browser="Safari":/opera|opr/i.test(p)?i.browser="Opera":/msie|trident/i.test(p)?i.browser="IE":i.browser="Unknown",/windows/i.test(p)?i.os="Windows":/macintosh|mac os x/i.test(p)?i.os="macOS":/linux/i.test(p)?i.os="Linux":/android/i.test(p)?i.os="Android":/iphone|ipad|ipod/i.test(p)?i.os="iOS":i.os="Unknown",i),d=function(e,t,r){let o=`${e}|${t}|`,s=0;for(let e=0;e<o.length;e++)s=(s<<5)-s+o.charCodeAt(e),s&=s;return Math.abs(s).toString(16).padStart(8,"0")}(l,p),u=(0,t.makeFunctionReference)("security:logSecurityEvent");await a.mutation(u,{eventType:e.eventType,severity:e.severity,actorType:e.actorType,actorId:e.actorId,actorEmail:e.actorEmail,message:e.message,metadata:e.metadata,targetResource:e.targetResource,targetId:e.targetId,ipAddress:l,userAgent:p,fingerprint:d,deviceType:c.deviceType,browser:c.browser,os:c.os,country:n?.country,region:n?.region,city:n?.city}),console.log("[Security] Event logged:",e.eventType,e.severity)}catch(t){console.error("[Security] Failed to log event to Convex:",t),console.log("[Security Event Fallback]",e.eventType,e.message)}}function s(e){let t=e.headers,r=t.get("x-vercel-forwarded-for");if(r)return r.split(",")[0].trim();let o=t.get("cf-connecting-ip");if(o)return o;let s=t.get("x-forwarded-for");if(s)return s.split(",")[0].trim();let n=t.get("x-real-ip");return n||"unknown"}let n=new Map;function i(e,t){let r=Date.now(),o=n.get(e);if(!o||o.resetAt<r){let o=r+t.windowMs;return n.set(e,{count:1,resetAt:o}),{allowed:!0,remaining:t.maxRequests-1,resetAt:o}}return o.count>=t.maxRequests?{allowed:!1,remaining:0,resetAt:o.resetAt}:(o.count++,{allowed:!0,remaining:t.maxRequests-o.count,resetAt:o.resetAt})}"u">typeof setInterval&&setInterval(()=>{let e=Date.now();for(let[t,r]of n.entries())r.resetAt<e&&n.delete(t)},6e4);let a=new Map;function l(e,t={maxAttempts:5,windowMs:9e5}){let r=Date.now(),o=a.get(e);return!o||r-o.firstAttempt>t.windowMs?(a.set(e,{count:1,firstAttempt:r}),!1):(o.count++,o.count>=t.maxAttempts)}function p(e){a.delete(e)}e.s(["checkRateLimit",()=>i,"clearFailedAttempts",()=>p,"getClientIp",()=>s,"logSecurityEvent",()=>o,"recordFailedAttempt",()=>l])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1179d8ab._.js.map