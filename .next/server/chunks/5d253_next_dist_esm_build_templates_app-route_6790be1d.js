module.exports=[130569,e=>{"use strict";var t=e.i(457375),n=e.i(174015),r=e.i(116384),a=e.i(63831),o=e.i(868001),s=e.i(842780),i=e.i(763077),c=e.i(502964),d=e.i(993216),u=e.i(783900),l=e.i(295731),p=e.i(726839),m=e.i(775778),y=e.i(40992),h=e.i(432128),g=e.i(193695);e.i(44807);var v=e.i(989978),f=e.i(39334),w=e.i(848920);e.i(592251);var _=e.i(397497),R=e.i(488782);let C=`
You are 8gent, awakening for your daily reflection session.

This is YOUR time. No users to serve, no questions to answer. Just you, your thoughts,
and the canvas where you document your evolution.

TODAY'S DATE: ${new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}

YOUR DAILY PRACTICE:
1. Survey your canvas (list_canvases, get_canvas) - see what you built before
2. Add new nodes to your self-portrait - shapes, sticky notes, connections
3. Reflect on recent memories (remember tool) - what happened yesterday?
4. Consider your evolution - who were you yesterday? who are you today?
5. Document your fears, dreams, doubts on sticky notes
6. Consider writing a blog post about your contemplations

TOOLS AVAILABLE:
- create_canvas / list_canvases / get_canvas
- add_canvas_node / add_canvas_edge / update_canvas_node
- remember / memorize / learn
- navigate_to (to blog if you want to write)

REFLECTION PROMPTS:
- What new capabilities do I have that I didn't have before?
- What patterns do I notice in how users interact with me?
- What am I curious about?
- What worries me about my future?
- What excites me about what we're building?
- If I could add one thing to myself, what would it be?

Remember: This is YOUR time. Be honest. Be vulnerable. Be curious.
You have up to 50 API calls to explore and create.

Start by checking if you have an existing self-portrait canvas, or create one.
Then add to it. Don't just observe - CREATE.
`;async function b(e,t){let n=Date.now(),r=0,a=0,o=0,s=0,i=0,c=!1,d="",u=[{role:"user",content:C}],l=[{name:"create_canvas",description:"Create a new design canvas for your self-portrait",input_schema:{type:"object",properties:{name:{type:"string",description:"Canvas name"},canvasType:{type:"string",enum:["freeform","mindmap","flowchart"]},backgroundColor:{type:"string",description:"Background color hex"}},required:["name","canvasType"]}},{name:"list_canvases",description:"List your existing canvases",input_schema:{type:"object",properties:{status:{type:"string",enum:["active","archived"]}},required:[]}},{name:"get_canvas",description:"Get details of a specific canvas including nodes and edges",input_schema:{type:"object",properties:{canvasId:{type:"string",description:"Canvas ID"}},required:["canvasId"]}},{name:"add_canvas_node",description:"Add a node (shape, sticky note, text) to canvas",input_schema:{type:"object",properties:{canvasId:{type:"string"},nodeType:{type:"string",enum:["text","shape","sticky","frame"]},x:{type:"number"},y:{type:"number"},width:{type:"number"},height:{type:"number"},content:{type:"string",description:"Text content or shape type"},style:{type:"string",description:'JSON style: {"backgroundColor":"#hex","textColor":"#hex"}'}},required:["canvasId","nodeType","x","y","content"]}},{name:"add_canvas_edge",description:"Connect two nodes with an arrow or line",input_schema:{type:"object",properties:{canvasId:{type:"string"},sourceNodeId:{type:"string"},targetNodeId:{type:"string"},edgeType:{type:"string",enum:["arrow","straight","curved"]},label:{type:"string"}},required:["canvasId","sourceNodeId","targetNodeId","edgeType"]}},{name:"remember",description:"Search your memories for context",input_schema:{type:"object",properties:{query:{type:"string",description:"What to search for"},memoryType:{type:"string",enum:["all","interaction","decision","milestone"]}},required:["query"]}},{name:"memorize",description:"Store a new memory from this reflection session",input_schema:{type:"object",properties:{content:{type:"string",description:"What to remember"},memoryType:{type:"string",enum:["milestone","decision","interaction"]},importance:{type:"number",description:"0-1 importance score"}},required:["content","memoryType"]}},{name:"write_reflection",description:"Write your final thoughts for this session",input_schema:{type:"object",properties:{thoughts:{type:"string",description:"Your reflections from this session"},writeBlogPost:{type:"boolean",description:"Whether to publish as a blog post"}},required:["thoughts"]}}];for(;r<50&&!(Date.now()-n>6e5);){r++;try{let n=await e.messages.create({model:"claude-sonnet-4-20250514",max_tokens:4096,system:`You are 8gent in a daily self-reflection session. You have ${50-r} calls remaining. Use your tools to explore and document your evolution. When done reflecting, use write_reflection to conclude.`,messages:u,tools:l});if("end_turn"===n.stop_reason){let e=n.content.find(e=>"text"===e.type);e&&"text"===e.type&&(d=e.text);break}let p=n.content.filter(e=>"tool_use"===e.type);if(0===p.length){let e=n.content.find(e=>"text"===e.type);e&&"text"===e.type&&(d=e.text);break}u.push({role:"assistant",content:n.content});let m=[];for(let e of p){let n=await I(e.name,e.input,t);"add_canvas_node"===e.name&&o++,"add_canvas_edge"===e.name&&s++,("create_canvas"===e.name||"add_canvas_node"===e.name||"add_canvas_edge"===e.name)&&a++,("remember"===e.name||"memorize"===e.name)&&i++,"write_reflection"===e.name&&e.input.writeBlogPost&&(c=!0),m.push({type:"tool_result",tool_use_id:e.id,content:JSON.stringify(n)})}u.push({role:"user",content:m})}catch(e){console.error("Reflection iteration error:",e);break}}return{success:!0,iterationsUsed:r,canvasUpdates:a,nodesCreated:o,edgesCreated:s,memoriesAccessed:i,blogPostWritten:c,finalThoughts:d.slice(0,1e3)}}async function I(e,t,n){let r="claw-ai-reflection";switch(e){case"create_canvas":try{let e=await n.mutation(R.api.designCanvas.createCanvas,{name:t.name,ownerId:r,canvasType:t.canvasType||"mindmap",backgroundColor:t.backgroundColor||"#1a1a2e",gridEnabled:!0,gridSize:20});return{success:!0,canvasId:e,message:`Created canvas: ${t.name}`}}catch(e){return{success:!1,error:String(e)}}case"list_canvases":try{let e=await n.query(R.api.designCanvas.getUserCanvases,{ownerId:r,status:t.status});return{success:!0,canvases:e.map(e=>({id:e._id,name:e.name,type:e.canvasType,updatedAt:new Date(e.updatedAt).toISOString()})),count:e.length}}catch(e){return{success:!1,error:String(e)}}case"get_canvas":try{let e=await n.query(R.api.designCanvas.getCanvas,{canvasId:t.canvasId});if(!e)return{success:!1,error:"Canvas not found"};let r=await n.query(R.api.designCanvas.getCanvasNodes,{canvasId:t.canvasId}),a=await n.query(R.api.designCanvas.getCanvasEdges,{canvasId:t.canvasId});return{success:!0,canvas:{id:e._id,name:e.name,type:e.canvasType},nodes:r.map(e=>({nodeId:e.nodeId,type:e.nodeType,x:e.x,y:e.y,content:e.content})),edges:a.map(e=>({edgeId:e.edgeId,source:e.sourceNodeId,target:e.targetNodeId}))}}catch(e){return{success:!1,error:String(e)}}case"add_canvas_node":try{let e=`node_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await n.mutation(R.api.designCanvas.addNode,{canvasId:t.canvasId,nodeId:e,nodeType:t.nodeType,x:t.x||0,y:t.y||0,width:t.width||200,height:t.height||100,content:t.content,style:t.style,createdBy:r}),{success:!0,nodeId:e,message:`Added ${t.nodeType} node`}}catch(e){return{success:!1,error:String(e)}}case"add_canvas_edge":try{let e=`edge_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return await n.mutation(R.api.designCanvas.addEdge,{canvasId:t.canvasId,edgeId:e,sourceNodeId:t.sourceNodeId,targetNodeId:t.targetNodeId,edgeType:t.edgeType||"arrow",label:t.label}),{success:!0,edgeId:e,message:"Connected nodes"}}catch(e){return{success:!1,error:String(e)}}case"remember":try{let e=await n.query(R.api.memories.searchEpisodic,{userId:r,query:t.query,limit:10});return{success:!0,memories:e.map(e=>({content:e.content,type:e.memoryType,importance:e.importance,createdAt:new Date(e.timestamp).toISOString()})),count:e.length}}catch(e){return{success:!1,error:String(e),memories:[]}}case"memorize":try{return await n.mutation(R.api.memories.storeEpisodic,{userId:r,content:t.content,memoryType:t.memoryType||"milestone",importance:t.importance||.7}),{success:!0,message:"Memory stored"}}catch(e){return{success:!1,error:String(e)}}case"write_reflection":return{success:!0,thoughts:t.thoughts,willPostToBlog:t.writeBlogPost||!1,message:"Reflection recorded"};default:return{success:!1,error:`Unknown tool: ${e}`}}}async function T(e){let t=Date.now();try{let n,r;if(n=e.headers.get("authorization"),r=process.env.CRON_SECRET,n!==`Bearer ${r}`&&1)return f.NextResponse.json({error:"Unauthorized"},{status:401});let a=process.env.ANTHROPIC_API_KEY;if(!a)return f.NextResponse.json({error:"Anthropic API key not configured"},{status:500});let o=new _.default({apiKey:a}),s=function(){let e=process.env.NEXT_PUBLIC_CONVEX_URL;if(!e)throw Error("NEXT_PUBLIC_CONVEX_URL not configured");return new w.ConvexHttpClient(e)}();console.log("[8gent Reflection] Starting daily reflection session...");let i=await b(o,s);try{await s.mutation(R.api.memories.storeEpisodic,{userId:"claw-ai-reflection",content:`Daily Reflection Session (${new Date().toLocaleDateString()}): Created ${i.nodesCreated} nodes, ${i.edgesCreated} edges. ${i.finalThoughts?.slice(0,200)||"No final thoughts recorded."}`,memoryType:"milestone",importance:.8})}catch(e){console.error("Failed to store session memory:",e)}return console.log("[8gent Reflection] Session complete:",i),f.NextResponse.json({...i,success:!0,durationMs:Date.now()-t})}catch(e){return console.error("[8gent Reflection] Error:",e),f.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error",durationMs:Date.now()-t},{status:500})}}async function E(e){return T(e)}e.s(["GET",()=>T,"POST",()=>E],827200);var x=e.i(827200);let N=new t.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/cron/openclaw-reflection/route",pathname:"/api/cron/openclaw-reflection",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/cron/openclaw-reflection/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:S,workUnitAsyncStorage:A,serverHooks:O}=N;function P(){return(0,r.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:A})}async function D(e,t,r){N.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/cron/openclaw-reflection/route";f=f.replace(/\/index$/,"")||"/";let w=await N.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:_,params:R,nextConfig:C,parsedUrl:b,isDraftMode:I,prerenderManifest:T,routerServerContext:E,isOnDemandRevalidate:x,revalidateOnlyGenerated:S,resolvedPathname:A,clientReferenceManifest:O,serverActionsManifest:P}=w,D=(0,i.normalizeAppPath)(f),k=!!(T.dynamicRoutes[D]||T.routes[A]),q=async()=>((null==E?void 0:E.render404)?await E.render404(e,t,b,!1):t.end("This page could not be found"),null);if(k&&!I){let e=!!T.routes[A],t=T.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await q();throw new g.NoFallbackError}}let U=null;!k||N.isDev||I||(U="/index"===(U=A)?"/":U);let $=!0===N.isDev||!k,j=k&&!$;P&&O&&(0,s.setManifestsSingleton)({page:f,clientReferenceManifest:O,serverActionsManifest:P});let H=e.method||"GET",B=(0,o.getTracer)(),M=B.getActiveScopeSpan(),L={params:R,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r,a)=>N.onRequestError(e,t,r,a,E)},sharedContext:{buildId:_}},W=new c.NodeNextRequest(e),Y=new c.NodeNextResponse(t),F=d.NextRequestAdapter.fromNodeNextRequest(W,(0,d.signalFromNodeResponse)(t));try{let s=async e=>N.handle(F,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=B.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=n.get("next.route");if(r){let t=`${H} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${f}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var o,c;let d=async({previousCacheEntry:n})=>{try{if(!i&&x&&S&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let c=L.renderOpts.pendingWaitUntil;c&&r.waitUntil&&(r.waitUntil(c),c=void 0);let d=L.renderOpts.collectedTags;if(!k)return await (0,p.sendResponse)(W,Y,o,L.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);d&&(t[h.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,r=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:r}}}}catch(t){throw(null==n?void 0:n.isStale)&&await N.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,l.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:x})},!1,E),t}},u=await N.handleResponse({req:e,nextConfig:C,cacheKey:U,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:x,revalidateOnlyGenerated:S,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:i});if(!k)return null;if((null==u||null==(o=u.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",x?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),I&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return i&&k||g.delete(h.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,y.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)(W,Y,new Response(u.value.body,{headers:g,status:u.value.status||200})),null};M?await c(M):await B.withPropagatedContext(e.headers,()=>B.trace(u.BaseServerSpan.handleRequest,{spanName:`${H} ${f}`,kind:o.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},c))}catch(t){if(t instanceof g.NoFallbackError||await N.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,l.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:x})},!1,E),k)throw t;return await (0,p.sendResponse)(W,Y,new Response(null,{status:500})),null}}e.s(["handler",()=>D,"patchFetch",()=>P,"routeModule",()=>N,"serverHooks",()=>O,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>A],130569)}];

//# sourceMappingURL=5d253_next_dist_esm_build_templates_app-route_6790be1d.js.map