{"version":3,"sources":["../../../../src/app/studio/page.tsx","../../../../src/lib/jamz/types.ts","../../../../src/lib/jamz/useAudioEngine.ts","../../../../src/lib/jamz/storage.ts","../../../../src/lib/jamz/mp3Encoder.ts","../../../../src/lib/jamz/useStemSeparation.ts","../../../../src/components/jamz/GenerateView.tsx","../../../../src/hooks/useMusicGeneration.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback, useRef, useMemo, memo } from 'react';\nimport { motion, AnimatePresence, useReducedMotion } from 'framer-motion';\nimport Link from 'next/link';\nimport { useTheme } from 'next-themes';\nimport { useDesignThemeSafe } from '@/context/DesignThemeContext';\nimport '@/lib/themes/themes.css';\nimport {\n  Play,\n  Pause,\n  Square,\n  Circle,\n  SkipBack,\n  SkipForward,\n  Repeat,\n  Volume2,\n  Mic,\n  Mic2,\n  Music,\n  Music4,\n  Sliders,\n  FolderOpen,\n  Plus,\n  Grid3X3,\n  Piano,\n  Guitar,\n  Waves,\n  Clock,\n  Undo,\n  Redo,\n  ZoomIn,\n  ZoomOut,\n  Speaker,\n  Home,\n  Upload,\n  Download,\n  X,\n  Check,\n  AlertCircle,\n  Loader2,\n  FileAudio,\n  Sparkles,\n  MessageCircle,\n  ChevronDown,\n  ChevronUp,\n  Settings,\n  HelpCircle,\n  Users,\n  Share2,\n  Scissors,\n  Shuffle,\n  Headphones,\n  Radio,\n  Disc3,\n  AudioWaveform,\n  Layers,\n  Zap,\n  Menu,\n} from 'lucide-react';\nimport { PageTransition } from '@/components/ios';\nimport {\n  JamzProject,\n  JamzTrack,\n  JamzClip,\n  createEmptyProject,\n  createTrack,\n  createClip,\n  generateId,\n  beatsToSeconds,\n  secondsToBeats,\n  formatTime,\n  formatBars,\n  TRACK_COLORS,\n  TRACK_COLOR_VALUES,\n} from '@/lib/jamz';\nimport { useAudioEngine } from '@/lib/jamz/useAudioEngine';\nimport { saveProject, loadProject } from '@/lib/jamz/storage';\nimport { audioBufferToMp3, formatFileSize } from '@/lib/jamz/mp3Encoder';\nimport { useStemSeparation, StemType } from '@/lib/jamz/useStemSeparation';\nimport { GenerateView } from '@/components/jamz/GenerateView';\nimport { cn } from '@/lib/utils';\n\n// ============================================================================\n// Accessibility & Performance Utilities\n// ============================================================================\n\nconst useMediaQuery = (query: string): boolean => {\n  const [matches, setMatches] = useState(false);\n  useEffect(() => {\n    const media = window.matchMedia(query);\n    setMatches(media.matches);\n    const listener = (e: MediaQueryListEvent) => setMatches(e.matches);\n    media.addEventListener('change', listener);\n    return () => media.removeEventListener('change', listener);\n  }, [query]);\n  return matches;\n};\n\n// Skip to content link for accessibility\nconst SkipToContent = memo(function SkipToContent() {\n  return (\n    <a\n      href=\"#main-content\"\n      className=\"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-[100] focus:px-4 focus:py-2 focus:bg-cyan-500 focus:text-white focus:rounded-lg focus:outline-none\"\n    >\n      Skip to main content\n    </a>\n  );\n});\n\n// ============================================================================\n// Types\n// ============================================================================\n\ntype ViewMode = 'arrange' | 'mixer' | 'browser';\ntype QuickJamAction = 'record' | 'upload' | 'template';\n\ninterface ClawAIMessage {\n  id: string;\n  role: 'assistant' | 'user';\n  content: string;\n  action?: {\n    type: string;\n    payload?: unknown;\n  };\n}\n\ninterface Feature {\n  icon: React.ReactNode;\n  title: string;\n  description: string;\n  gradient: string;\n}\n\n// ============================================================================\n// Landing Page Data\n// ============================================================================\n\n// Available features - fully implemented\nconst availableFeatures: Feature[] = [\n  {\n    icon: <AudioWaveform className=\"w-6 h-6\" />,\n    title: 'Multi-Track Recording',\n    description: 'Layer unlimited tracks with professional-grade audio capture and real-time monitoring.',\n    gradient: 'from-cyan-500 to-teal-600',\n  },\n  {\n    icon: <Download className=\"w-6 h-6\" />,\n    title: 'Export to WAV & MP3',\n    description: 'Export your finished tracks in high-quality formats ready for sharing or distribution.',\n    gradient: 'from-emerald-500 to-green-600',\n  },\n  {\n    icon: <Scissors className=\"w-6 h-6\" />,\n    title: 'Stem Separation',\n    description: 'Isolate vocals, drums, bass, and more from any audio file using advanced processing.',\n    gradient: 'from-amber-500 to-orange-600',\n  },\n];\n\n// Coming soon features - in development\nconst comingSoonFeatures: Feature[] = [\n  {\n    icon: <Sliders className=\"w-6 h-6\" />,\n    title: 'AI-Powered Mixing',\n    description: 'Intelligent auto-mixing that learns your style and enhances your sound automatically.',\n    gradient: 'from-sky-500 to-blue-600',\n  },\n  {\n    icon: <Piano className=\"w-6 h-6\" />,\n    title: 'Virtual Instruments',\n    description: 'Play synthesizers, pianos, drums, and more, all directly in your browser.',\n    gradient: 'from-rose-500 to-pink-600',\n  },\n  {\n    icon: <Layers className=\"w-6 h-6\" />,\n    title: 'Sample Library',\n    description: 'Thousands of royalty-free samples, loops, and one-shots at your fingertips.',\n    gradient: 'from-indigo-500 to-blue-600',\n  },\n  {\n    icon: <Zap className=\"w-6 h-6\" />,\n    title: 'Real-Time Collaboration',\n    description: 'Jam with friends anywhere in the world with zero-latency sync technology.',\n    gradient: 'from-yellow-500 to-amber-600',\n  },\n];\n\n// Combined for backwards compat\nconst features = [...availableFeatures, ...comingSoonFeatures];\n\n// ============================================================================\n// Claw AI Actions\n// ============================================================================\n\nconst CLAW_AI_ACTIONS = {\n  CREATE_TRACK: 'create_track',\n  DELETE_TRACK: 'delete_track',\n  SET_BPM: 'set_bpm',\n  ADD_LOOP: 'add_loop',\n  START_RECORDING: 'start_recording',\n  STOP_RECORDING: 'stop_recording',\n  EXPORT_MIX: 'export_mix',\n  EXPORT_STEMS: 'export_stems',\n  PLAY: 'play',\n  STOP: 'stop',\n  MUTE_TRACK: 'mute_track',\n  SOLO_TRACK: 'solo_track',\n  SET_VOLUME: 'set_volume',\n  IMPORT_FILE: 'import_file',\n  SEPARATE_STEMS: 'separate_stems',\n} as const;\n\n// ============================================================================\n// Theme-aware colors\n// ============================================================================\n\nconst getThemeColors = (theme: string | undefined, resolvedTheme: string | undefined) => {\n  const isDark = resolvedTheme === 'dark' || resolvedTheme === undefined;\n  return {\n    bg: isDark ? 'bg-zinc-950' : 'bg-slate-50',\n    bgSecondary: isDark ? 'bg-zinc-900' : 'bg-white',\n    bgTertiary: isDark ? 'bg-zinc-800' : 'bg-slate-100',\n    text: isDark ? 'text-white' : 'text-slate-900',\n    textSecondary: isDark ? 'text-white/80' : 'text-slate-700',\n    textMuted: isDark ? 'text-white/60' : 'text-slate-600',\n    textFaint: isDark ? 'text-white/40' : 'text-slate-400',\n    border: isDark ? 'border-white/10' : 'border-slate-200',\n    borderHover: isDark ? 'border-white/20' : 'border-slate-300',\n    card: isDark ? 'bg-white/5' : 'bg-white',\n    cardHover: isDark ? 'bg-white/10' : 'bg-slate-50',\n    isDark,\n  };\n};\n\n// ============================================================================\n// Landing Page Components (Optimized for Performance & Accessibility)\n// ============================================================================\n\nconst AnimatedBackground = memo(function AnimatedBackground({\n  isDark,\n  reducedMotion = false\n}: {\n  isDark: boolean;\n  reducedMotion?: boolean;\n}) {\n  // Use CSS animations for better performance, skip on reduced motion\n  if (reducedMotion) {\n    return (\n      <div\n        className=\"fixed inset-0 overflow-hidden pointer-events-none\"\n        aria-hidden=\"true\"\n      >\n        <div className={`absolute inset-0 ${isDark ? 'bg-gradient-to-br from-black via-zinc-950 to-black' : 'bg-gradient-to-br from-slate-100 via-white to-slate-100'}`} />\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"fixed inset-0 overflow-hidden pointer-events-none\"\n      aria-hidden=\"true\"\n    >\n      <div className={`absolute inset-0 ${isDark ? 'bg-gradient-to-br from-black via-zinc-950 to-black' : 'bg-gradient-to-br from-slate-100 via-white to-slate-100'}`} />\n      <div\n        className=\"absolute w-[300px] h-[300px] sm:w-[400px] sm:h-[400px] md:w-[600px] md:h-[600px] rounded-full opacity-20 will-change-transform animate-float-slow\"\n        style={{\n          background: 'radial-gradient(circle, rgba(6, 182, 212, 0.4) 0%, transparent 70%)',\n          top: '10%',\n          left: '10%',\n        }}\n      />\n      <div\n        className=\"absolute w-[250px] h-[250px] sm:w-[350px] sm:h-[350px] md:w-[500px] md:h-[500px] rounded-full opacity-15 will-change-transform animate-float-slower\"\n        style={{\n          background: 'radial-gradient(circle, rgba(20, 184, 166, 0.35) 0%, transparent 70%)',\n          bottom: '20%',\n          right: '5%',\n        }}\n      />\n      <div\n        className={`absolute inset-0 ${isDark ? 'opacity-[0.03]' : 'opacity-[0.05]'}`}\n        style={{\n          backgroundImage: `linear-gradient(${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'} 1px, transparent 1px), linear-gradient(90deg, ${isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'} 1px, transparent 1px)`,\n          backgroundSize: '64px 64px',\n        }}\n      />\n      <style jsx>{`\n        @keyframes float-slow {\n          0%, 100% { transform: translate(0, 0) scale(1); }\n          50% { transform: translate(50px, 25px) scale(1.1); }\n        }\n        @keyframes float-slower {\n          0%, 100% { transform: translate(0, 0) scale(1); }\n          50% { transform: translate(-40px, -30px) scale(1.15); }\n        }\n        .animate-float-slow { animation: float-slow 20s ease-in-out infinite; }\n        .animate-float-slower { animation: float-slower 25s ease-in-out infinite; }\n      `}</style>\n    </div>\n  );\n});\n\nconst WaveformVisualizer = memo(function WaveformVisualizer({\n  reducedMotion = false\n}: {\n  reducedMotion?: boolean;\n}) {\n  // Use fewer bars on mobile for performance\n  const isMobile = useMediaQuery('(max-width: 640px)');\n  const bars = isMobile ? 20 : 40;\n\n  // Static version for reduced motion\n  if (reducedMotion) {\n    return (\n      <div\n        className=\"flex items-end justify-center gap-1 h-24\"\n        role=\"img\"\n        aria-label=\"Audio waveform visualization\"\n      >\n        {Array.from({ length: bars }).map((_, i) => (\n          <div\n            key={i}\n            className=\"w-1 bg-gradient-to-t from-cyan-500 to-cyan-400 rounded-full\"\n            style={{ height: `${30 + (Math.sin(i * 0.3) * 20 + 20)}%` }}\n          />\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"flex items-end justify-center gap-0.5 sm:gap-1 h-16 sm:h-24\"\n      role=\"img\"\n      aria-label=\"Animated audio waveform visualization\"\n    >\n      {Array.from({ length: bars }).map((_, i) => (\n        <div\n          key={i}\n          className=\"w-0.5 sm:w-1 bg-gradient-to-t from-cyan-500 to-cyan-400 rounded-full will-change-transform\"\n          style={{\n            animation: `waveform ${0.5 + (i % 5) * 0.1}s ease-in-out infinite`,\n            animationDelay: `${i * 0.02}s`,\n            height: '30%',\n          }}\n        />\n      ))}\n      <style jsx>{`\n        @keyframes waveform {\n          0%, 100% { transform: scaleY(1); }\n          50% { transform: scaleY(2.5); }\n        }\n      `}</style>\n    </div>\n  );\n});\n\nconst FeatureCard = memo(function FeatureCard({\n  feature,\n  index,\n  colors,\n  reducedMotion = false,\n  isComingSoon = false\n}: {\n  feature: Feature;\n  index: number;\n  colors: ReturnType<typeof getThemeColors>;\n  reducedMotion?: boolean;\n  isComingSoon?: boolean;\n}) {\n  const [isHovered, setIsHovered] = useState(false);\n\n  const cardVariants = reducedMotion\n    ? { initial: { opacity: 1, y: 0 }, animate: { opacity: 1, y: 0 } }\n    : { initial: { opacity: 0, y: 30 }, animate: { opacity: 1, y: 0, transition: { duration: 0.5, delay: 0.1 + index * 0.1 } } };\n\n  return (\n    <motion.article\n      variants={cardVariants}\n      initial=\"initial\"\n      animate=\"animate\"\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n      onFocus={() => setIsHovered(true)}\n      onBlur={() => setIsHovered(false)}\n      className=\"group relative\"\n      tabIndex={0}\n      role=\"article\"\n      aria-label={`${feature.title}: ${feature.description}${isComingSoon ? ' (Coming Soon)' : ''}`}\n    >\n      <div className={`relative overflow-hidden rounded-2xl p-4 sm:p-6 ${colors.card} border ${colors.border} backdrop-blur-xl transition-all duration-300 ease-out ${isHovered ? `${colors.borderHover} shadow-2xl -translate-y-1` : ''} focus-within:ring-2 focus-within:ring-cyan-500 ${isComingSoon ? 'opacity-80' : ''}`}>\n        <div className={`absolute inset-0 bg-gradient-to-br ${feature.gradient} opacity-0 group-hover:opacity-10 group-focus-within:opacity-10 transition-opacity duration-300`} />\n        {isComingSoon && (\n          <div className=\"absolute top-3 right-3 px-2 py-0.5 rounded-full bg-amber-500/20 border border-amber-500/30\">\n            <span className=\"text-amber-400 text-[10px] font-medium\">Soon</span>\n          </div>\n        )}\n        <div className={`w-10 h-10 sm:w-12 sm:h-12 rounded-xl mb-3 sm:mb-4 bg-gradient-to-br ${feature.gradient} flex items-center justify-center text-white shadow-lg ${isComingSoon ? 'grayscale-[30%]' : ''}`} aria-hidden=\"true\">\n          {feature.icon}\n        </div>\n        <h3 className={`text-base sm:text-lg font-bold ${colors.text} mb-1 sm:mb-2`}>{feature.title}</h3>\n        <p className={`text-xs sm:text-sm ${colors.textFaint} leading-relaxed`}>{feature.description}</p>\n        <div\n          className={`absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r ${feature.gradient} transition-transform duration-300 origin-left ${isHovered ? 'scale-x-100' : 'scale-x-0'}`}\n          aria-hidden=\"true\"\n        />\n      </div>\n    </motion.article>\n  );\n});\n\nconst DAWPreview = memo(function DAWPreview({\n  colors,\n  reducedMotion = false\n}: {\n  colors: ReturnType<typeof getThemeColors>;\n  reducedMotion?: boolean;\n}) {\n  const isMobile = useMediaQuery('(max-width: 640px)');\n  const tracks = useMemo(() => [\n    { name: 'Drums', color: 'bg-cyan-500', width: '100%' },\n    { name: 'Bass', color: 'bg-cyan-500', width: '85%' },\n    { name: 'Synth Lead', color: 'bg-pink-500', width: '70%' },\n    { name: 'Vocals', color: 'bg-amber-500', width: '60%' },\n    { name: 'FX', color: 'bg-emerald-500', width: '45%' },\n  ], []);\n\n  // Use fewer waveform bars on mobile\n  const waveformBars = isMobile ? 30 : 60;\n\n  // Pre-generate random heights for performance\n  const waveformHeights = useMemo(\n    () => tracks.map(() => Array.from({ length: waveformBars }, () => 20 + Math.random() * 60)),\n    [tracks, waveformBars]\n  );\n\n  const containerVariants = reducedMotion\n    ? { initial: { opacity: 1, scale: 1 }, animate: { opacity: 1, scale: 1 } }\n    : { initial: { opacity: 0, scale: 0.95 }, animate: { opacity: 1, scale: 1, transition: { duration: 0.8, delay: 0.3 } } };\n\n  return (\n    <motion.div\n      variants={containerVariants}\n      initial=\"initial\"\n      animate=\"animate\"\n      className=\"relative w-full max-w-4xl mx-auto px-2 sm:px-0\"\n      role=\"img\"\n      aria-label=\"Digital Audio Workstation preview showing 5 audio tracks: Drums, Bass, Synth Lead, Vocals, and FX\"\n    >\n      <div className={`rounded-xl sm:rounded-2xl overflow-hidden border ${colors.border} ${colors.isDark ? 'bg-black/50' : 'bg-white/80'} backdrop-blur-xl shadow-2xl`}>\n        {/* Window Controls */}\n        <div className={`flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 border-b ${colors.border} ${colors.card}`}>\n          <div className=\"flex items-center gap-1.5 sm:gap-2\" aria-hidden=\"true\">\n            <div className=\"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-red-500/80\" />\n            <div className=\"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-yellow-500/80\" />\n            <div className=\"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-green-500/80\" />\n          </div>\n          <div className=\"flex items-center gap-1.5 sm:gap-2\">\n            <Disc3 className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 text-cyan-400\" aria-hidden=\"true\" />\n            <span className={`text-xs sm:text-sm ${colors.textMuted} font-medium`}>Jamz Studio</span>\n          </div>\n          <div className=\"w-12 sm:w-16\" />\n        </div>\n\n        {/* Transport Controls */}\n        <div className={`flex items-center justify-center gap-2 sm:gap-4 py-3 sm:py-4 border-b ${colors.border} ${colors.card}`}>\n          <button className={`p-1.5 sm:p-2 ${colors.textFaint} hover:${colors.text} transition-colors touch-manipulation`} aria-label=\"Shuffle\" tabIndex={-1}>\n            <Shuffle className=\"w-3.5 h-3.5 sm:w-4 sm:h-4\" />\n          </button>\n          <button className={`p-1.5 sm:p-2 ${colors.textMuted} hover:${colors.text} transition-colors touch-manipulation`} aria-label=\"Previous track\" tabIndex={-1}>\n            <SkipBack className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n          </button>\n          <button className=\"p-2.5 sm:p-3 rounded-full bg-gradient-to-r from-cyan-500 to-cyan-500 text-white shadow-lg hover:shadow-cyan-500/25 transition-shadow touch-manipulation\" aria-label=\"Play\" tabIndex={-1}>\n            <Play className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n          </button>\n          <button className={`p-1.5 sm:p-2 ${colors.textMuted} hover:${colors.text} transition-colors touch-manipulation`} aria-label=\"Next track\" tabIndex={-1}>\n            <SkipForward className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n          </button>\n          <button className={`p-1.5 sm:p-2 ${colors.textFaint} hover:${colors.text} transition-colors touch-manipulation`} aria-label=\"Repeat\" tabIndex={-1}>\n            <Repeat className=\"w-3.5 h-3.5 sm:w-4 sm:h-4\" />\n          </button>\n        </div>\n\n        {/* Tracks */}\n        <div className=\"p-2 sm:p-4 space-y-2 sm:space-y-3\">\n          {tracks.map((track, i) => (\n            <div\n              key={track.name}\n              className={`flex items-center gap-2 sm:gap-3 ${!reducedMotion ? 'animate-fade-in' : ''}`}\n              style={{ animationDelay: reducedMotion ? '0ms' : `${500 + i * 100}ms` }}\n            >\n              <div className=\"w-16 sm:w-24 flex-shrink-0\">\n                <div className={`text-[10px] sm:text-xs font-medium ${colors.textMuted} truncate`}>{track.name}</div>\n              </div>\n              <div className={`flex-1 h-8 sm:h-10 rounded-md sm:rounded-lg ${colors.card} overflow-hidden relative`}>\n                <div\n                  className={`absolute inset-y-0 left-0 ${track.color} opacity-30 transition-all duration-1000`}\n                  style={{ width: reducedMotion ? track.width : track.width }}\n                />\n                <div className=\"absolute inset-0 flex items-center px-1 sm:px-2 gap-px\">\n                  {waveformHeights[i].map((height, j) => (\n                    <div\n                      key={j}\n                      className={`w-0.5 sm:w-1 ${track.color} rounded-full opacity-60`}\n                      style={{ height: `${height}%` }}\n                    />\n                  ))}\n                </div>\n              </div>\n              <div className=\"w-6 sm:w-8 flex-shrink-0\">\n                <Volume2 className={`w-3.5 h-3.5 sm:w-4 sm:h-4 ${colors.textFaint}`} aria-hidden=\"true\" />\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Timeline */}\n        <div className=\"px-2 sm:px-4 pb-3 sm:pb-4\">\n          <div className={`flex items-center gap-2 text-[10px] sm:text-xs ${colors.textFaint}`}>\n            <span>0:00</span>\n            <div className={`flex-1 h-1 ${colors.bgTertiary} rounded-full overflow-hidden`} role=\"progressbar\" aria-valuemin={0} aria-valuemax={100} aria-valuenow={35}>\n              <div\n                className={`h-full bg-gradient-to-r from-cyan-500 to-teal-500 ${!reducedMotion ? 'transition-all duration-[2000ms]' : ''}`}\n                style={{ width: '35%' }}\n              />\n            </div>\n            <span>3:45</span>\n          </div>\n        </div>\n      </div>\n      <style jsx>{`\n        @keyframes fade-in {\n          from { opacity: 0; transform: translateX(-20px); }\n          to { opacity: 1; transform: translateX(0); }\n        }\n        .animate-fade-in {\n          animation: fade-in 0.5s ease-out forwards;\n          opacity: 0;\n        }\n      `}</style>\n    </motion.div>\n  );\n});\n\n// ============================================================================\n// Landing Page Component (Optimized for Performance, Mobile, Accessibility)\n// ============================================================================\n\nconst LandingPage = memo(function LandingPage({\n  onEnterStudio,\n  colors,\n  reducedMotion = false,\n  themeClass = '',\n}: {\n  onEnterStudio: () => void;\n  colors: ReturnType<typeof getThemeColors>;\n  reducedMotion?: boolean;\n  themeClass?: string;\n}) {\n  const instruments = useMemo(() => [\n    { icon: <Piano className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Piano', color: 'from-sky-500 to-blue-600' },\n    { icon: <Guitar className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Guitar', color: 'from-amber-500 to-orange-600' },\n    { icon: <AudioWaveform className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Drums', color: 'from-rose-500 to-pink-600' },\n    { icon: <Mic2 className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Vocals', color: 'from-cyan-500 to-teal-600' },\n    { icon: <Waves className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Synth', color: 'from-emerald-500 to-green-600' },\n    { icon: <Radio className=\"w-6 h-6 sm:w-8 sm:h-8\" />, name: 'Bass', color: 'from-yellow-500 to-amber-600' },\n  ], []);\n\n  // Animation variants for reduced motion support\n  const fadeInVariants = reducedMotion\n    ? { initial: { opacity: 1 }, animate: { opacity: 1 } }\n    : { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 } };\n\n  const scaleInVariants = reducedMotion\n    ? { initial: { opacity: 1, scale: 1 }, animate: { opacity: 1, scale: 1 } }\n    : { initial: { opacity: 0, scale: 0.5 }, animate: { opacity: 1, scale: 1 } };\n\n  return (\n    <main\n      id=\"main-content\"\n      className={`min-h-screen ${colors.bg} ${colors.text} relative ${themeClass}`}\n      role=\"main\"\n    >\n      <AnimatedBackground isDark={colors.isDark} reducedMotion={reducedMotion} />\n\n      <div className=\"relative z-10\">\n        {/* Fixed Navigation Header */}\n        <nav\n          className={`fixed top-0 left-0 right-0 z-50 px-4 py-3 ${colors.bgSecondary}/80 backdrop-blur-xl border-b ${colors.border}`}\n          role=\"navigation\"\n          aria-label=\"Main navigation\"\n        >\n          <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n            <Link\n              href=\"/\"\n              className={`flex items-center gap-2 px-3 py-2 rounded-xl ${colors.card} border ${colors.border} hover:border-cyan-500/50 transition-all group focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n              aria-label=\"Return to OpenClaw-OS home\"\n            >\n              <Home className={`w-4 h-4 ${colors.textMuted} group-hover:text-cyan-400 transition-colors`} />\n              <span className={`text-sm font-medium ${colors.textSecondary} group-hover:text-cyan-400 transition-colors hidden sm:inline`}>OpenClaw-OS</span>\n            </Link>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-teal-500 flex items-center justify-center\">\n                <Music4 className=\"w-4 h-4 text-white\" />\n              </div>\n              <span className={`text-sm font-semibold ${colors.text}`}>Jamz</span>\n            </div>\n            <button\n              onClick={onEnterStudio}\n              className=\"flex items-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-cyan-500 to-teal-500 text-white text-sm font-medium hover:shadow-lg hover:shadow-cyan-500/25 transition-all focus:outline-none focus:ring-2 focus:ring-cyan-500\"\n            >\n              <Play className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">Open Studio</span>\n            </button>\n          </div>\n        </nav>\n\n        {/* Hero Section - add top padding for fixed header */}\n        <section\n          className=\"min-h-screen flex flex-col items-center justify-center px-4 sm:px-6 lg:px-8 pt-20 sm:pt-24 pb-12 sm:pb-20\"\n          aria-labelledby=\"hero-title\"\n        >\n          {/* Logo */}\n          <motion.div\n            variants={scaleInVariants}\n            initial=\"initial\"\n            animate=\"animate\"\n            transition={reducedMotion ? {} : { duration: 0.6, type: 'spring' }}\n            className=\"mb-6 sm:mb-8\"\n          >\n            <div className=\"relative\">\n              <div\n                className=\"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-2xl sm:rounded-3xl bg-gradient-to-br from-cyan-500 via-teal-500 to-emerald-500 flex items-center justify-center shadow-2xl shadow-cyan-500/30\"\n                role=\"img\"\n                aria-label=\"Jamz Studio logo\"\n              >\n                <Music4 className=\"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 text-white\" />\n              </div>\n              <div className=\"absolute inset-0 rounded-2xl sm:rounded-3xl bg-gradient-to-br from-cyan-500 to-teal-500 blur-2xl opacity-40 -z-10\" aria-hidden=\"true\" />\n            </div>\n          </motion.div>\n\n          {/* Title */}\n          <motion.div\n            variants={fadeInVariants}\n            initial=\"initial\"\n            animate=\"animate\"\n            transition={reducedMotion ? {} : { duration: 0.6, delay: 0.2 }}\n            className=\"text-center mb-4 sm:mb-6\"\n          >\n            <h1 id=\"hero-title\" className=\"text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-black tracking-tighter mb-2 sm:mb-4\">\n              <span className=\"bg-gradient-to-r from-cyan-400 via-teal-400 to-emerald-400 bg-clip-text text-transparent\">Jamz</span>\n            </h1>\n            <p className={`text-lg sm:text-xl md:text-2xl ${colors.textFaint} font-light`}>Music Studio</p>\n          </motion.div>\n\n          {/* Description */}\n          <motion.p\n            variants={fadeInVariants}\n            initial=\"initial\"\n            animate=\"animate\"\n            transition={reducedMotion ? {} : { duration: 0.6, delay: 0.3 }}\n            className={`text-base sm:text-lg md:text-xl ${colors.textMuted} max-w-2xl text-center mb-6 sm:mb-8 leading-relaxed px-4`}\n          >\n            A professional-grade digital audio workstation in your browser. Create, mix, and master your music with AI-powered tools.\n          </motion.p>\n\n          {/* CTA Button */}\n          <motion.div\n            variants={fadeInVariants}\n            initial=\"initial\"\n            animate=\"animate\"\n            transition={reducedMotion ? {} : { duration: 0.6, delay: 0.4 }}\n            className=\"mb-8 sm:mb-12\"\n          >\n            <button\n              onClick={onEnterStudio}\n              className=\"inline-flex items-center gap-2 px-6 sm:px-8 py-3 sm:py-4 rounded-full bg-gradient-to-r from-cyan-500 to-teal-500 text-white font-semibold hover:shadow-lg hover:shadow-cyan-500/25 transition-all hover:scale-105 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 focus:ring-offset-transparent min-h-[48px] touch-manipulation\"\n              aria-label=\"Enter Jamz Studio\"\n            >\n              <Sparkles className=\"w-4 h-4 sm:w-5 sm:h-5\" aria-hidden=\"true\" />\n              <span>Let&apos;s Jam</span>\n            </button>\n          </motion.div>\n\n          {/* Waveform Visualizer */}\n          <motion.div\n            variants={fadeInVariants}\n            initial=\"initial\"\n            animate=\"animate\"\n            transition={reducedMotion ? {} : { duration: 1, delay: 0.5 }}\n            className=\"w-full max-w-xs sm:max-w-md mb-12 sm:mb-16\"\n          >\n            <WaveformVisualizer reducedMotion={reducedMotion} />\n          </motion.div>\n\n          {/* DAW Preview */}\n          <DAWPreview colors={colors} reducedMotion={reducedMotion} />\n        </section>\n\n        {/* Features Section */}\n        <section\n          className=\"px-4 sm:px-6 lg:px-8 py-16 sm:py-24\"\n          aria-labelledby=\"features-title\"\n        >\n          <div className=\"max-w-6xl mx-auto\">\n            <motion.div\n              initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={reducedMotion ? {} : { duration: 0.6 }}\n              className=\"text-center mb-10 sm:mb-16\"\n            >\n              <h2 id=\"features-title\" className=\"text-2xl sm:text-3xl md:text-4xl font-bold mb-3 sm:mb-4\">\n                Everything You Need to{' '}\n                <span className=\"bg-gradient-to-r from-cyan-400 to-teal-400 bg-clip-text text-transparent\">Create</span>\n              </h2>\n              <p className={`${colors.textFaint} max-w-2xl mx-auto text-sm sm:text-base`}>\n                Professional music production tools, reimagined for the modern creator.\n              </p>\n            </motion.div>\n\n            {/* Available Now Section */}\n            <div className=\"mb-12 sm:mb-16\">\n              <motion.div\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 10 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                viewport={{ once: true }}\n                className=\"flex items-center gap-3 mb-6\"\n              >\n                <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-emerald-500/20 to-teal-500/20 border border-emerald-500/30\">\n                  <div className=\"w-2 h-2 rounded-full bg-emerald-400 animate-pulse\" />\n                  <span className=\"text-emerald-400 text-sm font-medium\">Available Now</span>\n                </div>\n                <div className={`h-px flex-1 ${colors.border}`} />\n              </motion.div>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6\" role=\"list\">\n                {availableFeatures.map((feature, index) => (\n                  <FeatureCard key={feature.title} feature={feature} index={index} colors={colors} reducedMotion={reducedMotion} />\n                ))}\n              </div>\n            </div>\n\n            {/* Coming Soon Section */}\n            <div>\n              <motion.div\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 10 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                viewport={{ once: true }}\n                className=\"flex items-center gap-3 mb-6\"\n              >\n                <div className=\"flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/30\">\n                  <Sparkles className=\"w-3.5 h-3.5 text-amber-400\" />\n                  <span className=\"text-amber-400 text-sm font-medium\">Coming Soon</span>\n                </div>\n                <div className={`h-px flex-1 ${colors.border}`} />\n              </motion.div>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6\" role=\"list\">\n                {comingSoonFeatures.map((feature, index) => (\n                  <FeatureCard key={feature.title} feature={feature} index={index + 3} colors={colors} reducedMotion={reducedMotion} isComingSoon />\n                ))}\n              </div>\n            </div>\n          </div>\n        </section>\n\n        {/* Instruments Section */}\n        <section\n          className=\"px-4 sm:px-6 lg:px-8 py-16 sm:py-24\"\n          aria-labelledby=\"instruments-title\"\n        >\n          <div className=\"max-w-4xl mx-auto\">\n            <motion.div\n              initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              className=\"text-center mb-8 sm:mb-12\"\n            >\n              <h2 id=\"instruments-title\" className=\"text-2xl sm:text-3xl font-bold mb-3 sm:mb-4\">Virtual Instruments</h2>\n              <p className={`${colors.textFaint} text-sm sm:text-base`}>Play any instrument, anywhere.</p>\n            </motion.div>\n            <div className=\"grid grid-cols-3 sm:flex sm:flex-wrap sm:justify-center gap-4 sm:gap-6\" role=\"list\">\n              {instruments.map((instrument, i) => (\n                <motion.div\n                  key={instrument.name}\n                  initial={reducedMotion ? { opacity: 1, scale: 1 } : { opacity: 0, scale: 0.8 }}\n                  whileInView={{ opacity: 1, scale: 1 }}\n                  viewport={{ once: true }}\n                  transition={reducedMotion ? {} : { delay: i * 0.1 }}\n                  whileHover={reducedMotion ? {} : { scale: 1.1, y: -5 }}\n                  className=\"flex flex-col items-center gap-2 sm:gap-3\"\n                  role=\"listitem\"\n                >\n                  <div\n                    className={`w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 rounded-xl sm:rounded-2xl bg-gradient-to-br ${instrument.color} flex items-center justify-center text-white shadow-lg`}\n                    aria-hidden=\"true\"\n                  >\n                    {instrument.icon}\n                  </div>\n                  <span className={`text-xs sm:text-sm ${colors.textFaint}`}>{instrument.name}</span>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </section>\n\n        {/* CTA Section */}\n        <section\n          className=\"px-4 sm:px-6 lg:px-8 py-16 sm:py-24\"\n          aria-labelledby=\"cta-title\"\n        >\n          <motion.div\n            initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: 20 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            className=\"max-w-2xl mx-auto text-center\"\n          >\n            <div className={`p-6 sm:p-8 rounded-2xl sm:rounded-3xl ${colors.card} border ${colors.border} backdrop-blur-xl`}>\n              <Headphones className=\"w-10 h-10 sm:w-12 sm:h-12 text-cyan-400 mx-auto mb-4 sm:mb-6\" aria-hidden=\"true\" />\n              <h2 id=\"cta-title\" className=\"text-xl sm:text-2xl font-bold mb-3 sm:mb-4\">Start Creating Today</h2>\n              <p className={`${colors.textFaint} mb-6 sm:mb-8 text-sm sm:text-base`}>\n                Record, mix, and export your tracks directly in your browser. More features coming soon.\n              </p>\n              <div className=\"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center\">\n                <button\n                  onClick={onEnterStudio}\n                  className=\"inline-flex items-center justify-center gap-2 px-5 sm:px-6 py-2.5 sm:py-3 rounded-full bg-gradient-to-r from-cyan-500 to-teal-500 text-white font-medium hover:shadow-lg hover:shadow-cyan-500/25 transition-shadow focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 min-h-[44px] touch-manipulation\"\n                >\n                  <Play className=\"w-4 h-4\" aria-hidden=\"true\" />\n                  Open Studio\n                </button>\n                <Link\n                  href=\"/\"\n                  className={`inline-flex items-center justify-center gap-2 px-5 sm:px-6 py-2.5 sm:py-3 rounded-full ${colors.card} ${colors.text} font-medium hover:opacity-80 transition-colors border ${colors.border} focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 min-h-[44px] touch-manipulation`}\n                >\n                  ‚Üê Back to OpenClaw-OS\n                </Link>\n              </div>\n            </div>\n          </motion.div>\n        </section>\n\n        {/* Footer */}\n        <footer className={`px-4 sm:px-6 lg:px-8 py-6 sm:py-8 border-t ${colors.border}`} role=\"contentinfo\">\n          <div className=\"max-w-6xl mx-auto text-center\">\n            <p className={`text-xs sm:text-sm ${colors.textFaint}`}>\n              Design inspired by{' '}\n              <a\n                href=\"https://x.com/joelbqz\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-cyan-400 hover:text-cyan-300 transition-colors underline underline-offset-2\"\n              >\n                @joelbqz\n              </a>\n            </p>\n          </div>\n        </footer>\n      </div>\n    </main>\n  );\n});\n\n// ============================================================================\n// Studio Components (Optimized for Performance, Mobile, Accessibility)\n// ============================================================================\n\nconst TransportControls = memo(function TransportControls({\n  isPlaying,\n  isRecording,\n  currentBeat,\n  bpm,\n  loop,\n  inputLevel,\n  colors,\n  onPlayPause,\n  onStop,\n  onRecord,\n  onBpmChange,\n  onLoopToggle,\n}: {\n  isPlaying: boolean;\n  isRecording: boolean;\n  currentBeat: number;\n  bpm: number;\n  loop: boolean;\n  inputLevel: number;\n  colors: ReturnType<typeof getThemeColors>;\n  onPlayPause: () => void;\n  onStop: () => void;\n  onRecord: () => void;\n  onBpmChange: (bpm: number) => void;\n  onLoopToggle: () => void;\n}) {\n  return (\n    <div\n      className={`flex items-center justify-center gap-2 sm:gap-4 py-2 sm:py-3 px-2 sm:px-4 border-b ${colors.border} ${colors.bgSecondary}`}\n      role=\"toolbar\"\n      aria-label=\"Transport controls\"\n    >\n      {/* Stop Button */}\n      <button\n        onClick={onStop}\n        className={`p-2 sm:p-2.5 rounded-lg ${colors.card} ${colors.textFaint} hover:${colors.text} hover:${colors.cardHover} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n        aria-label=\"Stop\"\n      >\n        <Square className=\"w-4 h-4\" />\n      </button>\n\n      {/* Play/Pause Button */}\n      <button\n        onClick={onPlayPause}\n        className={`p-2.5 sm:p-3 rounded-full ${isPlaying ? 'bg-cyan-500' : 'bg-gradient-to-r from-cyan-500 to-cyan-500'} text-white shadow-lg transition-all min-w-[44px] min-h-[44px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2`}\n        aria-label={isPlaying ? 'Pause' : 'Play'}\n        aria-pressed={isPlaying}\n      >\n        {isPlaying ? <Pause className=\"w-4 h-4 sm:w-5 sm:h-5\" /> : <Play className=\"w-4 h-4 sm:w-5 sm:h-5\" />}\n      </button>\n\n      {/* Record Button */}\n      <button\n        onClick={onRecord}\n        className={`p-2 sm:p-2.5 rounded-lg ${isRecording ? 'bg-red-500 text-white' : `${colors.card} ${colors.textFaint} hover:text-red-400`} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-red-500 ${isRecording ? 'animate-pulse' : ''}`}\n        aria-label={isRecording ? 'Stop recording' : 'Start recording'}\n        aria-pressed={isRecording}\n      >\n        <Circle className=\"w-4 h-4\" />\n      </button>\n\n      {/* Divider - hidden on mobile */}\n      <div className={`w-px h-6 ${colors.isDark ? 'bg-white/10' : 'bg-slate-200'} hidden sm:block`} aria-hidden=\"true\" />\n\n      {/* BPM Control - hidden on mobile */}\n      <div className=\"hidden sm:flex items-center gap-2\">\n        <label htmlFor=\"bpm-input\" className={`text-xs ${colors.textFaint}`}>BPM</label>\n        <input\n          id=\"bpm-input\"\n          type=\"number\"\n          value={bpm}\n          onChange={(e) => onBpmChange(Number(e.target.value))}\n          min={40}\n          max={300}\n          className={`w-14 px-2 py-1 rounded ${colors.card} ${colors.text} text-sm text-center border ${colors.border} focus:outline-none focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500`}\n          aria-label=\"Beats per minute\"\n        />\n      </div>\n\n      {/* Loop Toggle */}\n      <button\n        onClick={onLoopToggle}\n        className={`p-2 sm:p-2.5 rounded-lg ${loop ? 'bg-cyan-500/20 text-cyan-400' : `${colors.card} ${colors.textFaint}`} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n        aria-label={loop ? 'Disable loop' : 'Enable loop'}\n        aria-pressed={loop}\n      >\n        <Repeat className=\"w-4 h-4\" />\n      </button>\n\n      {/* Time Display */}\n      <div className={`text-xs sm:text-sm font-mono ${colors.textMuted} min-w-[50px] text-center`} aria-live=\"polite\" aria-label=\"Current position\">\n        {formatBars(currentBeat)}\n      </div>\n    </div>\n  );\n});\n\n// ============================================================================\n// Main Studio Page (Optimized for Performance, Mobile, Accessibility)\n// ============================================================================\n\nexport default function StudioPage() {\n  const { theme, resolvedTheme } = useTheme();\n  const { theme: designTheme } = useDesignThemeSafe();\n  const prefersReducedMotion = useReducedMotion();\n  const reducedMotion = prefersReducedMotion ?? false;\n  const colors = useMemo(() => getThemeColors(theme, resolvedTheme), [theme, resolvedTheme]);\n  const isMobile = useMediaQuery('(max-width: 640px)');\n\n  // Apply design theme class for CSS variable inheritance\n  const themeClass = `theme-${designTheme}`;\n\n  const [showStudio, setShowStudio] = useState(false);\n  const [project, setProject] = useState<JamzProject | null>(null);\n  const [currentView, setCurrentView] = useState<ViewMode>('arrange');\n  const [zoom, setZoom] = useState(1);\n  const [showQuickJam, setShowQuickJam] = useState(false);\n  const [showExport, setShowExport] = useState(false);\n  const [isExporting, setIsExporting] = useState(false);\n  const [mounted, setMounted] = useState(false);\n  const [showMobileMenu, setShowMobileMenu] = useState(false);\n  const [recordingTrackId, setRecordingTrackId] = useState<string | null>(null);\n\n  const engine = useAudioEngine(project);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const totalBeats = 64;\n\n  useEffect(() => {\n    setMounted(true);\n    // Always show landing page first per user request\n    // Load any saved project in background but don't auto-enter studio\n    try {\n      const saved = loadProject();\n      if (saved) {\n        setProject(saved);\n        // Don't auto-enter studio - always show landing page first\n      }\n    } catch (e) {\n      // Handle corrupted localStorage data gracefully\n      console.warn('Failed to load saved project:', e);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (project) saveProject(project);\n  }, [project]);\n\n  const addTrack = useCallback((name: string, type: 'audio' | 'midi' = 'audio') => {\n    setProject(prev => {\n      if (!prev) return prev;\n      const newTrack = createTrack(name, type, prev.tracks.length);\n      return { ...prev, tracks: [...prev.tracks, newTrack], updatedAt: Date.now() };\n    });\n  }, []);\n\n  const updateTrack = useCallback((trackId: string, updates: Partial<JamzTrack>) => {\n    setProject(prev => {\n      if (!prev) return prev;\n      return {\n        ...prev,\n        tracks: prev.tracks.map(t => t.id === trackId ? { ...t, ...updates } : t),\n        updatedAt: Date.now(),\n      };\n    });\n  }, []);\n\n  const handleEnterStudio = useCallback(() => {\n    if (!project) {\n      const newProject = createEmptyProject('Untitled');\n      setProject(newProject);\n    }\n    setShowStudio(true);\n    setShowQuickJam(true);\n  }, [project]);\n\n  const handleExportMix = useCallback(async (format: 'wav' | 'mp3') => {\n    if (!project) return;\n    setIsExporting(true);\n    try {\n      const blob = await engine.exportMix(format, 0, project.loopEnd);\n      if (blob) {\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `${project.name.replace(/[^a-z0-9]/gi, '_')}_mix.${format}`;\n        a.click();\n        URL.revokeObjectURL(url);\n      }\n    } catch (e) {\n      console.error('Export failed:', e);\n    }\n    setIsExporting(false);\n    setShowExport(false);\n  }, [project, engine]);\n\n  // Handle recording toggle\n  const handleRecord = useCallback(async () => {\n    if (!project) return;\n\n    if (engine.isRecording) {\n      // Stop recording\n      const result = await engine.stopRecording();\n      if (result && recordingTrackId) {\n        // Convert AudioBuffer to MP3 blob and create URL\n        const mp3Blob = await audioBufferToMp3(result.buffer);\n        const audioUrl = URL.createObjectURL(mp3Blob);\n\n        // Create a clip from the recording\n        const newClip = createClip(\n          `Recording ${new Date().toLocaleTimeString()}`,\n          0, // startBeat\n          Math.ceil(result.buffer.duration * project.bpm / 60), // lengthBeats\n          audioUrl\n        );\n        // Add clip to the track\n        setProject(prev => {\n          if (!prev) return prev;\n          return {\n            ...prev,\n            tracks: prev.tracks.map(t =>\n              t.id === recordingTrackId\n                ? { ...t, clips: [...t.clips, newClip] }\n                : t\n            ),\n            updatedAt: Date.now(),\n          };\n        });\n      }\n      setRecordingTrackId(null);\n    } else {\n      // Start recording - find the first armed track or create one\n      let targetTrackId = project.tracks.find(t => t.armed)?.id;\n\n      if (!targetTrackId) {\n        // If no track is armed, create a new track and arm it\n        const newTrack = createTrack('Recording', 'audio', project.tracks.length);\n        newTrack.armed = true;\n        setProject(prev => {\n          if (!prev) return prev;\n          return { ...prev, tracks: [...prev.tracks, newTrack], updatedAt: Date.now() };\n        });\n        targetTrackId = newTrack.id;\n      }\n\n      setRecordingTrackId(targetTrackId);\n      await engine.startRecording(targetTrackId);\n    }\n  }, [project, engine, recordingTrackId]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Skip if in input fields\n      if (['INPUT', 'TEXTAREA'].includes((e.target as HTMLElement).tagName)) return;\n\n      switch (e.code) {\n        case 'Space':\n          e.preventDefault();\n          if (engine.isPlaying) engine.pause();\n          else engine.play();\n          break;\n        case 'Escape':\n          setShowQuickJam(false);\n          setShowExport(false);\n          setShowMobileMenu(false);\n          break;\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [engine]);\n\n  // Loading state\n  if (!mounted) {\n    return (\n      <div className=\"h-dvh flex items-center justify-center bg-zinc-950\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-cyan-500 flex items-center justify-center mx-auto mb-4\">\n            <Music className=\"w-6 h-6 text-white\" />\n          </div>\n          <p className=\"text-white/60 text-sm\">Loading Jamz Studio...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show landing page\n  if (!showStudio) {\n    return (\n      <PageTransition>\n        <SkipToContent />\n        <LandingPage onEnterStudio={handleEnterStudio} colors={colors} reducedMotion={reducedMotion} themeClass={themeClass} />\n      </PageTransition>\n    );\n  }\n\n  // View options for navigation\n  const viewOptions = [\n    { id: 'arrange' as const, label: 'Arrange', icon: <Grid3X3 className=\"w-4 h-4\" /> },\n    { id: 'mixer' as const, label: 'Mixer', icon: <Sliders className=\"w-4 h-4\" /> },\n    { id: 'browser' as const, label: 'Generate', icon: <Sparkles className=\"w-4 h-4\" /> },\n  ];\n\n  // Show Studio\n  return (\n    <PageTransition>\n      <SkipToContent />\n      <div className={`h-dvh flex flex-col ${colors.bg} ${colors.text} overflow-hidden ${themeClass}`}>\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\"audio/*\"\n          className=\"sr-only\"\n          aria-label=\"Upload audio file\"\n        />\n\n        {/* Top Bar */}\n        <header\n          className={`flex items-center justify-between px-2 sm:px-4 py-2 ${colors.bgSecondary} border-b ${colors.border}`}\n          role=\"banner\"\n        >\n          {/* Left: Home & Project Info */}\n          <div className=\"flex items-center gap-2 sm:gap-3\">\n            <button\n              onClick={() => setShowStudio(false)}\n              className={`p-2 rounded-lg ${colors.textFaint} hover:${colors.text} hover:${colors.cardHover} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n              aria-label=\"Return to landing page\"\n            >\n              <Home className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n            </button>\n            <div className={`w-px h-6 ${colors.isDark ? 'bg-white/10' : 'bg-slate-200'} hidden sm:block`} aria-hidden=\"true\" />\n            <div className=\"flex items-center gap-2\">\n              <div\n                className=\"w-7 h-7 sm:w-8 sm:h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-cyan-500 flex items-center justify-center flex-shrink-0\"\n                aria-hidden=\"true\"\n              >\n                <Music className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 text-white\" />\n              </div>\n              <div className=\"min-w-0\">\n                <h1 className={`text-xs sm:text-sm font-semibold ${colors.text} truncate max-w-[100px] sm:max-w-none`}>\n                  {project?.name || 'Jamz Studio'}\n                </h1>\n                <p className={`text-[10px] ${colors.textFaint} hidden sm:block`}>\n                  {project ? `${project.tracks.length} tracks` : 'No project'}\n                </p>\n              </div>\n            </div>\n          </div>\n\n          {/* Center: View Tabs (desktop) */}\n          <nav\n            className={`hidden sm:flex items-center gap-1 p-1 ${colors.bgTertiary} rounded-lg`}\n            role=\"tablist\"\n            aria-label=\"View selection\"\n          >\n            {viewOptions.map((view) => (\n              <button\n                key={view.id}\n                onClick={() => setCurrentView(view.id)}\n                role=\"tab\"\n                aria-selected={currentView === view.id}\n                aria-controls={`${view.id}-panel`}\n                className={`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-colors min-h-[36px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 ${currentView === view.id ? 'bg-cyan-500 text-white' : `${colors.textFaint} hover:${colors.text} hover:${colors.cardHover}`\n                  }`}\n              >\n                {view.icon}\n                <span>{view.label}</span>\n              </button>\n            ))}\n          </nav>\n\n          {/* Right: Actions */}\n          <div className=\"flex items-center gap-1 sm:gap-2\">\n            {/* Zoom controls - hidden on mobile */}\n            <button\n              onClick={() => setZoom(z => Math.max(0.5, z - 0.25))}\n              className={`hidden sm:flex p-2 rounded-lg ${colors.textFaint} hover:${colors.text} hover:${colors.cardHover} transition-colors min-w-[36px] min-h-[36px] items-center justify-center focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n              aria-label=\"Zoom out\"\n            >\n              <ZoomOut className=\"w-4 h-4\" />\n            </button>\n            <button\n              onClick={() => setZoom(z => Math.min(2, z + 0.25))}\n              className={`hidden sm:flex p-2 rounded-lg ${colors.textFaint} hover:${colors.text} hover:${colors.cardHover} transition-colors min-w-[36px] min-h-[36px] items-center justify-center focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n              aria-label=\"Zoom in\"\n            >\n              <ZoomIn className=\"w-4 h-4\" />\n            </button>\n            <div className={`w-px h-6 ${colors.isDark ? 'bg-white/10' : 'bg-slate-200'} hidden sm:block`} aria-hidden=\"true\" />\n\n            {/* AI Generate Tab Toggle */}\n            <button\n              onClick={() => setCurrentView('browser')}\n              className={`hidden sm:flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium transition-colors min-h-[36px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-purple-500 ${currentView === 'browser' ? 'bg-purple-600 text-white' : `${colors.textFaint}`}`}\n              aria-label=\"AI Generate music\"\n            >\n              <Sparkles className=\"w-3.5 h-3.5\" />\n              <span>AI</span>\n            </button>\n\n            {/* AI Generate Button - switches to Generate tab */}\n            <button\n              onClick={() => setCurrentView('browser')}\n              className={`flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 py-1.5 rounded-lg bg-purple-600 text-white text-xs sm:text-sm font-medium hover:bg-purple-700 transition-colors min-h-[36px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2`}\n              aria-label=\"AI Generate music\"\n            >\n              <Sparkles className=\"w-3.5 h-3.5 sm:w-4 sm:h-4\" />\n              <span className=\"hidden sm:inline\">AI Generate</span>\n            </button>\n\n            {/* Export Button */}\n            <button\n              onClick={() => setShowExport(true)}\n              disabled={!project || project.tracks.length === 0}\n              className=\"flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 py-1.5 rounded-lg bg-cyan-500 text-white text-xs sm:text-sm font-medium hover:bg-cyan-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed min-h-[36px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2\"\n              aria-label=\"Export project\"\n            >\n              <Download className=\"w-3.5 h-3.5 sm:w-4 sm:h-4\" />\n              <span className=\"hidden sm:inline\">Export</span>\n            </button>\n\n            {/* Mobile Menu Button */}\n            <button\n              onClick={() => setShowMobileMenu(!showMobileMenu)}\n              className={`sm:hidden p-2 rounded-lg ${colors.textFaint} hover:${colors.text} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n              aria-label=\"Open menu\"\n              aria-expanded={showMobileMenu}\n            >\n              <Menu className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </header>\n\n        {/* Mobile Menu Dropdown */}\n        <AnimatePresence>\n          {showMobileMenu && isMobile && (\n            <motion.div\n              initial={reducedMotion ? { opacity: 1 } : { opacity: 0, y: -10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={reducedMotion ? { opacity: 0 } : { opacity: 0, y: -10 }}\n              className={`sm:hidden absolute top-14 left-0 right-0 z-40 ${colors.bgSecondary} border-b ${colors.border} shadow-lg`}\n            >\n              <nav className=\"p-2 space-y-1\" role=\"tablist\" aria-label=\"View selection\">\n                {viewOptions.map((view) => (\n                  <button\n                    key={view.id}\n                    onClick={() => { setCurrentView(view.id); setShowMobileMenu(false); }}\n                    role=\"tab\"\n                    aria-selected={currentView === view.id}\n                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors touch-manipulation ${currentView === view.id ? 'bg-cyan-500 text-white' : `${colors.text} ${colors.cardHover}`\n                      }`}\n                  >\n                    {view.icon}\n                    <span>{view.label}</span>\n                  </button>\n                ))}\n              </nav>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Transport */}\n        {project && (\n          <TransportControls\n            isPlaying={engine.isPlaying}\n            isRecording={engine.isRecording}\n            currentBeat={engine.currentBeat}\n            bpm={project.bpm}\n            loop={project.loopEnabled}\n            inputLevel={engine.inputLevel}\n            colors={colors}\n            onPlayPause={() => engine.isPlaying ? engine.pause() : engine.play()}\n            onStop={engine.stop}\n            onRecord={handleRecord}\n            onBpmChange={(bpm) => setProject(prev => prev ? { ...prev, bpm } : prev)}\n            onLoopToggle={() => setProject(prev => prev ? { ...prev, loopEnabled: !prev.loopEnabled } : prev)}\n          />\n        )}\n\n        {/* Main Content */}\n        <main\n          id=\"main-content\"\n          className=\"flex-1 flex overflow-hidden\"\n          role=\"main\"\n          aria-label=\"Studio workspace\"\n        >\n          <AnimatePresence mode=\"wait\">\n            {currentView === 'arrange' && project && (\n              <motion.div\n                key=\"arrange\"\n                id=\"arrange-panel\"\n                role=\"tabpanel\"\n                aria-labelledby=\"arrange-tab\"\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={reducedMotion ? { opacity: 0 } : { opacity: 0 }}\n                className=\"flex-1 flex flex-col overflow-hidden\"\n              >\n                {/* Timeline */}\n                <div className={`h-6 sm:h-8 flex-shrink-0 ${colors.bgSecondary} border-b ${colors.border} flex items-center px-2 sm:px-4`} role=\"presentation\" aria-hidden=\"true\">\n                  <div className=\"w-20 sm:w-32 flex-shrink-0\" />\n                  <div className=\"flex-1 flex items-center overflow-hidden\">\n                    {Array.from({ length: Math.ceil(totalBeats / 4) }).map((_, i) => (\n                      <div key={i} className={`flex-1 text-[8px] sm:text-[10px] ${colors.textFaint}`} style={{ minWidth: `${(isMobile ? 60 : 100) * zoom}px` }}>{i + 1}</div>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Tracks */}\n                <div className=\"flex-1 overflow-auto\" role=\"list\" aria-label=\"Audio tracks\">\n                  {project.tracks.map((track, trackIndex) => (\n                    <div\n                      key={track.id}\n                      className={`flex items-stretch border-b ${colors.border} h-16 sm:h-20`}\n                      role=\"listitem\"\n                      aria-label={`Track ${trackIndex + 1}: ${track.name}`}\n                    >\n                      {/* Track Controls */}\n                      <div className={`w-20 sm:w-32 flex-shrink-0 p-1.5 sm:p-2 ${colors.bgSecondary} border-r ${colors.border} flex flex-col justify-center`}>\n                        <div className={`text-xs sm:text-sm font-medium ${colors.text} truncate`}>{track.name}</div>\n                        <div className=\"flex items-center gap-0.5 sm:gap-1 mt-1\">\n                          <button\n                            onClick={() => updateTrack(track.id, { mute: !track.mute })}\n                            className={`px-1 sm:px-1.5 py-0.5 text-[8px] sm:text-[10px] rounded min-w-[20px] sm:min-w-[24px] touch-manipulation focus:outline-none focus:ring-1 focus:ring-cyan-500 ${track.mute ? 'bg-yellow-500 text-black' : `${colors.bgTertiary} ${colors.textFaint}`}`}\n                            aria-label={`${track.mute ? 'Unmute' : 'Mute'} ${track.name}`}\n                            aria-pressed={track.mute}\n                          >\n                            M\n                          </button>\n                          <button\n                            onClick={() => updateTrack(track.id, { solo: !track.solo })}\n                            className={`px-1 sm:px-1.5 py-0.5 text-[8px] sm:text-[10px] rounded min-w-[20px] sm:min-w-[24px] touch-manipulation focus:outline-none focus:ring-1 focus:ring-cyan-500 ${track.solo ? 'bg-cyan-500 text-black' : `${colors.bgTertiary} ${colors.textFaint}`}`}\n                            aria-label={`${track.solo ? 'Unsolo' : 'Solo'} ${track.name}`}\n                            aria-pressed={track.solo}\n                          >\n                            S\n                          </button>\n                          <button\n                            onClick={() => updateTrack(track.id, { armed: !track.armed })}\n                            className={`px-1 sm:px-1.5 py-0.5 text-[8px] sm:text-[10px] rounded min-w-[20px] sm:min-w-[24px] touch-manipulation focus:outline-none focus:ring-1 focus:ring-red-500 ${track.armed ? 'bg-red-500 text-white' : `${colors.bgTertiary} ${colors.textFaint}`}`}\n                            aria-label={`${track.armed ? 'Disarm' : 'Arm'} ${track.name} for recording`}\n                            aria-pressed={track.armed}\n                          >\n                            R\n                          </button>\n                        </div>\n                      </div>\n\n                      {/* Track Timeline */}\n                      <div className={`flex-1 ${colors.bg} relative`}>\n                        {track.clips.map((clip) => (\n                          <div\n                            key={clip.id}\n                            className=\"absolute top-0.5 sm:top-1 bottom-0.5 sm:bottom-1 rounded-md sm:rounded-lg overflow-hidden\"\n                            style={{\n                              left: `${(clip.startBeat / totalBeats) * 100}%`,\n                              width: `${(clip.lengthBeats / totalBeats) * 100}%`,\n                              backgroundColor: TRACK_COLOR_VALUES[track.color as keyof typeof TRACK_COLOR_VALUES] || '#8b5cf6',\n                            }}\n                            role=\"button\"\n                            tabIndex={0}\n                            aria-label={`Clip: ${clip.name}`}\n                          >\n                            <div className={`absolute inset-0 ${colors.isDark ? 'bg-black/20' : 'bg-white/20'}`} />\n                            <div className={`p-0.5 sm:p-1 text-[8px] sm:text-[10px] ${colors.isDark ? 'text-white/80' : 'text-white'} truncate`}>{clip.name}</div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ))}\n\n                  {/* Add Track Button */}\n                  <button\n                    onClick={() => addTrack(`Track ${(project?.tracks.length || 0) + 1}`)}\n                    className={`w-full p-3 sm:p-4 ${colors.card} border-b ${colors.border} flex items-center justify-center gap-2 ${colors.textFaint} hover:${colors.text} hover:${colors.cardHover} transition-colors min-h-[48px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-inset`}\n                    aria-label=\"Add new track\"\n                  >\n                    <Plus className=\"w-4 h-4\" />\n                    <span className=\"text-sm\">Add Track</span>\n                  </button>\n                </div>\n              </motion.div>\n            )}\n\n            {currentView === 'mixer' && project && (\n              <motion.div\n                key=\"mixer\"\n                id=\"mixer-panel\"\n                role=\"tabpanel\"\n                aria-labelledby=\"mixer-tab\"\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={reducedMotion ? { opacity: 0 } : { opacity: 0 }}\n                className=\"flex-1 flex items-end justify-start sm:justify-center gap-2 sm:gap-3 p-3 sm:p-6 overflow-x-auto\"\n              >\n                {project.tracks.map((track) => (\n                  <div\n                    key={track.id}\n                    className={`flex flex-col items-center p-2 sm:p-3 ${colors.card} rounded-lg sm:rounded-xl border ${colors.border} min-w-[60px] sm:min-w-[80px]`}\n                    role=\"group\"\n                    aria-label={`${track.name} mixer channel`}\n                  >\n                    <div className={`text-[10px] sm:text-xs font-medium ${colors.text} mb-2 sm:mb-3 truncate max-w-[50px] sm:max-w-[70px]`}>{track.name}</div>\n                    <div className=\"relative h-24 sm:h-32 w-5 sm:w-6 mb-2 sm:mb-3\" role=\"slider\" aria-label={`${track.name} volume`} aria-valuenow={Math.round(track.volume * 100)} aria-valuemin={0} aria-valuemax={100}>\n                      <div className={`absolute inset-0 ${colors.bgTertiary} rounded-full`} />\n                      <div className=\"absolute bottom-0 left-0.5 right-0.5 sm:left-1 sm:right-1 rounded-full bg-gradient-to-t from-cyan-500 to-cyan-500\" style={{ height: `${track.volume * 100}%` }} />\n                    </div>\n                    <div className={`text-[8px] sm:text-[10px] font-mono ${colors.textFaint} mb-1.5 sm:mb-2`}>{Math.round((track.volume - 1) * 100)} dB</div>\n                    <div className=\"flex gap-0.5 sm:gap-1\">\n                      <button\n                        onClick={() => updateTrack(track.id, { mute: !track.mute })}\n                        className={`w-5 h-5 sm:w-6 sm:h-6 rounded text-[8px] sm:text-[10px] font-bold touch-manipulation focus:outline-none focus:ring-1 focus:ring-cyan-500 ${track.mute ? 'bg-yellow-500 text-black' : `${colors.bgTertiary} ${colors.textFaint}`}`}\n                        aria-label={`${track.mute ? 'Unmute' : 'Mute'} ${track.name}`}\n                        aria-pressed={track.mute}\n                      >\n                        M\n                      </button>\n                      <button\n                        onClick={() => updateTrack(track.id, { solo: !track.solo })}\n                        className={`w-5 h-5 sm:w-6 sm:h-6 rounded text-[8px] sm:text-[10px] font-bold touch-manipulation focus:outline-none focus:ring-1 focus:ring-cyan-500 ${track.solo ? 'bg-cyan-500 text-black' : `${colors.bgTertiary} ${colors.textFaint}`}`}\n                        aria-label={`${track.solo ? 'Unsolo' : 'Solo'} ${track.name}`}\n                        aria-pressed={track.solo}\n                      >\n                        S\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </motion.div>\n            )}\n\n            {currentView === 'browser' && (\n              <motion.div\n                key=\"generate\"\n                id=\"browser-panel\"\n                role=\"tabpanel\"\n                aria-labelledby=\"generate-tab\"\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={reducedMotion ? { opacity: 0 } : { opacity: 0 }}\n                className=\"flex-1 flex overflow-hidden\"\n              >\n                <GenerateView\n                  colors={colors as Record<string, string | boolean>}\n                  projectId={project?.id}\n                  onAddToArrange={project ? (result) => {\n                    // Create a new track with the generated audio\n                    const colorIndex = project.tracks.length % TRACK_COLORS.length;\n                    const newTrack = createTrack(result.title, 'audio', colorIndex);\n                    const newClip = createClip(\n                      result.title,\n                      0, // Start at beat 0\n                      secondsToBeats(result.duration, project.bpm)\n                    );\n                    // Attach audio URL to the clip\n                    (newClip as JamzClip & { audioUrl?: string }).audioUrl = result.audioUrl;\n                    newTrack.clips = [newClip];\n                    setProject(prev => prev ? {\n                      ...prev,\n                      tracks: [...prev.tracks, newTrack],\n                    } : prev);\n                    // Switch to arrange view to see the new track\n                    setCurrentView('arrange');\n                  } : undefined}\n                />\n              </motion.div>\n            )}\n\n            {!project && currentView !== 'browser' && (\n              <motion.div\n                initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n                animate={{ opacity: 1 }}\n                className=\"flex-1 flex items-center justify-center p-4\"\n              >\n                <div className=\"text-center\">\n                  <div className={`w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-xl sm:rounded-2xl ${colors.card} flex items-center justify-center`} aria-hidden=\"true\">\n                    <Music className={`w-6 h-6 sm:w-8 sm:h-8 ${colors.textFaint}`} />\n                  </div>\n                  <p className={`${colors.textFaint} text-xs sm:text-sm mb-3 sm:mb-4`}>No project open</p>\n                  <button\n                    onClick={() => setShowQuickJam(true)}\n                    className=\"px-4 py-2.5 bg-cyan-500 text-white rounded-lg text-sm font-medium hover:bg-cyan-600 transition-colors min-h-[44px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2\"\n                  >\n                    Start a Quick Jam\n                  </button>\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </main>\n\n        {/* Bottom Status Bar */}\n        <footer className={`flex items-center justify-between px-2 sm:px-4 py-1.5 sm:py-2 ${colors.bgSecondary} border-t ${colors.border}`} role=\"contentinfo\">\n          <div className={`flex items-center gap-2 sm:gap-4 text-[8px] sm:text-[10px] ${colors.textFaint}`}>\n            <span className=\"hidden sm:inline\">Zoom: {Math.round(zoom * 100)}%</span>\n            {project && (\n              <>\n                <span className=\"hidden sm:inline\" aria-hidden=\"true\">|</span>\n                <span>{project.tracks.length} Tracks</span>\n                <span aria-hidden=\"true\">|</span>\n                <span>{totalBeats / 4} Bars</span>\n              </>\n            )}\n          </div>\n          <div className={`text-[8px] sm:text-[10px] ${colors.textFaint}`}>\n            Design by{' '}\n            <a\n              href=\"https://x.com/joelbqz\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-cyan-400 hover:text-cyan-300 underline underline-offset-2\"\n            >\n              @joelbqz\n            </a>\n          </div>\n        </footer>\n\n        {/* Quick Jam Dialog */}\n        <AnimatePresence>\n          {showQuickJam && (\n            <motion.div\n              initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={reducedMotion ? { opacity: 0 } : { opacity: 0 }}\n              className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4\"\n              role=\"dialog\"\n              aria-modal=\"true\"\n              aria-labelledby=\"quickjam-title\"\n            >\n              <motion.div\n                initial={reducedMotion ? { scale: 1, y: 0 } : { scale: 0.9, y: 20 }}\n                animate={{ scale: 1, y: 0 }}\n                exit={reducedMotion ? { scale: 1, y: 0 } : { scale: 0.9, y: 20 }}\n                className={`relative w-full max-w-sm sm:max-w-lg p-4 sm:p-6 ${colors.bgSecondary} rounded-xl sm:rounded-2xl border ${colors.border}`}\n              >\n                <button\n                  onClick={() => setShowQuickJam(false)}\n                  className={`absolute top-3 right-3 sm:top-4 sm:right-4 p-2 ${colors.textFaint} hover:${colors.text} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 rounded-lg`}\n                  aria-label=\"Close dialog\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n                <h2 id=\"quickjam-title\" className={`text-xl sm:text-2xl font-bold ${colors.text} mb-2`}>Quick Jam</h2>\n                <p className={`${colors.textMuted} mb-4 sm:mb-6 text-sm`}>How would you like to start?</p>\n                <div className=\"grid grid-cols-2 gap-2 sm:gap-4\">\n                  {[\n                    { id: 'record', icon: <Mic className=\"w-6 h-6 sm:w-8 sm:h-8\" />, title: 'Record', desc: 'Capture vocals', gradient: 'from-red-500 to-rose-600' },\n                    { id: 'upload', icon: <Upload className=\"w-6 h-6 sm:w-8 sm:h-8\" />, title: 'Upload', desc: 'Import audio', gradient: 'from-cyan-500 to-teal-600' },\n                    { id: 'template', icon: <Music className=\"w-6 h-6 sm:w-8 sm:h-8\" />, title: 'Template', desc: 'Start with loops', gradient: 'from-cyan-500 to-blue-600' },\n                    { id: 'ai-generate', icon: <Sparkles className=\"w-6 h-6 sm:w-8 sm:h-8\" />, title: 'AI Generate', desc: 'Create with AI', gradient: 'from-purple-500 to-violet-600' },\n                  ].map((opt) => (\n                    <button\n                      key={opt.id}\n                      onClick={() => {\n                        if (!project) {\n                          const newProject = createEmptyProject(opt.id === 'ai-generate' ? 'AI Session' : 'Untitled');\n                          setProject(newProject);\n                        }\n                        setShowQuickJam(false);\n                        if (opt.id === 'ai-generate') {\n                          setCurrentView('browser');\n                        }\n                      }}\n                      className={`flex flex-col items-center p-2 sm:p-4 rounded-lg sm:rounded-xl ${colors.card} border ${colors.border} hover:${colors.borderHover} transition-all hover:-translate-y-1 touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 min-h-[100px] sm:min-h-[140px]`}\n                      aria-label={`${opt.title}: ${opt.desc}`}\n                    >\n                      <div className={`w-10 h-10 sm:w-16 sm:h-16 rounded-lg sm:rounded-xl bg-gradient-to-br ${opt.gradient} flex items-center justify-center text-white mb-2 sm:mb-3`} aria-hidden=\"true\">\n                        {opt.icon}\n                      </div>\n                      <div className={`font-medium ${colors.text} text-xs sm:text-base`}>{opt.title}</div>\n                      <div className={`text-[10px] sm:text-xs ${colors.textFaint} hidden sm:block`}>{opt.desc}</div>\n                    </button>\n                  ))}\n                </div>\n              </motion.div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Export Dialog */}\n        <AnimatePresence>\n          {showExport && (\n            <motion.div\n              initial={reducedMotion ? { opacity: 1 } : { opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={reducedMotion ? { opacity: 0 } : { opacity: 0 }}\n              className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4\"\n              role=\"dialog\"\n              aria-modal=\"true\"\n              aria-labelledby=\"export-title\"\n            >\n              <motion.div\n                initial={reducedMotion ? { scale: 1, y: 0 } : { scale: 0.9, y: 20 }}\n                animate={{ scale: 1, y: 0 }}\n                exit={reducedMotion ? { scale: 1, y: 0 } : { scale: 0.9, y: 20 }}\n                className={`relative w-full max-w-sm sm:max-w-md p-4 sm:p-6 ${colors.bgSecondary} rounded-xl sm:rounded-2xl border ${colors.border}`}\n              >\n                <button\n                  onClick={() => setShowExport(false)}\n                  className={`absolute top-3 right-3 sm:top-4 sm:right-4 p-2 ${colors.textFaint} hover:${colors.text} transition-colors min-w-[40px] min-h-[40px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500 rounded-lg`}\n                  aria-label=\"Close dialog\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n                <h2 id=\"export-title\" className={`text-lg sm:text-xl font-bold ${colors.text} mb-3 sm:mb-4`}>Export Project</h2>\n                <div className=\"space-y-2 sm:space-y-3\">\n                  <button\n                    onClick={() => handleExportMix('wav')}\n                    disabled={isExporting}\n                    className={`w-full p-3 sm:p-4 rounded-lg sm:rounded-xl ${colors.card} border ${colors.border} hover:${colors.borderHover} transition-colors text-left disabled:opacity-50 disabled:cursor-not-allowed min-h-[60px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n                    aria-describedby=\"wav-desc\"\n                  >\n                    <div className={`font-medium ${colors.text} text-sm sm:text-base`}>WAV (Best Quality)</div>\n                    <div id=\"wav-desc\" className={`text-xs sm:text-sm ${colors.textFaint}`}>Lossless audio format</div>\n                  </button>\n                  <button\n                    onClick={() => handleExportMix('mp3')}\n                    disabled={isExporting}\n                    className={`w-full p-3 sm:p-4 rounded-lg sm:rounded-xl ${colors.card} border ${colors.border} hover:${colors.borderHover} transition-colors text-left disabled:opacity-50 disabled:cursor-not-allowed min-h-[60px] touch-manipulation focus:outline-none focus:ring-2 focus:ring-cyan-500`}\n                    aria-describedby=\"mp3-desc\"\n                  >\n                    <div className={`font-medium ${colors.text} text-sm sm:text-base`}>MP3 (Compressed)</div>\n                    <div id=\"mp3-desc\" className={`text-xs sm:text-sm ${colors.textFaint}`}>Smaller file size, 192kbps</div>\n                  </button>\n                </div>\n                {isExporting && (\n                  <div className={`mt-3 sm:mt-4 flex items-center justify-center gap-2 ${colors.textMuted}`} role=\"status\" aria-live=\"polite\">\n                    <Loader2 className=\"w-4 h-4 animate-spin\" aria-hidden=\"true\" />\n                    <span className=\"text-sm\">Exporting...</span>\n                  </div>\n                )}\n              </motion.div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n      </div>\n    </PageTransition>\n  );\n}\n","// Jamz Studio Types\n\nexport interface JamzProject {\n  id: string;\n  name: string;\n  bpm: number;\n  timeSignature: [number, number]; // [beats per bar, beat unit]\n  createdAt: number;\n  updatedAt: number;\n  tracks: JamzTrack[];\n  loopStart: number; // in beats\n  loopEnd: number; // in beats\n  loopEnabled: boolean;\n}\n\nexport interface JamzTrack {\n  id: string;\n  name: string;\n  type: 'audio' | 'midi';\n  color: string;\n  volume: number; // 0-1\n  pan: number; // -1 to 1\n  mute: boolean;\n  solo: boolean;\n  armed: boolean;\n  clips: JamzClip[];\n}\n\nexport interface JamzClip {\n  id: string;\n  name: string;\n  startBeat: number;\n  lengthBeats: number;\n  audioBuffer?: AudioBuffer;\n  audioUrl?: string;\n  waveformPeaks?: number[];\n  offset?: number; // offset within the audio file in seconds\n  gain?: number; // clip-level gain\n}\n\nexport interface AudioDeviceInfo {\n  deviceId: string;\n  label: string;\n  kind: 'audioinput' | 'audiooutput';\n}\n\nexport interface RecordingState {\n  isRecording: boolean;\n  targetTrackId: string | null;\n  startBeat: number;\n  mediaRecorder: MediaRecorder | null;\n  chunks: Blob[];\n}\n\nexport interface ExportOptions {\n  format: 'wav' | 'mp3';\n  quality?: number; // for mp3, 128-320\n  normalize?: boolean;\n  selectedRegionOnly?: boolean;\n  stems?: boolean;\n}\n\nexport interface QuickJamOption {\n  id: string;\n  title: string;\n  description: string;\n  icon: string;\n  action: 'record' | 'upload' | 'template';\n}\n\nexport const TRACK_COLORS = [\n  'bg-violet-500',\n  'bg-cyan-500',\n  'bg-pink-500',\n  'bg-amber-500',\n  'bg-emerald-500',\n  'bg-rose-500',\n  'bg-blue-500',\n  'bg-orange-500',\n  'bg-indigo-500',\n  'bg-teal-500',\n] as const;\n\nexport const TRACK_COLOR_VALUES: Record<string, string> = {\n  'bg-violet-500': '#8b5cf6',\n  'bg-cyan-500': '#06b6d4',\n  'bg-pink-500': '#ec4899',\n  'bg-amber-500': '#f59e0b',\n  'bg-emerald-500': '#10b981',\n  'bg-rose-500': '#f43f5e',\n  'bg-blue-500': '#3b82f6',\n  'bg-orange-500': '#f97316',\n  'bg-indigo-500': '#6366f1',\n  'bg-teal-500': '#14b8a6',\n};\n\nexport function generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;\n}\n\nexport function createEmptyProject(name: string = 'Untitled Project'): JamzProject {\n  return {\n    id: generateId(),\n    name,\n    bpm: 120,\n    timeSignature: [4, 4],\n    createdAt: Date.now(),\n    updatedAt: Date.now(),\n    tracks: [],\n    loopStart: 0,\n    loopEnd: 16,\n    loopEnabled: true,\n  };\n}\n\nexport function createTrack(\n  name: string,\n  type: 'audio' | 'midi' = 'audio',\n  colorIndex?: number\n): JamzTrack {\n  const color = TRACK_COLORS[colorIndex ?? Math.floor(Math.random() * TRACK_COLORS.length)];\n  return {\n    id: generateId(),\n    name,\n    type,\n    color,\n    volume: 0.8,\n    pan: 0,\n    mute: false,\n    solo: false,\n    armed: false,\n    clips: [],\n  };\n}\n\nexport function createClip(\n  name: string,\n  startBeat: number,\n  lengthBeats: number,\n  audioUrl?: string\n): JamzClip {\n  return {\n    id: generateId(),\n    name,\n    startBeat,\n    lengthBeats,\n    audioUrl,\n    gain: 1,\n  };\n}\n\n// Beat/time conversion utilities\nexport function beatsToSeconds(beats: number, bpm: number): number {\n  return (beats / bpm) * 60;\n}\n\nexport function secondsToBeats(seconds: number, bpm: number): number {\n  return (seconds / 60) * bpm;\n}\n\nexport function formatTime(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n}\n\nexport function formatBars(beats: number, beatsPerBar: number = 4): string {\n  const bars = Math.floor(beats / beatsPerBar) + 1;\n  const beat = Math.floor(beats % beatsPerBar) + 1;\n  return `${bars}.${beat}`;\n}\n","'use client';\n\nimport { useCallback, useRef, useState, useEffect } from 'react';\nimport {\n  JamzProject,\n  JamzTrack,\n  JamzClip,\n  beatsToSeconds,\n  secondsToBeats,\n} from './types';\n\ninterface AudioEngineState {\n  isPlaying: boolean;\n  isRecording: boolean;\n  currentBeat: number;\n  masterLevel: number;\n  inputLevel: number;\n}\n\ninterface ScheduledSource {\n  source: AudioBufferSourceNode;\n  clipId: string;\n  trackId: string;\n}\n\nexport function useAudioEngine(project: JamzProject | null) {\n  const [state, setState] = useState<AudioEngineState>({\n    isPlaying: false,\n    isRecording: false,\n    currentBeat: 0,\n    masterLevel: 0,\n    inputLevel: 0,\n  });\n\n  // Audio context and nodes\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const masterGainRef = useRef<GainNode | null>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n  const trackGainsRef = useRef<Map<string, GainNode>>(new Map());\n  const trackPansRef = useRef<Map<string, StereoPannerNode>>(new Map());\n\n  // Playback state\n  const scheduledSourcesRef = useRef<ScheduledSource[]>([]);\n  const startTimeRef = useRef<number>(0);\n  const startBeatRef = useRef<number>(0);\n  const animationFrameRef = useRef<number | null>(null);\n\n  // Recording state\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const recordedChunksRef = useRef<Blob[]>([]);\n  const inputStreamRef = useRef<MediaStream | null>(null);\n  const inputAnalyserRef = useRef<AnalyserNode | null>(null);\n\n  // Audio buffers cache\n  const audioBuffersRef = useRef<Map<string, AudioBuffer>>(new Map());\n\n  // Initialize audio context\n  const initAudioContext = useCallback(() => {\n    if (audioContextRef.current) return audioContextRef.current;\n\n    const ctx = new AudioContext();\n    audioContextRef.current = ctx;\n\n    // Create master gain\n    const masterGain = ctx.createGain();\n    masterGain.gain.value = 0.8;\n    masterGain.connect(ctx.destination);\n    masterGainRef.current = masterGain;\n\n    // Create analyser for metering\n    const analyser = ctx.createAnalyser();\n    analyser.fftSize = 256;\n    masterGain.connect(analyser);\n    analyserRef.current = analyser;\n\n    return ctx;\n  }, []);\n\n  // Resume audio context (needed for user interaction)\n  const resumeAudioContext = useCallback(async () => {\n    const ctx = initAudioContext();\n    if (ctx.state === 'suspended') {\n      await ctx.resume();\n    }\n    return ctx;\n  }, [initAudioContext]);\n\n  // Load audio from URL\n  const loadAudio = useCallback(async (url: string): Promise<AudioBuffer> => {\n    // Check cache first\n    const cached = audioBuffersRef.current.get(url);\n    if (cached) return cached;\n\n    const ctx = await resumeAudioContext();\n    const response = await fetch(url);\n    const arrayBuffer = await response.arrayBuffer();\n    const audioBuffer = await ctx.decodeAudioData(arrayBuffer);\n\n    audioBuffersRef.current.set(url, audioBuffer);\n    return audioBuffer;\n  }, [resumeAudioContext]);\n\n  // Load audio from File\n  const loadAudioFromFile = useCallback(async (file: File): Promise<AudioBuffer> => {\n    const ctx = await resumeAudioContext();\n    const arrayBuffer = await file.arrayBuffer();\n    const audioBuffer = await ctx.decodeAudioData(arrayBuffer);\n    return audioBuffer;\n  }, [resumeAudioContext]);\n\n  // Generate waveform peaks from AudioBuffer\n  const generateWaveformPeaks = useCallback((buffer: AudioBuffer, numPeaks: number = 200): number[] => {\n    const channelData = buffer.getChannelData(0);\n    const samplesPerPeak = Math.floor(channelData.length / numPeaks);\n    const peaks: number[] = [];\n\n    for (let i = 0; i < numPeaks; i++) {\n      let max = 0;\n      const start = i * samplesPerPeak;\n      const end = Math.min(start + samplesPerPeak, channelData.length);\n\n      for (let j = start; j < end; j++) {\n        const abs = Math.abs(channelData[j]);\n        if (abs > max) max = abs;\n      }\n      peaks.push(max);\n    }\n\n    return peaks;\n  }, []);\n\n  // Get or create track nodes\n  const getTrackNodes = useCallback((track: JamzTrack) => {\n    const ctx = audioContextRef.current;\n    if (!ctx || !masterGainRef.current) return null;\n\n    let gainNode = trackGainsRef.current.get(track.id);\n    let panNode = trackPansRef.current.get(track.id);\n\n    if (!gainNode) {\n      gainNode = ctx.createGain();\n      panNode = ctx.createStereoPanner();\n\n      gainNode.connect(panNode);\n      panNode.connect(masterGainRef.current);\n\n      trackGainsRef.current.set(track.id, gainNode);\n      trackPansRef.current.set(track.id, panNode);\n    }\n\n    // Update values\n    gainNode.gain.value = track.mute ? 0 : track.volume;\n    if (panNode) panNode.pan.value = track.pan;\n\n    return { gainNode, panNode };\n  }, []);\n\n  // Schedule clip playback\n  const scheduleClip = useCallback(async (\n    clip: JamzClip,\n    track: JamzTrack,\n    startTime: number,\n    offsetBeat: number,\n    bpm: number\n  ) => {\n    const ctx = audioContextRef.current;\n    if (!ctx) return;\n\n    const nodes = getTrackNodes(track);\n    if (!nodes) return;\n\n    let buffer: AudioBuffer | undefined;\n\n    if (clip.audioBuffer) {\n      buffer = clip.audioBuffer;\n    } else if (clip.audioUrl) {\n      try {\n        buffer = await loadAudio(clip.audioUrl);\n      } catch (e) {\n        console.error('Failed to load audio:', e);\n        return;\n      }\n    }\n\n    if (!buffer) return;\n\n    const clipStartSeconds = beatsToSeconds(clip.startBeat - offsetBeat, bpm);\n    const clipOffsetSeconds = clip.offset ?? 0;\n\n    // Only schedule if clip is in the future or currently playing\n    if (clipStartSeconds + buffer.duration < 0) return;\n\n    const source = ctx.createBufferSource();\n    source.buffer = buffer;\n\n    // Apply clip gain\n    const clipGain = ctx.createGain();\n    clipGain.gain.value = clip.gain ?? 1;\n    source.connect(clipGain);\n    clipGain.connect(nodes.gainNode);\n\n    const when = Math.max(0, startTime + clipStartSeconds);\n    const offset = clipStartSeconds < 0 ? -clipStartSeconds + clipOffsetSeconds : clipOffsetSeconds;\n\n    source.start(when, offset);\n\n    scheduledSourcesRef.current.push({\n      source,\n      clipId: clip.id,\n      trackId: track.id,\n    });\n\n    source.onended = () => {\n      scheduledSourcesRef.current = scheduledSourcesRef.current.filter(\n        s => s.source !== source\n      );\n    };\n  }, [getTrackNodes, loadAudio]);\n\n  // Stop all scheduled sources\n  const stopAllSources = useCallback(() => {\n    scheduledSourcesRef.current.forEach(({ source }) => {\n      try {\n        source.stop();\n      } catch (e) {\n        // Already stopped\n      }\n    });\n    scheduledSourcesRef.current = [];\n  }, []);\n\n  // Update playback position\n  const updatePlaybackPosition = useCallback(() => {\n    if (!audioContextRef.current || !state.isPlaying || !project) return;\n\n    const ctx = audioContextRef.current;\n    const elapsed = ctx.currentTime - startTimeRef.current;\n    const currentBeat = startBeatRef.current + secondsToBeats(elapsed, project.bpm);\n\n    // Handle loop\n    if (project.loopEnabled && currentBeat >= project.loopEnd) {\n      // Restart from loop start\n      startBeatRef.current = project.loopStart;\n      startTimeRef.current = ctx.currentTime;\n\n      // Reschedule all clips\n      stopAllSources();\n      project.tracks.forEach(track => {\n        if (!track.mute) {\n          track.clips.forEach(clip => {\n            scheduleClip(clip, track, ctx.currentTime, project.loopStart, project.bpm);\n          });\n        }\n      });\n\n      setState(s => ({ ...s, currentBeat: project.loopStart }));\n    } else {\n      setState(s => ({ ...s, currentBeat }));\n    }\n\n    // Update master level meter\n    if (analyserRef.current) {\n      const dataArray = new Uint8Array(analyserRef.current.frequencyBinCount);\n      analyserRef.current.getByteFrequencyData(dataArray);\n      const average = dataArray.reduce((a, b) => a + b, 0) / dataArray.length;\n      setState(s => ({ ...s, masterLevel: average / 255 }));\n    }\n\n    animationFrameRef.current = requestAnimationFrame(updatePlaybackPosition);\n  }, [project, state.isPlaying, stopAllSources, scheduleClip]);\n\n  // Play\n  const play = useCallback(async (fromBeat?: number) => {\n    if (!project) return;\n\n    const ctx = await resumeAudioContext();\n\n    stopAllSources();\n\n    const startBeat = fromBeat ?? state.currentBeat;\n    startBeatRef.current = startBeat;\n    startTimeRef.current = ctx.currentTime;\n\n    // Schedule all clips\n    project.tracks.forEach(track => {\n      // Check solo state\n      const hasSolo = project.tracks.some(t => t.solo);\n      if (hasSolo && !track.solo) return;\n      if (track.mute) return;\n\n      track.clips.forEach(clip => {\n        scheduleClip(clip, track, ctx.currentTime, startBeat, project.bpm);\n      });\n    });\n\n    setState(s => ({ ...s, isPlaying: true, currentBeat: startBeat }));\n    animationFrameRef.current = requestAnimationFrame(updatePlaybackPosition);\n  }, [project, state.currentBeat, resumeAudioContext, stopAllSources, scheduleClip, updatePlaybackPosition]);\n\n  // Pause\n  const pause = useCallback(() => {\n    stopAllSources();\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    setState(s => ({ ...s, isPlaying: false }));\n  }, [stopAllSources]);\n\n  // Stop\n  const stop = useCallback(() => {\n    pause();\n    setState(s => ({ ...s, currentBeat: project?.loopEnabled ? project.loopStart : 0 }));\n  }, [pause, project]);\n\n  // Seek\n  const seek = useCallback((beat: number) => {\n    if (state.isPlaying) {\n      play(beat);\n    } else {\n      setState(s => ({ ...s, currentBeat: beat }));\n    }\n  }, [state.isPlaying, play]);\n\n  // Recording\n  const startRecording = useCallback(async (targetTrackId: string) => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      inputStreamRef.current = stream;\n\n      const ctx = await resumeAudioContext();\n\n      // Create input analyser for level metering\n      const inputSource = ctx.createMediaStreamSource(stream);\n      const inputAnalyser = ctx.createAnalyser();\n      inputAnalyser.fftSize = 256;\n      inputSource.connect(inputAnalyser);\n      inputAnalyserRef.current = inputAnalyser;\n\n      // Create media recorder\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: 'audio/webm;codecs=opus',\n      });\n\n      recordedChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (e) => {\n        if (e.data.size > 0) {\n          recordedChunksRef.current.push(e.data);\n        }\n      };\n\n      mediaRecorderRef.current = mediaRecorder;\n      mediaRecorder.start(100); // Collect data every 100ms\n\n      setState(s => ({ ...s, isRecording: true }));\n\n      // Start playback if not already playing\n      if (!state.isPlaying) {\n        play();\n      }\n    } catch (e) {\n      console.error('Failed to start recording:', e);\n      throw e;\n    }\n  }, [resumeAudioContext, state.isPlaying, play]);\n\n  const stopRecording = useCallback(async (): Promise<{ blob: Blob; buffer: AudioBuffer } | null> => {\n    return new Promise((resolve) => {\n      const mediaRecorder = mediaRecorderRef.current;\n      if (!mediaRecorder) {\n        resolve(null);\n        return;\n      }\n\n      mediaRecorder.onstop = async () => {\n        const blob = new Blob(recordedChunksRef.current, { type: 'audio/webm' });\n\n        // Convert to AudioBuffer\n        const ctx = audioContextRef.current;\n        if (ctx) {\n          try {\n            const arrayBuffer = await blob.arrayBuffer();\n            const audioBuffer = await ctx.decodeAudioData(arrayBuffer);\n            resolve({ blob, buffer: audioBuffer });\n          } catch (e) {\n            console.error('Failed to decode recording:', e);\n            resolve(null);\n          }\n        } else {\n          resolve(null);\n        }\n\n        // Cleanup\n        if (inputStreamRef.current) {\n          inputStreamRef.current.getTracks().forEach(track => track.stop());\n          inputStreamRef.current = null;\n        }\n        inputAnalyserRef.current = null;\n        mediaRecorderRef.current = null;\n        recordedChunksRef.current = [];\n      };\n\n      mediaRecorder.stop();\n      setState(s => ({ ...s, isRecording: false }));\n    });\n  }, []);\n\n  // Update input level meter\n  useEffect(() => {\n    if (!state.isRecording || !inputAnalyserRef.current) return;\n\n    const updateInputLevel = () => {\n      if (inputAnalyserRef.current) {\n        const dataArray = new Uint8Array(inputAnalyserRef.current.frequencyBinCount);\n        inputAnalyserRef.current.getByteFrequencyData(dataArray);\n        const average = dataArray.reduce((a, b) => a + b, 0) / dataArray.length;\n        setState(s => ({ ...s, inputLevel: average / 255 }));\n      }\n      if (state.isRecording) {\n        requestAnimationFrame(updateInputLevel);\n      }\n    };\n\n    updateInputLevel();\n  }, [state.isRecording]);\n\n  // Export mix\n  const exportMix = useCallback(async (\n    format: 'wav' | 'mp3' = 'wav',\n    startBeat?: number,\n    endBeat?: number\n  ): Promise<Blob | null> => {\n    if (!project) return null;\n\n    const start = startBeat ?? 0;\n    const end = endBeat ?? project.loopEnd;\n    const durationSeconds = beatsToSeconds(end - start, project.bpm);\n\n    // Create offline context\n    const offlineCtx = new OfflineAudioContext(2, Math.ceil(durationSeconds * 44100), 44100);\n    const masterGain = offlineCtx.createGain();\n    masterGain.gain.value = 0.8;\n    masterGain.connect(offlineCtx.destination);\n\n    // Render all tracks\n    for (const track of project.tracks) {\n      const hasSolo = project.tracks.some(t => t.solo);\n      if (hasSolo && !track.solo) continue;\n      if (track.mute) continue;\n\n      const trackGain = offlineCtx.createGain();\n      trackGain.gain.value = track.volume;\n      const trackPan = offlineCtx.createStereoPanner();\n      trackPan.pan.value = track.pan;\n\n      trackGain.connect(trackPan);\n      trackPan.connect(masterGain);\n\n      for (const clip of track.clips) {\n        let buffer: AudioBuffer | undefined;\n\n        if (clip.audioBuffer) {\n          buffer = clip.audioBuffer;\n        } else if (clip.audioUrl) {\n          buffer = audioBuffersRef.current.get(clip.audioUrl);\n        }\n\n        if (!buffer) continue;\n\n        const clipStartSeconds = beatsToSeconds(clip.startBeat - start, project.bpm);\n        if (clipStartSeconds >= durationSeconds) continue;\n        if (clipStartSeconds + buffer.duration <= 0) continue;\n\n        const source = offlineCtx.createBufferSource();\n        source.buffer = buffer;\n\n        const clipGain = offlineCtx.createGain();\n        clipGain.gain.value = clip.gain ?? 1;\n        source.connect(clipGain);\n        clipGain.connect(trackGain);\n\n        const when = Math.max(0, clipStartSeconds);\n        const offset = clipStartSeconds < 0 ? -clipStartSeconds : 0;\n        source.start(when, offset);\n      }\n    }\n\n    const renderedBuffer = await offlineCtx.startRendering();\n\n    // Convert to WAV\n    if (format === 'wav') {\n      return audioBufferToWav(renderedBuffer);\n    } else {\n      // For MP3, we'd need a library like lamejs\n      // For now, return WAV\n      return audioBufferToWav(renderedBuffer);\n    }\n  }, [project]);\n\n  // Export stems\n  const exportStems = useCallback(async (\n    startBeat?: number,\n    endBeat?: number\n  ): Promise<Map<string, Blob> | null> => {\n    if (!project) return null;\n\n    const stems = new Map<string, Blob>();\n    const start = startBeat ?? 0;\n    const end = endBeat ?? project.loopEnd;\n    const durationSeconds = beatsToSeconds(end - start, project.bpm);\n\n    for (const track of project.tracks) {\n      if (track.clips.length === 0) continue;\n\n      const offlineCtx = new OfflineAudioContext(2, Math.ceil(durationSeconds * 44100), 44100);\n      const trackGain = offlineCtx.createGain();\n      trackGain.gain.value = track.volume;\n      const trackPan = offlineCtx.createStereoPanner();\n      trackPan.pan.value = track.pan;\n\n      trackGain.connect(trackPan);\n      trackPan.connect(offlineCtx.destination);\n\n      for (const clip of track.clips) {\n        let buffer: AudioBuffer | undefined;\n\n        if (clip.audioBuffer) {\n          buffer = clip.audioBuffer;\n        } else if (clip.audioUrl) {\n          buffer = audioBuffersRef.current.get(clip.audioUrl);\n        }\n\n        if (!buffer) continue;\n\n        const clipStartSeconds = beatsToSeconds(clip.startBeat - start, project.bpm);\n        if (clipStartSeconds >= durationSeconds) continue;\n\n        const source = offlineCtx.createBufferSource();\n        source.buffer = buffer;\n\n        const clipGain = offlineCtx.createGain();\n        clipGain.gain.value = clip.gain ?? 1;\n        source.connect(clipGain);\n        clipGain.connect(trackGain);\n\n        const when = Math.max(0, clipStartSeconds);\n        const offset = clipStartSeconds < 0 ? -clipStartSeconds : 0;\n        source.start(when, offset);\n      }\n\n      const renderedBuffer = await offlineCtx.startRendering();\n      const blob = audioBufferToWav(renderedBuffer);\n      stems.set(track.name, blob);\n    }\n\n    return stems;\n  }, [project]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      stopAllSources();\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      if (inputStreamRef.current) {\n        inputStreamRef.current.getTracks().forEach(track => track.stop());\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n    };\n  }, [stopAllSources]);\n\n  return {\n    ...state,\n    play,\n    pause,\n    stop,\n    seek,\n    startRecording,\n    stopRecording,\n    loadAudio,\n    loadAudioFromFile,\n    generateWaveformPeaks,\n    exportMix,\n    exportStems,\n    resumeAudioContext,\n  };\n}\n\n// Convert AudioBuffer to WAV Blob\nfunction audioBufferToWav(buffer: AudioBuffer): Blob {\n  const numChannels = buffer.numberOfChannels;\n  const sampleRate = buffer.sampleRate;\n  const format = 1; // PCM\n  const bitDepth = 16;\n\n  const bytesPerSample = bitDepth / 8;\n  const blockAlign = numChannels * bytesPerSample;\n  const byteRate = sampleRate * blockAlign;\n  const dataSize = buffer.length * blockAlign;\n  const headerSize = 44;\n  const totalSize = headerSize + dataSize;\n\n  const arrayBuffer = new ArrayBuffer(totalSize);\n  const view = new DataView(arrayBuffer);\n\n  // RIFF header\n  writeString(view, 0, 'RIFF');\n  view.setUint32(4, totalSize - 8, true);\n  writeString(view, 8, 'WAVE');\n\n  // fmt chunk\n  writeString(view, 12, 'fmt ');\n  view.setUint32(16, 16, true); // chunk size\n  view.setUint16(20, format, true);\n  view.setUint16(22, numChannels, true);\n  view.setUint32(24, sampleRate, true);\n  view.setUint32(28, byteRate, true);\n  view.setUint16(32, blockAlign, true);\n  view.setUint16(34, bitDepth, true);\n\n  // data chunk\n  writeString(view, 36, 'data');\n  view.setUint32(40, dataSize, true);\n\n  // Write audio data\n  const channels: Float32Array[] = [];\n  for (let i = 0; i < numChannels; i++) {\n    channels.push(buffer.getChannelData(i));\n  }\n\n  let offset = 44;\n  for (let i = 0; i < buffer.length; i++) {\n    for (let ch = 0; ch < numChannels; ch++) {\n      const sample = Math.max(-1, Math.min(1, channels[ch][i]));\n      const intSample = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;\n      view.setInt16(offset, intSample, true);\n      offset += 2;\n    }\n  }\n\n  return new Blob([arrayBuffer], { type: 'audio/wav' });\n}\n\nfunction writeString(view: DataView, offset: number, str: string) {\n  for (let i = 0; i < str.length; i++) {\n    view.setUint8(offset + i, str.charCodeAt(i));\n  }\n}\n","'use client';\n\nimport { JamzProject, JamzTrack, JamzClip } from './types';\n\nconst STORAGE_KEY = 'jamz_project';\nconst PROJECTS_LIST_KEY = 'jamz_projects_list';\n\ninterface StoredProject {\n  id: string;\n  name: string;\n  bpm: number;\n  timeSignature: [number, number];\n  createdAt: number;\n  updatedAt: number;\n  loopStart: number;\n  loopEnd: number;\n  loopEnabled: boolean;\n  tracks: StoredTrack[];\n}\n\ninterface StoredTrack {\n  id: string;\n  name: string;\n  type: 'audio' | 'midi';\n  color: string;\n  volume: number;\n  pan: number;\n  mute: boolean;\n  solo: boolean;\n  armed: boolean;\n  clips: StoredClip[];\n}\n\ninterface StoredClip {\n  id: string;\n  name: string;\n  startBeat: number;\n  lengthBeats: number;\n  audioUrl?: string;\n  waveformPeaks?: number[];\n  offset?: number;\n  gain?: number;\n}\n\n// Convert project to storable format (without AudioBuffers)\nfunction projectToStorable(project: JamzProject): StoredProject {\n  return {\n    id: project.id,\n    name: project.name,\n    bpm: project.bpm,\n    timeSignature: project.timeSignature,\n    createdAt: project.createdAt,\n    updatedAt: Date.now(),\n    loopStart: project.loopStart,\n    loopEnd: project.loopEnd,\n    loopEnabled: project.loopEnabled,\n    tracks: project.tracks.map(track => ({\n      id: track.id,\n      name: track.name,\n      type: track.type,\n      color: track.color,\n      volume: track.volume,\n      pan: track.pan,\n      mute: track.mute,\n      solo: track.solo,\n      armed: track.armed,\n      clips: track.clips.map(clip => ({\n        id: clip.id,\n        name: clip.name,\n        startBeat: clip.startBeat,\n        lengthBeats: clip.lengthBeats,\n        audioUrl: clip.audioUrl,\n        waveformPeaks: clip.waveformPeaks,\n        offset: clip.offset,\n        gain: clip.gain,\n      })),\n    })),\n  };\n}\n\n// Convert stored format back to project\nfunction storableToProject(stored: StoredProject): JamzProject {\n  return {\n    id: stored.id,\n    name: stored.name,\n    bpm: stored.bpm,\n    timeSignature: stored.timeSignature,\n    createdAt: stored.createdAt,\n    updatedAt: stored.updatedAt,\n    loopStart: stored.loopStart,\n    loopEnd: stored.loopEnd,\n    loopEnabled: stored.loopEnabled,\n    tracks: stored.tracks.map(track => ({\n      id: track.id,\n      name: track.name,\n      type: track.type,\n      color: track.color,\n      volume: track.volume,\n      pan: track.pan,\n      mute: track.mute,\n      solo: track.solo,\n      armed: track.armed,\n      clips: track.clips.map(clip => ({\n        id: clip.id,\n        name: clip.name,\n        startBeat: clip.startBeat,\n        lengthBeats: clip.lengthBeats,\n        audioUrl: clip.audioUrl,\n        waveformPeaks: clip.waveformPeaks,\n        offset: clip.offset,\n        gain: clip.gain,\n      })),\n    })),\n  };\n}\n\n// Save current project to localStorage\nexport function saveProject(project: JamzProject): void {\n  if (typeof window === 'undefined') return;\n\n  try {\n    const storable = projectToStorable(project);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(storable));\n\n    // Update projects list\n    updateProjectsList(project.id, project.name, project.updatedAt);\n  } catch (e) {\n    console.error('Failed to save project:', e);\n  }\n}\n\n// Load current project from localStorage\nexport function loadProject(): JamzProject | null {\n  if (typeof window === 'undefined') return null;\n\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    if (!stored) return null;\n\n    const parsed: StoredProject = JSON.parse(stored);\n\n    // Validate required fields exist to prevent crashes from corrupted data\n    if (!parsed || typeof parsed.id !== 'string' || !Array.isArray(parsed.tracks)) {\n      console.warn('Invalid project data in localStorage, clearing...');\n      localStorage.removeItem(STORAGE_KEY);\n      return null;\n    }\n\n    return storableToProject(parsed);\n  } catch (e) {\n    console.error('Failed to load project:', e);\n    // Clear corrupted data\n    try {\n      localStorage.removeItem(STORAGE_KEY);\n    } catch {\n      // Ignore if removal fails\n    }\n    return null;\n  }\n}\n\n// Save project by ID\nexport function saveProjectById(project: JamzProject): void {\n  if (typeof window === 'undefined') return;\n\n  try {\n    const storable = projectToStorable(project);\n    localStorage.setItem(`jamz_project_${project.id}`, JSON.stringify(storable));\n    updateProjectsList(project.id, project.name, Date.now());\n  } catch (e) {\n    console.error('Failed to save project:', e);\n  }\n}\n\n// Load project by ID\nexport function loadProjectById(id: string): JamzProject | null {\n  if (typeof window === 'undefined') return null;\n\n  try {\n    const stored = localStorage.getItem(`jamz_project_${id}`);\n    if (!stored) return null;\n\n    const parsed: StoredProject = JSON.parse(stored);\n    return storableToProject(parsed);\n  } catch (e) {\n    console.error('Failed to load project:', e);\n    return null;\n  }\n}\n\n// Update projects list metadata\nfunction updateProjectsList(id: string, name: string, updatedAt: number): void {\n  try {\n    const listStr = localStorage.getItem(PROJECTS_LIST_KEY);\n    const list: Array<{ id: string; name: string; updatedAt: number }> = listStr ? JSON.parse(listStr) : [];\n\n    const existingIndex = list.findIndex(p => p.id === id);\n    if (existingIndex >= 0) {\n      list[existingIndex] = { id, name, updatedAt };\n    } else {\n      list.push({ id, name, updatedAt });\n    }\n\n    // Sort by updatedAt descending\n    list.sort((a, b) => b.updatedAt - a.updatedAt);\n\n    localStorage.setItem(PROJECTS_LIST_KEY, JSON.stringify(list));\n  } catch (e) {\n    console.error('Failed to update projects list:', e);\n  }\n}\n\n// Get list of all saved projects\nexport function getProjectsList(): Array<{ id: string; name: string; updatedAt: number }> {\n  if (typeof window === 'undefined') return [];\n\n  try {\n    const listStr = localStorage.getItem(PROJECTS_LIST_KEY);\n    return listStr ? JSON.parse(listStr) : [];\n  } catch (e) {\n    console.error('Failed to get projects list:', e);\n    return [];\n  }\n}\n\n// Delete project\nexport function deleteProject(id: string): void {\n  if (typeof window === 'undefined') return;\n\n  try {\n    localStorage.removeItem(`jamz_project_${id}`);\n\n    const listStr = localStorage.getItem(PROJECTS_LIST_KEY);\n    if (listStr) {\n      const list = JSON.parse(listStr);\n      const filtered = list.filter((p: { id: string }) => p.id !== id);\n      localStorage.setItem(PROJECTS_LIST_KEY, JSON.stringify(filtered));\n    }\n\n    // If deleting current project, clear it\n    const current = localStorage.getItem(STORAGE_KEY);\n    if (current) {\n      const parsed = JSON.parse(current);\n      if (parsed.id === id) {\n        localStorage.removeItem(STORAGE_KEY);\n      }\n    }\n  } catch (e) {\n    console.error('Failed to delete project:', e);\n  }\n}\n\n// Clear all Jamz data\nexport function clearAllData(): void {\n  if (typeof window === 'undefined') return;\n\n  try {\n    const keys = Object.keys(localStorage);\n    keys.forEach(key => {\n      if (key.startsWith('jamz_')) {\n        localStorage.removeItem(key);\n      }\n    });\n  } catch (e) {\n    console.error('Failed to clear data:', e);\n  }\n}\n\n// Check if there's unsaved work\nexport function hasUnsavedWork(): boolean {\n  if (typeof window === 'undefined') return false;\n\n  try {\n    const current = localStorage.getItem(STORAGE_KEY);\n    return !!current;\n  } catch (e) {\n    return false;\n  }\n}\n\n// Generate a shareable link (placeholder for Convex integration)\nexport function generateShareLink(projectId: string): string {\n  // This would integrate with Convex to create a shareable link\n  // For now, return a placeholder\n  return `${typeof window !== 'undefined' ? window.location.origin : ''}/studio?project=${projectId}`;\n}\n","'use client';\n\n// MP3 Encoder using lamejs\n// This provides high-quality MP3 encoding in the browser\n\ninterface Mp3EncoderOptions {\n  sampleRate?: number;\n  bitRate?: number;\n  channels?: number;\n}\n\ninterface LamejsEncoder {\n  encodeBuffer: (left: Int16Array, right?: Int16Array) => Int8Array;\n  flush: () => Int8Array;\n}\n\ninterface Lamejs {\n  Mp3Encoder: new (channels: number, sampleRate: number, kbps: number) => LamejsEncoder;\n}\n\n// Dynamically import lamejs (it's a CommonJS module)\nlet lamejsPromise: Promise<Lamejs> | null = null;\n\nasync function getLamejs(): Promise<Lamejs> {\n  if (!lamejsPromise) {\n    lamejsPromise = import('lamejs').then((m) => m.default || m);\n  }\n  return lamejsPromise;\n}\n\n/**\n * Convert an AudioBuffer to MP3 format\n */\nexport async function audioBufferToMp3(\n  audioBuffer: AudioBuffer,\n  options: Mp3EncoderOptions = {}\n): Promise<Blob> {\n  const {\n    sampleRate = audioBuffer.sampleRate,\n    bitRate = 192, // kbps - good quality\n    channels = audioBuffer.numberOfChannels,\n  } = options;\n\n  const lamejs = await getLamejs();\n\n  // Create encoder\n  const mp3Encoder = new lamejs.Mp3Encoder(\n    Math.min(channels, 2), // Max 2 channels for MP3\n    sampleRate,\n    bitRate\n  );\n\n  const mp3Data: Int8Array[] = [];\n  const blockSize = 1152; // MP3 frame size\n\n  // Get channel data\n  const leftChannel = audioBuffer.getChannelData(0);\n  const rightChannel = channels > 1 ? audioBuffer.getChannelData(1) : leftChannel;\n\n  // Convert Float32Array to Int16Array (required by lamejs)\n  const leftSamples = floatTo16BitPCM(leftChannel);\n  const rightSamples = floatTo16BitPCM(rightChannel);\n\n  // Encode in blocks\n  const numBlocks = Math.ceil(leftSamples.length / blockSize);\n\n  for (let i = 0; i < numBlocks; i++) {\n    const start = i * blockSize;\n    const end = Math.min(start + blockSize, leftSamples.length);\n\n    const leftBlock = leftSamples.subarray(start, end);\n    const rightBlock = rightSamples.subarray(start, end);\n\n    const mp3buf = mp3Encoder.encodeBuffer(leftBlock, rightBlock);\n    if (mp3buf.length > 0) {\n      mp3Data.push(mp3buf);\n    }\n  }\n\n  // Flush remaining data\n  const flushBuffer = mp3Encoder.flush();\n  if (flushBuffer.length > 0) {\n    mp3Data.push(flushBuffer);\n  }\n\n  // Combine all MP3 data into a single blob\n  const totalLength = mp3Data.reduce((acc, arr) => acc + arr.length, 0);\n  const result = new Uint8Array(totalLength);\n  let offset = 0;\n\n  for (const chunk of mp3Data) {\n    result.set(new Uint8Array(chunk.buffer, chunk.byteOffset, chunk.length), offset);\n    offset += chunk.length;\n  }\n\n  return new Blob([result], { type: 'audio/mp3' });\n}\n\n/**\n * Convert Float32Array audio data to Int16Array for MP3 encoding\n */\nfunction floatTo16BitPCM(float32Array: Float32Array): Int16Array {\n  const int16Array = new Int16Array(float32Array.length);\n\n  for (let i = 0; i < float32Array.length; i++) {\n    // Clamp values between -1 and 1\n    const s = Math.max(-1, Math.min(1, float32Array[i]));\n    // Convert to 16-bit signed integer\n    int16Array[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n  }\n\n  return int16Array;\n}\n\n/**\n * Export multiple tracks as individual MP3 stems\n */\nexport async function exportStemsAsMp3(\n  stems: Array<{ name: string; buffer: AudioBuffer }>,\n  options: Mp3EncoderOptions = {}\n): Promise<Array<{ name: string; blob: Blob }>> {\n  const results: Array<{ name: string; blob: Blob }> = [];\n\n  for (const stem of stems) {\n    const blob = await audioBufferToMp3(stem.buffer, options);\n    results.push({\n      name: `${stem.name}.mp3`,\n      blob,\n    });\n  }\n\n  return results;\n}\n\n/**\n * Get estimated file size for MP3 encoding\n */\nexport function estimateMp3FileSize(\n  durationSeconds: number,\n  bitRate: number = 192\n): number {\n  // MP3 file size ‚âà (bitrate * duration) / 8\n  // Add ~2% overhead for headers/frames\n  return Math.ceil((bitRate * 1000 * durationSeconds) / 8 * 1.02);\n}\n\n/**\n * Format file size for display\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n","'use client';\n\nimport { useState, useCallback, useRef } from 'react';\n\n// Stem separation types\nexport type StemType = 'vocals' | 'drums' | 'bass' | 'other' | 'piano' | 'guitar';\n\nexport interface StemResult {\n  type: StemType;\n  audioBuffer: AudioBuffer;\n  audioUrl: string;\n  waveformPeaks: number[];\n}\n\nexport interface StemSeparationProgress {\n  status: 'idle' | 'uploading' | 'processing' | 'downloading' | 'complete' | 'error';\n  progress: number; // 0-100\n  message: string;\n  currentStem?: StemType;\n}\n\nexport interface StemSeparationOptions {\n  stems?: StemType[];\n  quality?: 'fast' | 'balanced' | 'high';\n  onProgress?: (progress: StemSeparationProgress) => void;\n}\n\n// API endpoint for stem separation (configurable)\nconst STEM_API_ENDPOINT = process.env.NEXT_PUBLIC_STEM_API_ENDPOINT || '/api/stems/separate';\n\n/**\n * Hook for AI-powered stem separation\n * Uses Demucs/Spleeter-style separation to extract vocals, drums, bass, and other instruments\n */\nexport function useStemSeparation() {\n  const [progress, setProgress] = useState<StemSeparationProgress>({\n    status: 'idle',\n    progress: 0,\n    message: '',\n  });\n  const [results, setResults] = useState<StemResult[] | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n  const audioContextRef = useRef<AudioContext | null>(null);\n\n  const getAudioContext = useCallback(() => {\n    if (!audioContextRef.current) {\n      audioContextRef.current = new AudioContext();\n    }\n    return audioContextRef.current;\n  }, []);\n\n  /**\n   * Separate an audio file into stems\n   */\n  const separateStems = useCallback(\n    async (\n      audioFile: File | Blob,\n      options: StemSeparationOptions = {}\n    ): Promise<StemResult[] | null> => {\n      const {\n        stems = ['vocals', 'drums', 'bass', 'other'],\n        quality = 'balanced',\n        onProgress,\n      } = options;\n\n      // Reset state\n      setError(null);\n      setResults(null);\n      abortControllerRef.current = new AbortController();\n\n      const updateProgress = (update: Partial<StemSeparationProgress>) => {\n        const newProgress = { ...progress, ...update };\n        setProgress(newProgress);\n        onProgress?.(newProgress);\n      };\n\n      try {\n        // Step 1: Upload audio\n        updateProgress({\n          status: 'uploading',\n          progress: 10,\n          message: 'Uploading audio...',\n        });\n\n        const formData = new FormData();\n        formData.append('audio', audioFile);\n        formData.append('stems', JSON.stringify(stems));\n        formData.append('quality', quality);\n\n        const uploadResponse = await fetch(STEM_API_ENDPOINT, {\n          method: 'POST',\n          body: formData,\n          signal: abortControllerRef.current.signal,\n        });\n\n        if (!uploadResponse.ok) {\n          // If API is not available, use client-side fallback\n          if (uploadResponse.status === 404) {\n            return await clientSideStemSeparation(audioFile, stems, updateProgress);\n          }\n          throw new Error(`Upload failed: ${uploadResponse.statusText}`);\n        }\n\n        const { jobId } = await uploadResponse.json();\n\n        // Step 2: Poll for processing status\n        updateProgress({\n          status: 'processing',\n          progress: 30,\n          message: 'AI is separating stems...',\n        });\n\n        let attempts = 0;\n        const maxAttempts = 120; // 2 minutes max\n        let processingComplete = false;\n\n        while (!processingComplete && attempts < maxAttempts) {\n          await new Promise((resolve) => setTimeout(resolve, 1000));\n\n          const statusResponse = await fetch(`${STEM_API_ENDPOINT}/status/${jobId}`, {\n            signal: abortControllerRef.current.signal,\n          });\n\n          if (!statusResponse.ok) {\n            throw new Error('Failed to check processing status');\n          }\n\n          const status = await statusResponse.json();\n\n          if (status.error) {\n            throw new Error(status.error);\n          }\n\n          updateProgress({\n            progress: 30 + Math.min(status.progress * 0.5, 50),\n            message: status.message || 'Processing...',\n            currentStem: status.currentStem,\n          });\n\n          if (status.complete) {\n            processingComplete = true;\n          }\n\n          attempts++;\n        }\n\n        if (!processingComplete) {\n          throw new Error('Processing timeout');\n        }\n\n        // Step 3: Download stems\n        updateProgress({\n          status: 'downloading',\n          progress: 80,\n          message: 'Downloading stems...',\n        });\n\n        const stemsResponse = await fetch(`${STEM_API_ENDPOINT}/download/${jobId}`, {\n          signal: abortControllerRef.current.signal,\n        });\n\n        if (!stemsResponse.ok) {\n          throw new Error('Failed to download stems');\n        }\n\n        const audioContext = getAudioContext();\n        const stemResults: StemResult[] = [];\n        const stemsData = await stemsResponse.json();\n\n        for (const stemData of stemsData.stems) {\n          // Decode audio from base64 or URL\n          const audioData = await fetchAudioData(stemData.url);\n          const audioBuffer = await audioContext.decodeAudioData(audioData);\n          const waveformPeaks = generateWaveformPeaks(audioBuffer);\n\n          stemResults.push({\n            type: stemData.type as StemType,\n            audioBuffer,\n            audioUrl: stemData.url,\n            waveformPeaks,\n          });\n\n          updateProgress({\n            progress: 80 + (stemResults.length / stemsData.stems.length) * 20,\n            message: `Downloaded ${stemData.type}...`,\n            currentStem: stemData.type,\n          });\n        }\n\n        updateProgress({\n          status: 'complete',\n          progress: 100,\n          message: 'Stem separation complete!',\n        });\n\n        setResults(stemResults);\n        return stemResults;\n      } catch (err) {\n        if (err instanceof Error && err.name === 'AbortError') {\n          updateProgress({\n            status: 'idle',\n            progress: 0,\n            message: 'Cancelled',\n          });\n          return null;\n        }\n\n        const errorMessage = err instanceof Error ? err.message : 'Stem separation failed';\n        setError(errorMessage);\n        updateProgress({\n          status: 'error',\n          progress: 0,\n          message: errorMessage,\n        });\n        return null;\n      }\n    },\n    [progress, getAudioContext]\n  );\n\n  /**\n   * Cancel ongoing stem separation\n   */\n  const cancel = useCallback(() => {\n    abortControllerRef.current?.abort();\n    setProgress({\n      status: 'idle',\n      progress: 0,\n      message: '',\n    });\n  }, []);\n\n  /**\n   * Reset state\n   */\n  const reset = useCallback(() => {\n    setProgress({\n      status: 'idle',\n      progress: 0,\n      message: '',\n    });\n    setResults(null);\n    setError(null);\n  }, []);\n\n  return {\n    separateStems,\n    cancel,\n    reset,\n    progress,\n    results,\n    error,\n    isProcessing: progress.status !== 'idle' && progress.status !== 'complete' && progress.status !== 'error',\n  };\n}\n\n/**\n * Client-side stem separation fallback using frequency filtering\n * This is a simplified version - real stem separation requires ML models\n */\nasync function clientSideStemSeparation(\n  audioFile: File | Blob,\n  stems: StemType[],\n  updateProgress: (update: Partial<StemSeparationProgress>) => void\n): Promise<StemResult[]> {\n  updateProgress({\n    status: 'processing',\n    progress: 20,\n    message: 'Processing audio locally...',\n  });\n\n  const audioContext = new AudioContext();\n  const arrayBuffer = await audioFile.arrayBuffer();\n  const originalBuffer = await audioContext.decodeAudioData(arrayBuffer);\n\n  const results: StemResult[] = [];\n\n  for (let i = 0; i < stems.length; i++) {\n    const stemType = stems[i];\n    updateProgress({\n      progress: 20 + ((i + 1) / stems.length) * 70,\n      message: `Extracting ${stemType}...`,\n      currentStem: stemType,\n    });\n\n    // Create filtered version based on stem type\n    const filteredBuffer = await createFilteredStem(audioContext, originalBuffer, stemType);\n    const waveformPeaks = generateWaveformPeaks(filteredBuffer);\n\n    // Create a blob URL for the filtered audio\n    const wavBlob = audioBufferToWav(filteredBuffer);\n    const audioUrl = URL.createObjectURL(wavBlob);\n\n    results.push({\n      type: stemType,\n      audioBuffer: filteredBuffer,\n      audioUrl,\n      waveformPeaks,\n    });\n  }\n\n  updateProgress({\n    status: 'complete',\n    progress: 100,\n    message: 'Stem separation complete!',\n  });\n\n  return results;\n}\n\n/**\n * Create a filtered version of audio for a specific stem type\n * Uses frequency-based isolation (simplified approach)\n */\nasync function createFilteredStem(\n  audioContext: AudioContext,\n  sourceBuffer: AudioBuffer,\n  stemType: StemType\n): Promise<AudioBuffer> {\n  const offlineContext = new OfflineAudioContext(\n    sourceBuffer.numberOfChannels,\n    sourceBuffer.length,\n    sourceBuffer.sampleRate\n  );\n\n  const source = offlineContext.createBufferSource();\n  source.buffer = sourceBuffer;\n\n  // Create filters based on stem type\n  const filters: BiquadFilterNode[] = [];\n\n  switch (stemType) {\n    case 'vocals':\n      // Vocals typically in 300Hz - 3kHz range, centered\n      const vocalHighpass = offlineContext.createBiquadFilter();\n      vocalHighpass.type = 'highpass';\n      vocalHighpass.frequency.value = 300;\n      vocalHighpass.Q.value = 0.7;\n\n      const vocalLowpass = offlineContext.createBiquadFilter();\n      vocalLowpass.type = 'lowpass';\n      vocalLowpass.frequency.value = 3500;\n      vocalLowpass.Q.value = 0.7;\n\n      filters.push(vocalHighpass, vocalLowpass);\n      break;\n\n    case 'drums':\n      // Drums have low-end punch and high-end attack\n      const drumLow = offlineContext.createBiquadFilter();\n      drumLow.type = 'lowshelf';\n      drumLow.frequency.value = 150;\n      drumLow.gain.value = 6;\n\n      const drumHigh = offlineContext.createBiquadFilter();\n      drumHigh.type = 'highshelf';\n      drumHigh.frequency.value = 5000;\n      drumHigh.gain.value = 3;\n\n      const drumMidCut = offlineContext.createBiquadFilter();\n      drumMidCut.type = 'peaking';\n      drumMidCut.frequency.value = 800;\n      drumMidCut.Q.value = 1;\n      drumMidCut.gain.value = -6;\n\n      filters.push(drumLow, drumMidCut, drumHigh);\n      break;\n\n    case 'bass':\n      // Bass typically under 250Hz\n      const bassLowpass = offlineContext.createBiquadFilter();\n      bassLowpass.type = 'lowpass';\n      bassLowpass.frequency.value = 250;\n      bassLowpass.Q.value = 0.7;\n\n      const bassBoost = offlineContext.createBiquadFilter();\n      bassBoost.type = 'lowshelf';\n      bassBoost.frequency.value = 100;\n      bassBoost.gain.value = 3;\n\n      filters.push(bassLowpass, bassBoost);\n      break;\n\n    case 'piano':\n    case 'guitar':\n    case 'other':\n    default:\n      // General mid-range instruments\n      const midHighpass = offlineContext.createBiquadFilter();\n      midHighpass.type = 'highpass';\n      midHighpass.frequency.value = 200;\n      midHighpass.Q.value = 0.7;\n\n      const midLowpass = offlineContext.createBiquadFilter();\n      midLowpass.type = 'lowpass';\n      midLowpass.frequency.value = 5000;\n      midLowpass.Q.value = 0.7;\n\n      filters.push(midHighpass, midLowpass);\n      break;\n  }\n\n  // Connect the filter chain\n  let lastNode: AudioNode = source;\n  for (const filter of filters) {\n    lastNode.connect(filter);\n    lastNode = filter;\n  }\n  lastNode.connect(offlineContext.destination);\n\n  source.start();\n  return await offlineContext.startRendering();\n}\n\n/**\n * Helper to fetch audio data from a URL\n */\nasync function fetchAudioData(url: string): Promise<ArrayBuffer> {\n  if (url.startsWith('data:')) {\n    // Base64 encoded\n    const base64 = url.split(',')[1];\n    const binary = atob(base64);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) {\n      bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes.buffer;\n  }\n\n  const response = await fetch(url);\n  return await response.arrayBuffer();\n}\n\n/**\n * Generate waveform peaks from AudioBuffer\n */\nfunction generateWaveformPeaks(buffer: AudioBuffer, numPeaks: number = 200): number[] {\n  const channelData = buffer.getChannelData(0);\n  const blockSize = Math.floor(channelData.length / numPeaks);\n  const peaks: number[] = [];\n\n  for (let i = 0; i < numPeaks; i++) {\n    const start = i * blockSize;\n    const end = Math.min(start + blockSize, channelData.length);\n    let max = 0;\n\n    for (let j = start; j < end; j++) {\n      const abs = Math.abs(channelData[j]);\n      if (abs > max) max = abs;\n    }\n\n    peaks.push(max);\n  }\n\n  return peaks;\n}\n\n/**\n * Convert AudioBuffer to WAV blob\n */\nfunction audioBufferToWav(buffer: AudioBuffer): Blob {\n  const numChannels = buffer.numberOfChannels;\n  const sampleRate = buffer.sampleRate;\n  const format = 1; // PCM\n  const bitDepth = 16;\n\n  const bytesPerSample = bitDepth / 8;\n  const blockAlign = numChannels * bytesPerSample;\n\n  const dataLength = buffer.length * blockAlign;\n  const bufferLength = 44 + dataLength;\n\n  const arrayBuffer = new ArrayBuffer(bufferLength);\n  const view = new DataView(arrayBuffer);\n\n  // WAV header\n  writeString(view, 0, 'RIFF');\n  view.setUint32(4, bufferLength - 8, true);\n  writeString(view, 8, 'WAVE');\n  writeString(view, 12, 'fmt ');\n  view.setUint32(16, 16, true);\n  view.setUint16(20, format, true);\n  view.setUint16(22, numChannels, true);\n  view.setUint32(24, sampleRate, true);\n  view.setUint32(28, sampleRate * blockAlign, true);\n  view.setUint16(32, blockAlign, true);\n  view.setUint16(34, bitDepth, true);\n  writeString(view, 36, 'data');\n  view.setUint32(40, dataLength, true);\n\n  // Interleave channel data\n  const channels: Float32Array[] = [];\n  for (let i = 0; i < numChannels; i++) {\n    channels.push(buffer.getChannelData(i));\n  }\n\n  let offset = 44;\n  for (let i = 0; i < buffer.length; i++) {\n    for (let ch = 0; ch < numChannels; ch++) {\n      const sample = Math.max(-1, Math.min(1, channels[ch][i]));\n      const intSample = sample < 0 ? sample * 0x8000 : sample * 0x7fff;\n      view.setInt16(offset, intSample, true);\n      offset += 2;\n    }\n  }\n\n  return new Blob([arrayBuffer], { type: 'audio/wav' });\n}\n\nfunction writeString(view: DataView, offset: number, str: string) {\n  for (let i = 0; i < str.length; i++) {\n    view.setUint8(offset + i, str.charCodeAt(i));\n  }\n}\n","'use client';\n\n/**\n * GenerateView - AI Music Generation Playground for Jamz Studio\n *\n * Two-panel layout:\n * - Left: Full-featured generation form with ALL ACE-Step parameters\n * - Right: Generated tracks library with inline playback + \"Add to Arrange\"\n *\n * Design: iOS-quality, 8pt grid, 44px touch targets, prefers-reduced-motion\n *\n * Now integrated with Convex for persistent track library.\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { motion, AnimatePresence, useReducedMotion } from 'framer-motion';\nimport {\n  Sparkles,\n  Loader2,\n  CheckCircle,\n  XCircle,\n  Play,\n  Pause,\n  Plus,\n  ChevronDown,\n  ChevronUp,\n  Music,\n  Clock,\n  Upload,\n  Trash2,\n  Settings2,\n  Globe,\n  Wand2,\n  RefreshCw,\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { useQuery, useMutation } from '@/lib/openclaw/hooks';\nimport { api } from '@/lib/convex-shim';\nimport { Id } from '../../../convex/_generated/dataModel';\nimport { useMusicGeneration, MUSIC_PRESETS, MusicPreset, MusicGenerateParams } from '@/hooks/useMusicGeneration';\n\n// ============================================================================\n// Types\n// ============================================================================\n\ninterface GenerateViewProps {\n  onAddToArrange?: (result: {\n    audioUrl: string;\n    title: string;\n    duration: number;\n    bpm: number;\n    key: string;\n  }) => void;\n  projectId?: string;\n  colors: Record<string, string | boolean>;\n}\n\ninterface GeneratedTrackItem {\n  _id: Id<\"generatedTracks\">;\n  title: string;\n  prompt: string;\n  audioUrl: string;\n  duration: number;\n  bpm: number;\n  key: string;\n  timeSignature: string;\n  createdAt: number;\n}\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst KEY_OPTIONS = [\n  'C major', 'C minor', 'C# major', 'C# minor',\n  'D major', 'D minor', 'D# major', 'D# minor',\n  'E major', 'E minor',\n  'F major', 'F minor', 'F# major', 'F# minor',\n  'G major', 'G minor', 'G# major', 'G# minor',\n  'A major', 'A minor', 'A# major', 'A# minor',\n  'B major', 'B minor', 'Bb major', 'Bb minor',\n];\n\nconst TIME_SIGNATURES = ['4/4', '3/4', '6/8', '2/4', '5/4', '7/8'];\n\nconst VOCAL_LANGUAGES = [\n  { code: 'en', label: 'English' },\n  { code: 'zh', label: 'Chinese' },\n  { code: 'ja', label: 'Japanese' },\n  { code: 'ko', label: 'Korean' },\n  { code: 'es', label: 'Spanish' },\n  { code: 'fr', label: 'French' },\n  { code: 'de', label: 'German' },\n  { code: 'it', label: 'Italian' },\n  { code: 'pt', label: 'Portuguese' },\n  { code: 'ru', label: 'Russian' },\n  { code: 'hi', label: 'Hindi' },\n  { code: 'ar', label: 'Arabic' },\n  { code: 'th', label: 'Thai' },\n  { code: 'vi', label: 'Vietnamese' },\n  { code: 'nl', label: 'Dutch' },\n  { code: 'bn', label: 'Bengali' },\n];\n\nconst OUTPUT_FORMATS = ['mp3', 'wav', 'flac'] as const;\n\nconst TASK_TYPES = [\n  { value: 'text2music', label: 'Text to Music' },\n  { value: 'cover', label: 'Cover / Style Transfer' },\n  { value: 'repaint', label: 'Repaint (Edit Section)' },\n] as const;\n\n// ============================================================================\n// Component\n// ============================================================================\n\nexport function GenerateView({ onAddToArrange, projectId, colors }: GenerateViewProps) {\n  const reducedMotion = useReducedMotion();\n\n  // --- Form State ---\n  const [prompt, setPrompt] = useState('');\n  const [lyrics, setLyrics] = useState('');\n  const [showLyrics, setShowLyrics] = useState(false);\n  const [duration, setDuration] = useState(30);\n  const [bpm, setBpm] = useState<number | undefined>(undefined);\n  const [key, setKey] = useState<string | undefined>(undefined);\n  const [timeSignature, setTimeSignature] = useState('4/4');\n  const [title, setTitle] = useState('');\n  const [selectedPreset, setSelectedPreset] = useState<MusicPreset | ''>('');\n  const [format, setFormat] = useState<'mp3' | 'wav' | 'flac'>('mp3');\n  const [vocalLanguage, setVocalLanguage] = useState('en');\n\n  // Reference audio\n  const [referenceAudio, setReferenceAudio] = useState<string | undefined>(undefined);\n  const [referenceStrength, setReferenceStrength] = useState(0.5);\n  const [referenceFileName, setReferenceFileName] = useState('');\n  const refInputRef = useRef<HTMLInputElement>(null);\n\n  // Advanced params\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  const [thinking, setThinking] = useState(false);\n  const [inferenceSteps, setInferenceSteps] = useState<number | undefined>(undefined);\n  const [guidanceScale, setGuidanceScale] = useState<number | undefined>(undefined);\n  const [seed, setSeed] = useState<number | undefined>(undefined);\n  const [batchSize, setBatchSize] = useState(1);\n  const [taskType, setTaskType] = useState<string>('text2music');\n\n  // --- Generation State ---\n  const {\n    generate,\n    isGenerating,\n    progress,\n    message,\n    error,\n    result,\n    reset,\n  } = useMusicGeneration();\n\n  // --- Library State (Convex-backed) ---\n  // Note: projectId from local Jamz Studio is not a valid Convex ID format.\n  // Only pass it when it's a valid Convex ID (starts with expected pattern).\n  // For now, we skip the projectId filter since local projects don't sync to Convex yet.\n  const isValidConvexId = projectId && /^[a-z0-9]{16,}$/i.test(projectId);\n  const convexTracks = useQuery(api.musicGeneration.getGeneratedTracks, {\n    projectId: isValidConvexId ? (projectId as Id<\"jamzProjects\">) : undefined,\n    limit: 50,\n  });\n  const deleteTrackMutation = useMutation(api.musicGeneration.deleteTrack);\n\n  // Map Convex tracks to our interface (handles loading state)\n  const generatedTracks: GeneratedTrackItem[] = (convexTracks || []).map(track => ({\n    _id: track._id,\n    title: track.title,\n    prompt: track.prompt,\n    audioUrl: track.audioUrl,\n    duration: track.duration,\n    bpm: track.bpm,\n    key: track.key,\n    timeSignature: track.timeSignature,\n    createdAt: track.createdAt,\n  }));\n\n  const [playingTrackId, setPlayingTrackId] = useState<Id<\"generatedTracks\"> | null>(null);\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const isLoadingTracks = convexTracks === undefined;\n\n  // No longer need local useEffect - Convex handles real-time updates automatically\n\n  // --- Handlers ---\n\n  const applyPreset = useCallback((presetKey: MusicPreset) => {\n    const preset = MUSIC_PRESETS[presetKey];\n    setPrompt(preset.prompt);\n    setDuration(preset.duration);\n    setBpm(preset.bpm);\n    setKey(preset.key);\n    setSelectedPreset(presetKey);\n  }, []);\n\n  const handleReferenceUpload = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    setReferenceFileName(file.name);\n    // For now, create a blob URL - in production this would upload to storage\n    const url = URL.createObjectURL(file);\n    setReferenceAudio(url);\n  }, []);\n\n  const handleGenerate = useCallback(async () => {\n    if (!prompt.trim()) return;\n\n    const params: MusicGenerateParams = {\n      prompt: prompt.trim(),\n      lyrics: lyrics.trim() || undefined,\n      duration,\n      bpm,\n      key,\n      timeSignature,\n      title: title.trim() || undefined,\n      format,\n      vocalLanguage,\n      referenceAudio,\n      referenceStrength: referenceAudio ? referenceStrength : undefined,\n      thinking,\n      inferenceSteps,\n      guidanceScale,\n      seed,\n      batchSize: batchSize > 1 ? batchSize : undefined,\n      taskType: taskType !== 'text2music' ? taskType as MusicGenerateParams['taskType'] : undefined,\n      saveToJamz: true,\n      projectId,\n    };\n\n    await generate(params);\n  }, [prompt, lyrics, duration, bpm, key, timeSignature, title, format, vocalLanguage, referenceAudio, referenceStrength, thinking, inferenceSteps, guidanceScale, seed, batchSize, taskType, projectId, generate]);\n\n  const handlePlayTrack = useCallback((track: GeneratedTrackItem) => {\n    if (playingTrackId === track._id) {\n      audioRef.current?.pause();\n      setPlayingTrackId(null);\n    } else {\n      if (audioRef.current) {\n        audioRef.current.pause();\n      }\n      const audio = new Audio(track.audioUrl);\n      audio.onended = () => setPlayingTrackId(null);\n      audio.play();\n      audioRef.current = audio;\n      setPlayingTrackId(track._id);\n    }\n  }, [playingTrackId]);\n\n  const handleAddToArrange = useCallback((track: GeneratedTrackItem) => {\n    onAddToArrange?.({\n      audioUrl: track.audioUrl,\n      title: track.title,\n      duration: track.duration,\n      bpm: track.bpm,\n      key: track.key,\n    });\n  }, [onAddToArrange]);\n\n  const handleRemoveTrack = useCallback(async (trackId: Id<\"generatedTracks\">) => {\n    if (playingTrackId === trackId) {\n      audioRef.current?.pause();\n      setPlayingTrackId(null);\n    }\n    try {\n      await deleteTrackMutation({ trackId });\n    } catch (error) {\n      console.error('[GenerateView] Failed to delete track:', error);\n    }\n  }, [playingTrackId, deleteTrackMutation]);\n\n  const formatDuration = (s: number) =>\n    s < 60 ? `${s}s` : `${Math.floor(s / 60)}m ${s % 60}s`;\n\n  // --- Render ---\n\n  return (\n    <div className=\"flex-1 flex flex-col lg:flex-row gap-0 overflow-hidden\">\n      {/* ================================================================ */}\n      {/* LEFT: Generation Form */}\n      {/* ================================================================ */}\n      <div className={`flex-1 overflow-y-auto p-4 lg:p-6 border-r ${colors.border}`}>\n        <div className=\"max-w-xl mx-auto space-y-5\">\n          {/* Header */}\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Sparkles className=\"w-5 h-5 text-purple-500\" />\n            <h2 className={`text-base font-semibold ${colors.text}`}>AI Music Generator</h2>\n          </div>\n\n          {/* Presets */}\n          <div className=\"space-y-2\">\n            <label className={`text-xs font-medium ${colors.textMuted}`}>Quick Presets</label>\n            <div className=\"flex flex-wrap gap-1.5\">\n              {(Object.keys(MUSIC_PRESETS) as MusicPreset[]).map((presetKey) => (\n                <button\n                  key={presetKey}\n                  onClick={() => applyPreset(presetKey)}\n                  disabled={isGenerating}\n                  className={cn(\n                    'px-2.5 py-1.5 text-xs rounded-lg transition-colors min-h-[32px] touch-manipulation',\n                    'focus:outline-none focus:ring-2 focus:ring-purple-500',\n                    selectedPreset === presetKey\n                      ? 'bg-purple-600 text-white'\n                      : `${colors.card} ${colors.textMuted} border ${colors.border} hover:border-purple-500/50`\n                  )}\n                >\n                  {presetKey.charAt(0).toUpperCase() + presetKey.slice(1).replace(/([A-Z])/g, ' $1')}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Prompt */}\n          <div className=\"space-y-1.5\">\n            <label htmlFor=\"gen-prompt\" className={`text-xs font-medium ${colors.textMuted}`}>\n              Style Description *\n            </label>\n            <textarea\n              id=\"gen-prompt\"\n              placeholder=\"Describe the music: genre, instruments, mood, production style...\"\n              value={prompt}\n              onChange={(e) => setPrompt(e.target.value)}\n              disabled={isGenerating}\n              rows={3}\n              className={`w-full px-3 py-2.5 ${colors.card} border ${colors.border} rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 ${colors.text} placeholder:${colors.textFaint}`}\n            />\n          </div>\n\n          {/* Lyrics */}\n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center justify-between\">\n              <label className={`text-xs font-medium ${colors.textMuted}`}>Lyrics</label>\n              <button\n                onClick={() => setShowLyrics(!showLyrics)}\n                disabled={isGenerating}\n                className={`text-xs ${colors.textFaint} hover:text-purple-400 transition-colors`}\n              >\n                {showLyrics ? 'Hide' : 'Add Lyrics'}\n              </button>\n            </div>\n            <AnimatePresence>\n              {showLyrics && (\n                <motion.div\n                  initial={reducedMotion ? { opacity: 1 } : { opacity: 0, height: 0 }}\n                  animate={{ opacity: 1, height: 'auto' }}\n                  exit={reducedMotion ? { opacity: 0 } : { opacity: 0, height: 0 }}\n                  className=\"space-y-2\"\n                >\n                  <div className=\"flex items-center gap-2\">\n                    <Globe className=\"w-3.5 h-3.5 text-purple-400\" />\n                    <select\n                      value={vocalLanguage}\n                      onChange={(e) => setVocalLanguage(e.target.value)}\n                      disabled={isGenerating}\n                      className={`text-xs px-2 py-1 ${colors.card} border ${colors.border} rounded-md ${colors.text} focus:ring-2 focus:ring-purple-500`}\n                      aria-label=\"Vocal language\"\n                    >\n                      {VOCAL_LANGUAGES.map((l) => (\n                        <option key={l.code} value={l.code}>{l.label}</option>\n                      ))}\n                    </select>\n                  </div>\n                  <textarea\n                    placeholder={'[Verse]\\nYour lyrics here...\\n\\n[Chorus]\\nCatchy hook...\\n\\n[Instrumental] for no vocals'}\n                    value={lyrics}\n                    onChange={(e) => setLyrics(e.target.value)}\n                    disabled={isGenerating}\n                    rows={5}\n                    className={`w-full px-3 py-2.5 ${colors.card} border ${colors.border} rounded-lg font-mono text-xs resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 ${colors.text}`}\n                  />\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n\n          {/* Duration slider */}\n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center justify-between\">\n              <label className={`text-xs font-medium ${colors.textMuted}`}>Duration</label>\n              <span className={`text-xs tabular-nums ${colors.textFaint}`}>{formatDuration(duration)}</span>\n            </div>\n            <input\n              type=\"range\"\n              value={duration}\n              onChange={(e) => setDuration(parseInt(e.target.value))}\n              min={10}\n              max={300}\n              step={5}\n              disabled={isGenerating}\n              className=\"w-full accent-purple-500\"\n              aria-label=\"Duration\"\n            />\n            <div className={`flex justify-between text-[10px] ${colors.textFaint}`}>\n              <span>10s</span>\n              <span>5 min</span>\n            </div>\n          </div>\n\n          {/* BPM / Key / Time Sig / Format row */}\n          <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3\">\n            <div className=\"space-y-1\">\n              <label htmlFor=\"gen-bpm\" className={`text-[10px] font-medium ${colors.textMuted}`}>BPM</label>\n              <input\n                id=\"gen-bpm\"\n                type=\"number\"\n                placeholder=\"Auto\"\n                value={bpm ?? ''}\n                onChange={(e) => setBpm(e.target.value ? parseInt(e.target.value) : undefined)}\n                min={30}\n                max={300}\n                disabled={isGenerating}\n                className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n              />\n            </div>\n            <div className=\"space-y-1\">\n              <label className={`text-[10px] font-medium ${colors.textMuted}`}>Key</label>\n              <select\n                value={key ?? ''}\n                onChange={(e) => setKey(e.target.value || undefined)}\n                disabled={isGenerating}\n                className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                aria-label=\"Key\"\n              >\n                <option value=\"\">Auto</option>\n                {KEY_OPTIONS.map((k) => (\n                  <option key={k} value={k}>{k}</option>\n                ))}\n              </select>\n            </div>\n            <div className=\"space-y-1\">\n              <label className={`text-[10px] font-medium ${colors.textMuted}`}>Time Sig</label>\n              <select\n                value={timeSignature}\n                onChange={(e) => setTimeSignature(e.target.value)}\n                disabled={isGenerating}\n                className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                aria-label=\"Time signature\"\n              >\n                {TIME_SIGNATURES.map((ts) => (\n                  <option key={ts} value={ts}>{ts}</option>\n                ))}\n              </select>\n            </div>\n            <div className=\"space-y-1\">\n              <label className={`text-[10px] font-medium ${colors.textMuted}`}>Format</label>\n              <select\n                value={format}\n                onChange={(e) => setFormat(e.target.value as typeof format)}\n                disabled={isGenerating}\n                className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                aria-label=\"Output format\"\n              >\n                {OUTPUT_FORMATS.map((f) => (\n                  <option key={f} value={f}>{f.toUpperCase()}</option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          {/* Reference Audio */}\n          <div className=\"space-y-1.5\">\n            <label className={`text-xs font-medium ${colors.textMuted}`}>Reference Audio (Style Transfer)</label>\n            <div className=\"flex items-center gap-2\">\n              <input\n                ref={refInputRef}\n                type=\"file\"\n                accept=\"audio/*\"\n                onChange={handleReferenceUpload}\n                className=\"sr-only\"\n                aria-label=\"Upload reference audio\"\n              />\n              <button\n                onClick={() => refInputRef.current?.click()}\n                disabled={isGenerating}\n                className={cn(\n                  'flex items-center gap-2 px-3 py-2 rounded-lg text-xs min-h-[36px] transition-colors touch-manipulation',\n                  'focus:outline-none focus:ring-2 focus:ring-purple-500',\n                  `${colors.card} border ${colors.border} ${colors.textMuted} hover:border-purple-500/50`\n                )}\n              >\n                <Upload className=\"w-3.5 h-3.5\" />\n                {referenceFileName || 'Upload audio file'}\n              </button>\n              {referenceAudio && (\n                <button\n                  onClick={() => { setReferenceAudio(undefined); setReferenceFileName(''); }}\n                  className={`p-1.5 rounded ${colors.textFaint} hover:text-red-400 transition-colors`}\n                  aria-label=\"Remove reference audio\"\n                >\n                  <XCircle className=\"w-4 h-4\" />\n                </button>\n              )}\n            </div>\n            {referenceAudio && (\n              <div className=\"space-y-1\">\n                <div className=\"flex items-center justify-between\">\n                  <span className={`text-[10px] ${colors.textFaint}`}>Style Strength</span>\n                  <span className={`text-[10px] tabular-nums ${colors.textFaint}`}>{Math.round(referenceStrength * 100)}%</span>\n                </div>\n                <input\n                  type=\"range\"\n                  value={referenceStrength}\n                  onChange={(e) => setReferenceStrength(parseFloat(e.target.value))}\n                  min={0}\n                  max={1}\n                  step={0.05}\n                  disabled={isGenerating}\n                  className=\"w-full accent-purple-500\"\n                  aria-label=\"Reference strength\"\n                />\n              </div>\n            )}\n          </div>\n\n          {/* Title */}\n          <div className=\"space-y-1.5\">\n            <label htmlFor=\"gen-title\" className={`text-xs font-medium ${colors.textMuted}`}>Track Title</label>\n            <input\n              id=\"gen-title\"\n              type=\"text\"\n              placeholder=\"Optional title\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              disabled={isGenerating}\n              className={`w-full px-3 py-2 ${colors.card} border ${colors.border} rounded-lg text-sm ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n            />\n          </div>\n\n          {/* Advanced Settings (collapsible) */}\n          <div className={`border ${colors.border} rounded-lg overflow-hidden`}>\n            <button\n              onClick={() => setShowAdvanced(!showAdvanced)}\n              className={cn(\n                'w-full flex items-center justify-between px-3 py-2.5 text-xs font-medium min-h-[40px] transition-colors touch-manipulation',\n                'focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-inset',\n                `${colors.card} ${colors.textMuted} hover:${colors.text}`\n              )}\n              aria-expanded={showAdvanced}\n            >\n              <div className=\"flex items-center gap-2\">\n                <Settings2 className=\"w-3.5 h-3.5\" />\n                Advanced Settings\n              </div>\n              {showAdvanced ? <ChevronUp className=\"w-3.5 h-3.5\" /> : <ChevronDown className=\"w-3.5 h-3.5\" />}\n            </button>\n            <AnimatePresence>\n              {showAdvanced && (\n                <motion.div\n                  initial={reducedMotion ? { opacity: 1 } : { opacity: 0, height: 0 }}\n                  animate={{ opacity: 1, height: 'auto' }}\n                  exit={reducedMotion ? { opacity: 0 } : { opacity: 0, height: 0 }}\n                  className={`px-3 pb-3 space-y-3 border-t ${colors.border}`}\n                >\n                  <div className=\"pt-3 grid grid-cols-2 gap-3\">\n                    {/* Task Type */}\n                    <div className=\"space-y-1 col-span-2\">\n                      <label className={`text-[10px] font-medium ${colors.textMuted}`}>Task Type</label>\n                      <select\n                        value={taskType}\n                        onChange={(e) => setTaskType(e.target.value)}\n                        disabled={isGenerating}\n                        className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                        aria-label=\"Task type\"\n                      >\n                        {TASK_TYPES.map((t) => (\n                          <option key={t.value} value={t.value}>{t.label}</option>\n                        ))}\n                      </select>\n                    </div>\n\n                    {/* Thinking Mode */}\n                    <div className=\"flex items-center gap-2 col-span-2\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"gen-thinking\"\n                        checked={thinking}\n                        onChange={(e) => setThinking(e.target.checked)}\n                        disabled={isGenerating}\n                        className=\"h-4 w-4 accent-purple-500 rounded\"\n                      />\n                      <label htmlFor=\"gen-thinking\" className={`text-xs ${colors.textMuted}`}>\n                        Thinking Mode (5Hz LM - higher quality, slower)\n                      </label>\n                    </div>\n\n                    {/* Inference Steps */}\n                    <div className=\"space-y-1\">\n                      <label className={`text-[10px] font-medium ${colors.textMuted}`}>Steps</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"8\"\n                        value={inferenceSteps ?? ''}\n                        onChange={(e) => setInferenceSteps(e.target.value ? parseInt(e.target.value) : undefined)}\n                        min={1}\n                        max={200}\n                        disabled={isGenerating}\n                        className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                      />\n                    </div>\n\n                    {/* Guidance Scale */}\n                    <div className=\"space-y-1\">\n                      <label className={`text-[10px] font-medium ${colors.textMuted}`}>Guidance</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"7.0\"\n                        value={guidanceScale ?? ''}\n                        onChange={(e) => setGuidanceScale(e.target.value ? parseFloat(e.target.value) : undefined)}\n                        step={0.5}\n                        disabled={isGenerating}\n                        className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                      />\n                    </div>\n\n                    {/* Seed */}\n                    <div className=\"space-y-1\">\n                      <label className={`text-[10px] font-medium ${colors.textMuted}`}>Seed</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"Random\"\n                        value={seed ?? ''}\n                        onChange={(e) => setSeed(e.target.value ? parseInt(e.target.value) : undefined)}\n                        disabled={isGenerating}\n                        className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                      />\n                    </div>\n\n                    {/* Batch Size */}\n                    <div className=\"space-y-1\">\n                      <label htmlFor=\"gen-batch\" className={`text-[10px] font-medium ${colors.textMuted}`}>Batch</label>\n                      <input\n                        id=\"gen-batch\"\n                        type=\"number\"\n                        value={batchSize}\n                        onChange={(e) => setBatchSize(Math.max(1, Math.min(8, parseInt(e.target.value) || 1)))}\n                        min={1}\n                        max={8}\n                        disabled={isGenerating}\n                        className={`w-full px-2 py-2 ${colors.card} border ${colors.border} rounded-lg text-xs ${colors.text} focus:ring-2 focus:ring-purple-500 min-h-[36px]`}\n                      />\n                    </div>\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n\n          {/* Progress */}\n          {isGenerating && (\n            <div className={`rounded-lg border ${colors.border} ${colors.card} p-3 space-y-2`}>\n              <div className=\"flex items-center gap-2\">\n                <Loader2 className=\"h-4 w-4 animate-spin text-purple-500\" />\n                <span className={`text-xs font-medium ${colors.text}`}>{message}</span>\n              </div>\n              <div className={`h-1.5 ${colors.bgTertiary} rounded-full overflow-hidden`}>\n                <motion.div\n                  className=\"h-full bg-purple-500 rounded-full\"\n                  initial={{ width: 0 }}\n                  animate={{ width: `${progress}%` }}\n                  transition={{ duration: 0.5 }}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Success inline */}\n          {result && !isGenerating && (\n            <div className=\"rounded-lg border border-green-500/30 bg-green-500/10 p-3 space-y-2\">\n              <div className=\"flex items-center gap-2 text-green-500\">\n                <CheckCircle className=\"h-4 w-4\" />\n                <span className=\"text-xs font-medium\">Generated successfully</span>\n              </div>\n              <audio src={result.audioUrl} controls className=\"w-full h-8\" />\n            </div>\n          )}\n\n          {/* Error */}\n          {error && (\n            <div className=\"rounded-lg border border-red-500/30 bg-red-500/10 p-3\">\n              <div className=\"flex items-center gap-2 text-red-400\">\n                <XCircle className=\"h-4 w-4\" />\n                <span className=\"text-xs\">{error}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Generate Button */}\n          <button\n            onClick={handleGenerate}\n            disabled={isGenerating || !prompt.trim()}\n            className={cn(\n              'w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-semibold transition-all min-h-[48px] touch-manipulation',\n              'focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2',\n              isGenerating || !prompt.trim()\n                ? 'bg-purple-600/50 text-white/50 cursor-not-allowed'\n                : 'bg-purple-600 text-white hover:bg-purple-700 active:scale-[0.98]'\n            )}\n          >\n            {isGenerating ? (\n              <>\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n                Generating...\n              </>\n            ) : (\n              <>\n                <Wand2 className=\"w-4 h-4\" />\n                Generate Music\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* ================================================================ */}\n      {/* RIGHT: Generated Tracks Library */}\n      {/* ================================================================ */}\n      <div className=\"flex-1 flex flex-col overflow-hidden lg:max-w-sm xl:max-w-md\">\n        <div className={`flex items-center justify-between px-4 py-3 border-b ${colors.border}`}>\n          <h3 className={`text-xs font-semibold ${colors.text} uppercase tracking-wider`}>\n            Generated Tracks\n          </h3>\n          <span className={`text-[10px] ${colors.textFaint} tabular-nums`}>\n            {isLoadingTracks ? '...' : `${generatedTracks.length} tracks`}\n          </span>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto\">\n          {isLoadingTracks ? (\n            <div className=\"flex flex-col items-center justify-center h-full p-8 text-center\">\n              <div className={`w-12 h-12 rounded-xl ${colors.card} flex items-center justify-center mb-3`}>\n                <RefreshCw className={`w-6 h-6 ${colors.textFaint} animate-spin`} />\n              </div>\n              <p className={`text-xs ${colors.textFaint}`}>\n                Loading your tracks...\n              </p>\n            </div>\n          ) : generatedTracks.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center h-full p-8 text-center\">\n              <div className={`w-12 h-12 rounded-xl ${colors.card} flex items-center justify-center mb-3`}>\n                <Music className={`w-6 h-6 ${colors.textFaint}`} />\n              </div>\n              <p className={`text-xs ${colors.textFaint} max-w-[200px]`}>\n                Generated tracks will appear here. Use the form to create your first track.\n              </p>\n            </div>\n          ) : (\n            <div className=\"divide-y divide-white/5\">\n              {generatedTracks.map((track) => (\n                <div\n                  key={track._id}\n                  className={cn(\n                    'px-4 py-3 flex items-start gap-3 transition-colors',\n                    `hover:${colors.cardHover}`\n                  )}\n                >\n                  {/* Play button */}\n                  <button\n                    onClick={() => handlePlayTrack(track)}\n                    className={cn(\n                      'flex-shrink-0 w-9 h-9 rounded-lg flex items-center justify-center transition-colors touch-manipulation',\n                      'focus:outline-none focus:ring-2 focus:ring-purple-500',\n                      playingTrackId === track._id\n                        ? 'bg-purple-600 text-white'\n                        : `${colors.bgTertiary} ${colors.textMuted} hover:text-purple-400`\n                    )}\n                    aria-label={playingTrackId === track._id ? 'Pause' : 'Play'}\n                  >\n                    {playingTrackId === track._id ? (\n                      <Pause className=\"w-4 h-4\" />\n                    ) : (\n                      <Play className=\"w-4 h-4 ml-0.5\" />\n                    )}\n                  </button>\n\n                  {/* Track info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <p className={`text-xs font-medium ${colors.text} truncate`}>{track.title}</p>\n                    <p className={`text-[10px] ${colors.textFaint} truncate mt-0.5`}>{track.prompt.slice(0, 60)}</p>\n                    <div className={`flex items-center gap-2 mt-1 text-[10px] ${colors.textFaint} tabular-nums`}>\n                      <span className=\"flex items-center gap-0.5\">\n                        <Clock className=\"w-3 h-3\" />\n                        {formatDuration(track.duration)}\n                      </span>\n                      <span>{track.bpm} BPM</span>\n                      <span>{track.key}</span>\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex flex-col gap-1 flex-shrink-0\">\n                    {onAddToArrange && (\n                      <button\n                        onClick={() => handleAddToArrange(track)}\n                        className={cn(\n                          'p-1.5 rounded-md transition-colors touch-manipulation',\n                          'focus:outline-none focus:ring-2 focus:ring-cyan-500',\n                          `${colors.textFaint} hover:text-cyan-400 hover:${colors.cardHover}`\n                        )}\n                        aria-label=\"Add to arrange view\"\n                        title=\"Add to Arrange\"\n                      >\n                        <Plus className=\"w-3.5 h-3.5\" />\n                      </button>\n                    )}\n                    <button\n                      onClick={() => handleRemoveTrack(track._id)}\n                      className={cn(\n                        'p-1.5 rounded-md transition-colors touch-manipulation',\n                        'focus:outline-none focus:ring-2 focus:ring-red-500',\n                        `${colors.textFaint} hover:text-red-400 hover:${colors.cardHover}`\n                      )}\n                      aria-label=\"Remove track\"\n                      title=\"Remove\"\n                    >\n                      <Trash2 className=\"w-3.5 h-3.5\" />\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * useMusicGeneration Hook\n *\n * Provides music generation capabilities via local ACE-Step through Lynkr tunnel.\n * Handles generation, analysis, and stem separation with progress tracking.\n * Persists jobs and tracks to Convex for history and library features.\n */\n\nimport { useState, useCallback, useRef } from 'react';\nimport { useMutation } from '@/lib/openclaw/hooks';\nimport { api } from '@/lib/convex-shim';\nimport { Id } from '../../convex/_generated/dataModel';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface MusicGenerateParams {\n  prompt: string;\n  lyrics?: string;\n  duration?: number; // 10-600 seconds\n  bpm?: number; // 30-300\n  key?: string; // e.g., \"C major\", \"A minor\"\n  timeSignature?: string; // e.g., \"4/4\", \"3/4\", \"6/8\"\n  referenceAudio?: string; // URL to reference audio (style transfer)\n  referenceStrength?: number; // 0-1 (lower = lighter style transfer)\n  model?: string;\n  lmModel?: string;\n  format?: 'mp3' | 'wav' | 'flac';\n  title?: string;\n  saveToJamz?: boolean;\n  projectId?: string;\n  // Full ACE-Step 1.5 parameter support\n  vocalLanguage?: string; // ISO: en, zh, ja, ko, es, fr, de, it, pt, ru\n  thinking?: boolean; // Use 5Hz LM for enhanced quality\n  sampleMode?: boolean; // Auto-generate caption/lyrics via LM\n  sampleQuery?: string; // Description for sample mode\n  useFormat?: boolean; // LM-enhanced caption formatting\n  inferenceSteps?: number; // 1-200 (8 for turbo, 32-64 for base)\n  guidanceScale?: number; // Prompt guidance coefficient\n  seed?: number; // -1 for random\n  batchSize?: number; // 1-8\n  taskType?: 'text2music' | 'cover' | 'repaint' | 'lego' | 'extract' | 'complete';\n  srcAudio?: string; // Source audio for cover/repaint\n  instruction?: string; // Edit instruction\n  repaintingStart?: number; // Start time for repaint (seconds)\n  repaintingEnd?: number; // End time for repaint (seconds)\n}\n\nexport interface MusicGenerateResult {\n  id: string;\n  status: 'completed' | 'processing' | 'failed';\n  audioUrl?: string;\n  audioBase64?: string;\n  duration: number;\n  metadata: {\n    bpm: number;\n    key: string;\n    timeSignature: string;\n    model: string;\n    lmModel?: string;\n    vocalLanguage?: string;\n  };\n  provider: string;\n  title?: string;\n}\n\nexport interface AudioAnalysisResult {\n  bpm?: number;\n  key?: string;\n  timeSignature?: string;\n  caption?: string;\n  lyrics?: {\n    text: string;\n    timestamps?: { start: number; end: number; text: string }[];\n  };\n  provider: string;\n}\n\nexport interface StemSeparationResult {\n  stems: Record<string, string>; // stem name -> audio URL\n  provider: string;\n}\n\nexport type MusicGenerationStatus =\n  | 'idle'\n  | 'generating'\n  | 'analyzing'\n  | 'separating'\n  | 'completed'\n  | 'error';\n\nexport interface MusicGenerationState {\n  status: MusicGenerationStatus;\n  progress: number; // 0-100\n  message: string;\n  result: MusicGenerateResult | null;\n  error: string | null;\n}\n\n// ============================================================================\n// Hook\n// ============================================================================\n\nexport function useMusicGeneration() {\n  const [state, setState] = useState<MusicGenerationState>({\n    status: 'idle',\n    progress: 0,\n    message: '',\n    result: null,\n    error: null,\n  });\n\n  const abortControllerRef = useRef<AbortController | null>(null);\n  const currentJobIdRef = useRef<Id<\"musicGenerationJobs\"> | null>(null);\n\n  // Convex mutations for job persistence\n  const createJob = useMutation(api.musicGeneration.createJob);\n  const startJob = useMutation(api.musicGeneration.startJob);\n  const completeJob = useMutation(api.musicGeneration.completeJob);\n  const failJob = useMutation(api.musicGeneration.failJob);\n\n  /**\n   * Check if ACE-Step is available\n   */\n  const checkAvailability = useCallback(async (): Promise<{\n    available: boolean;\n    reason?: string;\n    models?: string[];\n  }> => {\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'GET',\n      });\n\n      return await response.json();\n    } catch {\n      return { available: false, reason: 'Connection failed' };\n    }\n  }, []);\n\n  /**\n   * Generate music from prompt and optional lyrics\n   * Now persists jobs to Convex for history and library features\n   */\n  const generate = useCallback(async (params: MusicGenerateParams): Promise<MusicGenerateResult | null> => {\n    // Cancel any in-progress generation\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n\n    abortControllerRef.current = new AbortController();\n\n    setState({\n      status: 'generating',\n      progress: 0,\n      message: 'Starting music generation...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      // Create job in Convex for tracking and history\n      let jobId: Id<\"musicGenerationJobs\"> | null = null;\n      try {\n        jobId = await createJob({\n          prompt: params.prompt,\n          lyrics: params.lyrics,\n          duration: params.duration || 30,\n          bpm: params.bpm,\n          key: params.key,\n          timeSignature: params.timeSignature,\n          title: params.title,\n        });\n        currentJobIdRef.current = jobId;\n\n        // Mark as processing\n        await startJob({ jobId });\n      } catch (convexError) {\n        // If not authenticated, continue without Convex persistence\n        console.warn('[useMusicGeneration] Convex job creation failed (user may not be authenticated):', convexError);\n      }\n\n      // Simulate progress updates (ACE-Step doesn't stream progress)\n      const progressInterval = setInterval(() => {\n        setState(prev => {\n          if (prev.status !== 'generating') return prev;\n          const newProgress = Math.min(prev.progress + Math.random() * 15, 90);\n          return {\n            ...prev,\n            progress: newProgress,\n            message: getProgressMessage(newProgress),\n          };\n        });\n      }, 2000);\n\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ ...params, action: 'generate' }),\n        signal: abortControllerRef.current.signal,\n      });\n\n      clearInterval(progressInterval);\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Generation failed');\n      }\n\n      const result: MusicGenerateResult = await response.json();\n\n      // Complete the job in Convex with results\n      if (jobId && result.audioUrl) {\n        try {\n          await completeJob({\n            jobId,\n            audioUrl: result.audioUrl,\n            metadata: {\n              actualBpm: result.metadata.bpm,\n              actualKey: result.metadata.key,\n              actualDuration: result.duration,\n              model: result.metadata.model,\n              lmModel: result.metadata.lmModel,\n            },\n          });\n        } catch (convexError) {\n          console.warn('[useMusicGeneration] Convex job completion failed:', convexError);\n        }\n      }\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Music generated successfully!',\n        result,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        setState(prev => ({\n          ...prev,\n          status: 'idle',\n          progress: 0,\n          message: 'Generation cancelled',\n        }));\n        return null;\n      }\n\n      const errorMessage = error instanceof Error ? error.message : 'Generation failed';\n\n      // Mark job as failed in Convex\n      if (currentJobIdRef.current) {\n        try {\n          await failJob({\n            jobId: currentJobIdRef.current,\n            error: errorMessage,\n          });\n        } catch (convexError) {\n          console.warn('[useMusicGeneration] Convex job failure recording failed:', convexError);\n        }\n      }\n\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, [createJob, startJob, completeJob, failJob]);\n\n  /**\n   * Analyze audio to extract BPM, key, etc.\n   */\n  const analyze = useCallback(async (\n    audioUrl: string,\n    extract?: ('bpm' | 'key' | 'time_signature' | 'caption' | 'lyrics')[]\n  ): Promise<AudioAnalysisResult | null> => {\n    setState({\n      status: 'analyzing',\n      progress: 50,\n      message: 'Analyzing audio...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'analyze',\n          audioUrl,\n          extract: extract || ['bpm', 'key', 'time_signature', 'caption'],\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Analysis failed');\n      }\n\n      const result: AudioAnalysisResult = await response.json();\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Analysis complete!',\n        result: null,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Analysis failed';\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, []);\n\n  /**\n   * Separate audio into stems (vocals, drums, bass, other)\n   */\n  const separateStems = useCallback(async (\n    audioUrl: string,\n    stems?: ('vocals' | 'drums' | 'bass' | 'other' | 'piano' | 'guitar')[]\n  ): Promise<StemSeparationResult | null> => {\n    setState({\n      status: 'separating',\n      progress: 30,\n      message: 'Separating stems...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'separate',\n          audioUrl,\n          stems: stems || ['vocals', 'drums', 'bass', 'other'],\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Stem separation failed');\n      }\n\n      const result: StemSeparationResult = await response.json();\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Stems separated!',\n        result: null,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Stem separation failed';\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, []);\n\n  /**\n   * Cancel in-progress generation\n   */\n  const cancel = useCallback(() => {\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n      abortControllerRef.current = null;\n    }\n  }, []);\n\n  /**\n   * Reset state\n   */\n  const reset = useCallback(() => {\n    cancel();\n    setState({\n      status: 'idle',\n      progress: 0,\n      message: '',\n      result: null,\n      error: null,\n    });\n  }, [cancel]);\n\n  return {\n    // State\n    ...state,\n    isGenerating: state.status === 'generating',\n    isAnalyzing: state.status === 'analyzing',\n    isSeparating: state.status === 'separating',\n    isProcessing: ['generating', 'analyzing', 'separating'].includes(state.status),\n\n    // Actions\n    generate,\n    analyze,\n    separateStems,\n    checkAvailability,\n    cancel,\n    reset,\n  };\n}\n\n// ============================================================================\n// Helpers\n// ============================================================================\n\nfunction getProgressMessage(progress: number): string {\n  if (progress < 20) return 'Initializing models...';\n  if (progress < 40) return 'Processing prompt...';\n  if (progress < 60) return 'Generating audio...';\n  if (progress < 80) return 'Applying effects...';\n  return 'Finalizing...';\n}\n\n// ============================================================================\n// Presets\n// ============================================================================\n\nexport const MUSIC_PRESETS = {\n  podcastIntro: {\n    prompt: 'upbeat professional podcast intro, modern electronic, clean production',\n    duration: 15,\n    bpm: 120,\n    key: 'C major',\n  },\n  lofi: {\n    prompt: 'lo-fi hip hop study beats, vinyl crackle, mellow piano, soft drums, rainy day mood',\n    duration: 120,\n    bpm: 85,\n    key: 'F major',\n  },\n  epicTrailer: {\n    prompt: 'cinematic orchestral trailer music, building tension, brass swells, timpani, heroic',\n    duration: 60,\n    bpm: 90,\n    key: 'D minor',\n  },\n  ambient: {\n    prompt: 'peaceful ambient soundscape, soft pads, nature sounds, meditation music',\n    duration: 180,\n    bpm: 60,\n    key: 'A minor',\n  },\n  edm: {\n    prompt: 'high energy EDM, festival drop, punchy kick, saw wave lead, side-chain compression',\n    duration: 180,\n    bpm: 128,\n    key: 'F minor',\n  },\n  acoustic: {\n    prompt: 'warm acoustic folk, fingerpicked guitar, soft vocals, campfire vibes',\n    duration: 120,\n    bpm: 100,\n    key: 'G major',\n  },\n} as const;\n\nexport type MusicPreset = keyof typeof MUSIC_PRESETS;\n"],"names":[],"mappings":"wEAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,0BAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,4CAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,4CAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAoDA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QCUO,IAAM,EAAe,CAC1B,gBACA,cACA,cACA,eACA,iBACA,cACA,cACA,gBACA,gBACA,cACD,CAEY,EAA6C,CACxD,gBAAiB,UACjB,cAAe,UACf,cAAe,UACf,eAAgB,UAChB,iBAAkB,UAClB,cAAe,UACf,cAAe,UACf,gBAAiB,UACjB,gBAAiB,UACjB,cAAe,SACjB,EAEO,SAAS,IACd,MAAO,CAAA,EAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,EAAG,GAAA,CAAI,AAClE,CAEO,SAAS,EAAmB,EAAe,kBAAkB,EAClE,MAAO,CACL,GAAI,SACJ,EACA,IAAK,IACL,cAAe,CAAC,EAAG,EAAE,CACrB,UAAW,KAAK,GAAG,GACnB,UAAW,KAAK,GAAG,GACnB,OAAQ,EAAE,CACV,UAAW,EACX,QAAS,GACT,aAAa,CACf,CACF,CAEO,SAAS,EACd,CAAY,CACZ,EAAyB,OAAO,CAChC,CAAmB,EAEnB,IAAM,EAAQ,CAAY,CAAC,GAAc,KAAK,KAAK,CAAC,KAAK,MAAM,GAAK,EAAa,MAAM,EAAE,CACzF,MAAO,CACL,GAAI,SACJ,OACA,QACA,EACA,OAAQ,GACR,IAAK,EACL,MAAM,EACN,MAAM,EACN,MAAO,GACP,MAAO,EAAE,AACX,CACF,CAEO,SAAS,EACd,CAAY,CACZ,CAAiB,CACjB,CAAmB,CACnB,CAAiB,EAEjB,MAAO,CACL,GAAI,SACJ,YACA,cACA,WACA,EACA,KAAM,CACR,CACF,CC2bA,SAAS,EAAiB,CAAmB,EAC3C,IAAM,EAAc,EAAO,gBAAgB,CACrC,EAAa,EAAO,UAAU,CAK9B,EADiB,AACJ,IAEb,EAAW,EAAO,GAHU,GAGJ,AAFG,CAEA,EAE3B,EADa,AACD,GAAa,EAEzB,EAAc,IAAI,YAAY,GAC9B,EAAO,IAAI,SAAS,GAG1B,EAAY,EAAM,EAAG,QACrB,EAAK,SAAS,CAAC,EAAG,EAAY,GAAG,GACjC,EAAY,EAAM,EAAG,QAGrB,EAAY,EAAM,GAAI,QACtB,EAAK,SAAS,CAAC,GAAI,IAAI,GACvB,EAAK,EADyB,OAChB,CAAC,GArBA,CAqBI,CADwB,CAChB,AArBT,GAsBlB,EAAK,CAtBmB,QAsBV,CAAC,GAAI,GAAa,GAChC,EAAK,SAAS,CAAC,GAAI,GAAY,GAC/B,EAAK,SAAS,CAAC,GAnBE,CAmBE,CAnBW,GAmBD,GAC7B,EAAK,SAAS,CAAC,GAAI,GAAY,GAC/B,EAAK,SAAS,CAAC,GAzBE,CAyBE,EAAU,IAG7B,EAAY,EAAM,GAAI,QACtB,EAAK,SAAS,CAAC,GAAI,GAAU,GAG7B,IAAM,EAA2B,EAAE,CACnC,IAAK,IAAI,EAAI,EAAG,EAAI,EAAa,IAAK,AACpC,EAAS,IAAI,CAAC,EAAO,cAAc,CAAC,IAGtC,IAAI,EAAS,GACb,IAAK,IAAI,EAAI,EAAG,EAAI,EAAO,MAAM,CAAE,IAAK,AACtC,IAAK,IAAI,EAAK,EAAG,EAAK,EAAa,IAAM,CACvC,IAAM,EAAS,KAAK,GAAG,CAAC,CAAC,EAAG,KAAK,GAAG,CAAC,EAAG,CAAQ,CAAC,EAAG,CAAC,EAAE,GACjD,EAAY,EAAS,EAAa,MAAT,EAA2B,MAAT,EACjD,EAAK,QAAQ,CAAC,EAAQ,GAAW,GACjC,GAAU,CACZ,CAGF,OAAO,IAAI,KAAK,CAAC,EAAY,CAAE,CAAE,KAAM,WAAY,EACrD,CAEA,SAAS,EAAY,CAAc,CAAE,CAAc,CAAE,CAAW,EAC9D,IAAK,IAAI,EAAI,EAAG,EAAI,EAAI,MAAM,CAAE,IAAK,AACnC,EAAK,QAAQ,CAAC,EAAS,EAAG,EAAI,UAAU,CAAC,GAE7C,CErnBA,IAAI,GAAwC,KAE5C,eAAe,KAIb,OAHI,AAAC,KACH,GAAgB,EAAA,CAAA,CAAA,GADE,KACe,IAAI,CAAC,AAAC,GAAM,EAAE,OAAO,EAAI,EAAA,EAErD,EACT,CAKO,eAAe,GACpB,CAAwB,CACxB,EAA6B,CAAC,CAAC,EAE/B,GAAM,CACJ,aAAa,EAAY,UAAU,SACnC,EAAU,GAAG,UACb,EAAW,EAAY,gBAAgB,CACxC,CAAG,EAKE,EAAa,GAAI,CAHR,MAAM,IAAA,EAGS,UAAU,CACtC,KAAK,GAAG,CAAC,EAAU,GACnB,EACA,GAGI,EAAuB,EAAE,CAIzB,EAAc,EAAY,cAAc,CAAC,GACzC,EAAe,EAAW,EAAI,EAAY,cAAc,CAAC,GAAK,EAG9D,EAAc,GAAgB,GAC9B,EAAe,GAAgB,GAG/B,EAAY,KAAK,IAAI,CAAC,EAAY,MAAM,GAAG,IAEjD,IAAK,IAAI,EAAI,EAAG,EAAI,EAAW,IAAK,CAClC,IAAM,EAdU,KAcF,CAdQ,CAehB,EAAM,AADM,KACD,GAAG,CAAC,KAfkB,EAeC,CAAX,CAAuB,MAAM,EAEpD,EAAY,EAAY,QAAQ,CAAC,EAAO,GACxC,EAAa,EAAa,QAAQ,CAAC,EAAO,GAE1C,EAAS,EAAW,YAAY,CAAC,EAAW,EAC9C,GAAO,MAAM,CAAG,GAAG,AACrB,EAAQ,IAAI,CAAC,EAEjB,CAGA,IAAM,EAAc,EAAW,KAAK,GAChC,EAAY,MAAM,CAAG,GAAG,AAC1B,EAAQ,IAAI,CAAC,GAKf,IAAM,EAAS,IAAI,WADC,AACU,EADF,MAAM,CAAC,CAAC,EAAK,IAAQ,EAAM,EAAI,MAAM,CAAE,IAE/D,EAAS,EAEb,IAAK,IAAM,KAAS,EAClB,EAAO,GAAG,CADiB,AAChB,IAAI,WAAW,EAAM,MAAM,CAAE,EAAM,UAAU,CAAE,EAAM,MAAM,EAAG,GACzE,GAAU,EAAM,MAAM,CAGxB,OAAO,IAAI,KAAK,CAAC,EAAO,CAAE,CAAE,KAAM,WAAY,EAChD,CAKA,SAAS,GAAgB,CAA0B,EACjD,IAAM,EAAa,IAAI,WAAW,EAAa,MAAM,EAErD,IAAK,IAAI,EAAI,EAAG,EAAI,EAAa,MAAM,CAAE,IAAK,CAE5C,IAAM,EAAI,KAAK,GAAG,CAAC,CAAC,EAAG,KAAK,GAAG,CAAC,EAAG,CAAY,CAAC,EAAE,GAElD,CAAU,CAAC,EAAE,CAAG,EAAI,EAAQ,MAAJ,EAAiB,MAAJ,CACvC,CAEA,OAAO,CACT,CCpF0B,QAAQ,GAAG,CAAC,6BAA6B,CCZnE,GDYuE,CCZvE,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,OAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAAA,GAAA,EAAA,CAAA,CAAA,QAmBA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QACA,GAAA,EAAA,CAAA,CAAA,QC0ZO,IAAM,GAAgB,CAC3B,aAAc,CACZ,OAAQ,yEACR,SAAU,GACV,IAAK,IACL,IAAK,SACP,EACA,KAAM,CACJ,OAAQ,qFACR,SAAU,IACV,IAAK,GACL,IAAK,SACP,EACA,YAAa,CACX,OAAQ,sFACR,SAAU,GACV,IAAK,GACL,IAAK,SACP,EACA,QAAS,CACP,OAAQ,0EACR,SAAU,IACV,IAAK,GACL,IAAK,SACP,EACA,IAAK,CACH,OAAQ,qFACR,SAAU,IACV,IAAK,IACL,IAAK,SACP,EACA,SAAU,CACR,OAAQ,uEACR,SAAU,IACV,IAAK,IACL,IAAK,SACP,CACF,ED3ZM,GAAc,CAClB,UAAW,UAAW,WAAY,WAClC,UAAW,UAAW,WAAY,WAClC,UAAW,UACX,UAAW,UAAW,WAAY,WAClC,UAAW,UAAW,WAAY,WAClC,UAAW,UAAW,WAAY,WAClC,UAAW,UAAW,WAAY,WACnC,CAEK,GAAkB,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAM,CAE5D,GAAkB,CACtB,CAAE,KAAM,KAAM,MAAO,SAAU,EAC/B,CAAE,KAAM,KAAM,MAAO,SAAU,EAC/B,CAAE,KAAM,KAAM,MAAO,UAAW,EAChC,CAAE,KAAM,KAAM,MAAO,QAAS,EAC9B,CAAE,KAAM,KAAM,MAAO,SAAU,EAC/B,CAAE,KAAM,KAAM,MAAO,QAAS,EAC9B,CAAE,KAAM,KAAM,MAAO,QAAS,EAC9B,CAAE,KAAM,KAAM,MAAO,SAAU,EAC/B,CAAE,KAAM,KAAM,MAAO,YAAa,EAClC,CAAE,KAAM,KAAM,MAAO,SAAU,EAC/B,CAAE,KAAM,KAAM,MAAO,OAAQ,EAC7B,CAAE,KAAM,KAAM,MAAO,QAAS,EAC9B,CAAE,KAAM,KAAM,MAAO,MAAO,EAC5B,CAAE,KAAM,KAAM,MAAO,YAAa,EAClC,CAAE,KAAM,KAAM,MAAO,OAAQ,EAC7B,CAAE,KAAM,KAAM,MAAO,SAAU,EAChC,CAEK,GAAiB,CAAC,MAAO,MAAO,OAAO,CAEvC,GAAa,CACjB,CAAE,MAAO,aAAc,MAAO,eAAgB,EAC9C,CAAE,MAAO,QAAS,MAAO,wBAAyB,EAClD,CAAE,MAAO,UAAW,MAAO,wBAAyB,EACrD,CAMM,SAAS,GAAa,gBAAE,CAAc,WAAE,CAAS,QAAE,CAAM,CAAqB,EACnF,IAAM,EAAgB,CAAA,EAAA,EAAA,gBAAA,AAAgB,IAGhC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/B,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/B,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACvC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnC,CAAC,EAAK,EAAO,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GAC7C,CAAC,EAAK,EAAO,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GAC7C,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,OAC7C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,IACjE,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAyB,OACvD,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,MAG7C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GACnE,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrD,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrD,EAAc,CAAA,EAAA,EAAA,MAAA,AAAM,EAAmB,MAGvC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC3C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GACnE,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GACjE,CAAC,EAAM,GAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,OAAqB,GAC/C,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACrC,CAAC,GAAU,GAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,cAG3C,UACJ,EAAQ,cACR,EAAY,UACZ,EAAQ,CACR,UAAO,OACP,EAAK,CACL,SAAM,CACN,QAAK,CACN,CAAG,ACpDC,SAAS,EACd,GAAM,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAuB,CACvD,OAAQ,OACR,SAAU,EACV,QAAS,GACT,OAAQ,KACR,MAAO,IACT,GAEM,EAAqB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAyB,MACpD,EAAkB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAmC,MAG3D,EAAY,CAAA,EAAA,GAAA,WAAA,AAAW,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,SAAS,EACrD,EAAW,CAAA,EAAA,GAAA,WAAA,AAAW,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,QAAQ,EACnD,EAAc,CAAA,EAAA,GAAA,WAAA,AAAW,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,WAAW,EACzD,EAAU,CAAA,EAAA,GAAA,WAAA,AAAW,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,OAAO,EAKjD,EAAoB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAKpC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,sBAAuB,CAClD,OAAQ,KACV,GAEA,OAAO,MAAM,EAAS,IAAI,EAC5B,CAAE,KAAM,CACN,MAAO,CAAE,WAAW,EAAO,OAAQ,mBAAoB,CACzD,CACF,EAAG,EAAE,EAMC,EAAW,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAE9B,EAAmB,OAAO,EAAE,AAC9B,EAAmB,OAAO,CAAC,KAAK,GAGlC,EAAmB,OAAO,CAAG,IAAI,gBAEjC,EAAS,CACP,OAAQ,aACR,SAAU,EACV,QAAS,+BACT,OAAQ,KACR,MAAO,IACT,GAEA,GAAI,CAEF,IAAI,EAA0C,KAC9C,GAAI,CAUF,EAAgB,OAAO,CATvB,EAS0B,AATlB,MAAM,EAAU,CACtB,OAAQ,EAAO,MAAM,CACrB,OAAQ,EAAO,MAAM,CACrB,SAAU,EAAO,QAAQ,EAAI,GAC7B,IAAK,EAAO,GAAG,CACf,IAAK,EAAO,GAAG,CACf,cAAe,EAAO,aAAa,CACnC,MAAO,EAAO,KAAK,AACrB,GAIA,MAAM,EAAS,OAAE,CAAM,EACzB,CAAE,MAAO,EAAa,CAEpB,QAAQ,IAAI,CAAC,mFAAoF,EACnG,CAGA,IAAM,EAAmB,YAAY,KACnC,EAAS,UACP,GAAoB,eAAhB,EAAK,MAAM,CAAmB,OAAO,EACzC,IAAM,EAAc,KAAK,GAAG,CAAC,EAAK,QAAQ,CAAmB,GAAhB,KAAK,MAAM,GAAS,IACjE,MAAO,CACL,GAAG,CAAI,CACP,SAAU,EACV,QAqPV,AAAI,CADsB,AApPP,EAAmB,GAqPvB,GAAW,AADgB,CACvB,wBACf,EAAW,GAAW,CAAP,sBACf,EAAW,GAAW,CAAP,qBACf,EAAW,GAAW,CAAP,qBACZ,eAxPC,CACF,EACF,EAAG,KAEG,EAAW,MAAM,MAAM,sBAAuB,CAClD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CAAE,GAAG,CAAM,CAAE,OAAQ,UAAW,GACrD,OAAQ,EAAmB,OAAO,CAAC,MAAM,AAC3C,GAIA,GAFA,cAAc,GAEV,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,oBACjC,CAEA,IAAM,EAA8B,MAAM,EAAS,IAAI,GAGvD,GAAI,GAAS,EAAO,QAAQ,CAC1B,CAD4B,EACxB,CACF,MAAM,EAAY,OAChB,EACA,SAAU,EAAO,QAAQ,CACzB,SAAU,CACR,UAAW,EAAO,QAAQ,CAAC,GAAG,CAC9B,UAAW,EAAO,QAAQ,CAAC,GAAG,CAC9B,eAAgB,EAAO,QAAQ,CAC/B,MAAO,EAAO,QAAQ,CAAC,KAAK,CAC5B,QAAS,EAAO,QAAQ,CAAC,OAC3B,AADkC,CAEpC,EACF,CAAE,MAAO,EAAa,CACpB,QAAQ,IAAI,CAAC,qDAAsD,EACrE,CAWF,OARA,EAAS,CACP,OAAQ,YACR,SAAU,IACV,QAAS,uCACT,EACA,MAAO,IACT,GAEO,CACT,CAAE,MAAO,EAAO,CACd,GAAI,aAAiB,OAAwB,AAAf,cAA6B,GAAvB,IAAI,CAOtC,OANA,EAAS,IAAS,CAChB,EADe,CACZ,CAAI,CACP,OAAQ,OACR,SAAU,EACV,QAAS,uBACX,CAAC,EACM,KAGT,IAAM,EAAe,aAAiB,MAAQ,EAAM,OAAO,CAAG,oBAG9D,GAAI,EAAgB,OAAO,CACzB,CAD2B,EACvB,CACF,MAAM,EAAQ,CACZ,MAAO,EAAgB,OAAO,CAC9B,MAAO,CACT,EACF,CAAE,MAAO,EAAa,CACpB,QAAQ,IAAI,CAAC,4DAA6D,EAC5E,CAWF,OARA,EAAS,CACP,OAAQ,QACR,SAAU,EACV,QAAS,EACT,OAAQ,KACR,MAAO,CACT,GAEO,IACT,CACF,EAAG,CAAC,EAAW,EAAU,EAAa,EAAQ,EAKxC,EAAU,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAC1B,EACA,KAEA,EAAS,CACP,OAAQ,YACR,SAAU,GACV,QAAS,qBACT,OAAQ,KACR,MAAO,IACT,GAEA,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,sBAAuB,CAClD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CACnB,OAAQ,mBACR,EACA,QAAS,GAAW,CAAC,MAAO,MAAO,iBAAkB,UAAU,AACjE,EACF,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAM,AAAI,MAAM,EAAM,KAAK,EAAI,kBACjC,CAEA,IAAM,EAA8B,MAAM,EAAS,IAAI,GAUvD,OARA,EAAS,CACP,OAAQ,YACR,SAAU,IACV,QAAS,qBACT,OAAQ,KACR,MAAO,IACT,GAEO,CACT,CAAE,MAAO,EAAO,CACd,IAAM,EAAe,aAAiB,MAAQ,EAAM,OAAO,CAAG,kBAS9D,OARA,EAAS,CACP,OAAQ,QACR,SAAU,EACV,QAAS,EACT,OAAQ,KACR,MAAO,CACT,GAEO,IACT,CACF,EAAG,EAAE,EAKC,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAChC,EACA,KAEA,EAAS,CACP,OAAQ,aACR,SAAU,GACV,QAAS,sBACT,OAAQ,KACR,MAAO,IACT,GAEA,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,sBAAuB,CAClD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CACnB,OAAQ,oBACR,EACA,MAAO,GAAS,CAAC,SAAU,QAAS,OAAQ,QAAQ,AACtD,EACF,GAEA,GAAI,CAAC,EAAS,EAAE,CAAE,CAChB,IAAM,EAAQ,MAAM,EAAS,IAAI,EACjC,OAAU,AAAJ,MAAU,EAAM,KAAK,EAAI,yBACjC,CAEA,IAAM,EAA+B,MAAM,EAAS,IAAI,GAUxD,OARA,EAAS,CACP,OAAQ,YACR,SAAU,IACV,QAAS,mBACT,OAAQ,KACR,MAAO,IACT,GAEO,CACT,CAAE,MAAO,EAAO,CACd,IAAM,EAAe,aAAiB,MAAQ,EAAM,OAAO,CAAG,yBAS9D,OARA,EAAS,CACP,OAAQ,QACR,SAAU,EACV,QAAS,EACT,OAAQ,KACR,MAAO,CACT,GAEO,IACT,CACF,EAAG,EAAE,EAKC,EAAS,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACrB,EAAmB,OAAO,EAAE,CAC9B,EAAmB,OAAO,CAAC,KAAK,GAChC,EAAmB,OAAO,CAAG,KAEjC,EAAG,EAAE,EAKC,EAAQ,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,KACxB,IACA,EAAS,CACP,OAAQ,OACR,SAAU,EACV,QAAS,GACT,OAAQ,KACR,MAAO,IACT,EACF,EAAG,CAAC,EAAO,EAEX,MAAO,CAEL,GAAG,CAAK,CACR,aAA+B,eAAjB,EAAM,MAAM,CAC1B,YAA8B,cAAjB,EAAM,MAAM,CACzB,aAA+B,eAAjB,EAAM,MAAM,CAC1B,aAAc,CAAC,aAAc,YAAa,aAAa,CAAC,QAAQ,CAAC,EAAM,MAAM,WAG7E,UACA,EACA,kCACA,SACA,QACA,CACF,CACF,ID3QQ,GAAkB,GAAa,mBAAmB,IAAI,CAAC,GACvD,GAAe,CAAA,EAAA,GAAA,QAAA,AAAQ,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,kBAAkB,CAAE,CACpE,UAAW,GAAmB,OAAmC,EACjE,MAAO,EACT,GACM,GAAsB,CAAA,EAAA,GAAA,WAAA,AAAW,EAAC,GAAA,GAAG,CAAC,eAAe,CAAC,WAAW,EAGjE,GAAwC,CAAC,IAAgB,EAAA,AAAE,EAAE,GAAG,CAAC,IAAU,CAC/E,GAD8E,CACzE,EAAM,GAAG,CACd,MAAO,EAAM,KAAK,CAClB,OAAQ,EAAM,MAAM,CACpB,SAAU,EAAM,QAAQ,CACxB,SAAU,EAAM,QAAQ,CACxB,IAAK,EAAM,GAAG,CACd,IAAK,EAAM,GAAG,CACd,cAAe,EAAM,aAAa,CAClC,UAAW,EAAM,SAAS,CAC5B,CAAC,EAEK,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA+B,MAC7E,GAAW,CAAA,EAAA,EAAA,MAAA,AAAM,EAA0B,MAC3C,QAAmC,IAAjB,GAMlB,GAAc,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IAC/B,IAAM,EAAS,EAAa,CAAC,EAAU,CACvC,EAAU,EAAO,MAAM,EACvB,EAAY,EAAO,QAAQ,EAC3B,EAAO,EAAO,GAAG,EACjB,EAAO,EAAO,GAAG,EACjB,EAAkB,EACpB,EAAG,EAAE,EAEC,GAAwB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IACzC,IAAM,EAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,AAChC,CAAK,GAAD,CACJ,EADW,AACU,EAAK,IAAI,EAG9B,EADY,IAAI,YACE,GADa,CAAC,IAElC,EAAG,EAAE,EAEC,GAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACjC,GAAI,CAAC,EAAO,IAAI,GAAI,OAEpB,IAAM,EAA8B,CAClC,OAAQ,EAAO,IAAI,GACnB,OAAQ,EAAO,IAAI,SAAM,WACzB,MACA,MACA,gBACA,EACA,MAAO,EAAM,IAAI,SAAM,SACvB,gBACA,EACA,iBACA,kBAAmB,EAAiB,OAAoB,WACxD,iBACA,gBACA,OACA,EACA,UAAW,GAAY,EAAI,GAAY,OACvC,SAAuB,eAAb,GAA4B,GAA8C,OACpF,YAAY,YACZ,CACF,CAEA,OAAM,GAAS,EACjB,EAAG,CAAC,EAAQ,EAAQ,EAAU,EAAK,EAAK,EAAe,EAAO,EAAQ,EAAe,EAAgB,EAAmB,EAAU,EAAgB,EAAe,EAAM,GAAW,GAAU,EAAW,GAAS,EAE1M,GAAkB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IACnC,GAAI,KAAmB,EAAM,GAAG,CAC9B,CADgC,EACvB,OAAO,EAAE,QAClB,GAAkB,UACb,CACD,GAAS,OAAO,EAAE,AACpB,GAAS,OAAO,CAAC,KAAK,GAExB,IAAM,EAAQ,IAAI,MAAM,EAAM,QAAQ,EACtC,EAAM,OAAO,CAAG,IAAM,GAAkB,MACxC,EAAM,IAAI,GACV,GAAS,OAAO,CAAG,EACnB,GAAkB,EAAM,GAAG,CAC7B,CACF,EAAG,CAAC,GAAe,EAEb,GAAqB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IACtC,IAAiB,CACf,SAAU,EAAM,QAAQ,CACxB,MAAO,EAAM,KAAK,CAClB,SAAU,EAAM,QAAQ,CACxB,IAAK,EAAM,GAAG,CACd,IAAK,EAAM,GAAG,AAChB,EACF,EAAG,CAAC,EAAe,EAEb,GAAoB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACvC,KAAmB,IACrB,GAAS,EADqB,KACd,EAAE,QAClB,GAAkB,OAEpB,GAAI,CACF,MAAM,GAAoB,SAAE,CAAQ,EACtC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,yCAA0C,EAC1D,CACF,EAAG,CAAC,GAAgB,GAAoB,EAElC,GAAiB,AAAC,GACtB,EAAI,GAAK,CAAA,EAAG,EAAE,CAAC,CAAC,CAAG,CAAA,EAAG,KAAK,KAAK,CAAC,EAAI,IAAI,EAAE,EAAE,EAAI,GAAG,CAAC,CAAC,CAIxD,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mEAIb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,2CAA2C,EAAE,EAAO,MAAM,CAAA,CAAE,UAC3E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,4BACpB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,CAAC,wBAAwB,EAAE,EAAO,IAAI,CAAA,CAAE,UAAE,0BAI3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,kBAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kCACX,OAAO,IAAI,CAAC,IAAiC,GAAG,CAAC,AAAC,GAClD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,QAAS,IAAM,GAAY,GAC3B,SAAU,GACV,UAAW,CAAA,EAAA,GAAA,EAAE,AAAF,EACT,qFACA,wDACA,IAAmB,EACf,2BACA,CAAA,EAAG,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,2BAA2B,CAAC,WAG5F,EAAU,MAAM,CAAC,GAAG,WAAW,GAAK,EAAU,KAAK,CAAC,GAAG,OAAO,CAAC,WAAY,QAXvE,SAkBb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,aAAa,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,wBAGlF,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,GAAG,aACH,YAAY,oEACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAU,EAAE,MAAM,CAAC,KAAK,EACzC,SAAU,GACV,KAAM,EACN,UAAW,CAAC,mBAAmB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,sFAAsF,EAAE,EAAO,IAAI,CAAC,aAAa,EAAE,EAAO,SAAS,CAAA,CAAE,MAK9M,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,WAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAc,CAAC,GAC9B,SAAU,GACV,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAC,wCAAwC,CAAC,UAE/E,EAAa,OAAS,kBAG3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,OAAQ,CAAE,EAClE,QAAS,CAAE,QAAS,EAAG,OAAQ,MAAO,EACtC,KAAM,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,OAAQ,CAAE,EAC/D,UAAU,sBAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,gCACjB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAChD,SAAU,GACV,UAAW,CAAC,kBAAkB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,YAAY,EAAE,EAAO,IAAI,CAAC,mCAAmC,CAAC,CAClI,aAAW,0BAEV,GAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAoB,MAAO,EAAE,IAAI,UAAG,EAAE,KAAK,EAA/B,EAAE,IAAI,QAIzB,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,YAAa,2FACb,MAAO,EACP,SAAW,AAAD,GAAO,EAAU,EAAE,MAAM,CAAC,KAAK,EACzC,SAAU,GACV,KAAM,EACN,UAAW,CAAC,mBAAmB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,gGAAgG,EAAE,EAAO,IAAI,CAAA,CAAE,WAQ9L,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,aAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,qBAAqB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAG,GAAe,QAE/E,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,MAAO,EACP,SAAW,AAAD,GAAO,EAAY,SAAS,EAAE,MAAM,CAAC,KAAK,GACpD,IAAK,GACL,IAAK,IACL,KAAM,EACN,SAAU,GACV,UAAU,2BACV,aAAW,aAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,iCAAiC,EAAE,EAAO,SAAS,CAAA,CAAE,WACpE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,QACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,gBAKV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,UAAU,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,QACnF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,GAAG,UACH,KAAK,SACL,YAAY,OACZ,MAAO,GAAO,GACd,SAAU,AAAC,GAAM,EAAO,EAAE,MAAM,CAAC,KAAK,CAAG,SAAS,EAAE,MAAM,CAAC,KAAK,OAAI,GACpE,IAAK,GACL,IAAK,IACL,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,MAG1J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,QACjE,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,GAAO,GACd,SAAU,AAAC,GAAM,EAAO,EAAE,MAAM,CAAC,KAAK,OAAI,GAC1C,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,CACtJ,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,SAChB,GAAY,GAAG,CAAE,AAAD,GACf,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAe,MAAO,WAAI,GAAd,UAInB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,aACjE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAChD,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,CACtJ,aAAW,0BAEV,GAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgB,MAAO,WAAK,GAAhB,SAInB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,WACjE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAW,AAAD,GAAO,EAAU,EAAE,MAAM,CAAC,KAAK,EACzC,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,CACtJ,aAAW,yBAEV,GAAe,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAe,MAAO,WAAI,EAAE,WAAW,IAA3B,YAOrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,qCAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,IAAK,EACL,KAAK,OACL,OAAO,UACP,SAAU,GACV,UAAU,UACV,aAAW,2BAEb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAY,OAAO,EAAE,QACpC,SAAU,GACV,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,yGACA,wDACA,CAAA,EAAG,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,2BAA2B,CAAC,YAGzF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,gBACjB,GAAqB,uBAEvB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,KAAQ,OAAkB,GAAY,EAAqB,GAAK,EACzE,UAAW,CAAC,cAAc,EAAE,EAAO,SAAS,CAAC,qCAAqC,CAAC,CACnF,aAAW,kCAEX,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,OAAO,CAAA,CAAC,UAAU,iBAIxB,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,YAAY,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,mBACpD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,CAAC,yBAAyB,EAAE,EAAO,SAAS,CAAA,CAAE,WAAG,KAAK,KAAK,CAAqB,IAApB,GAAyB,UAExG,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAqB,WAAW,EAAE,MAAM,CAAC,KAAK,GAC/D,IAAK,EACL,IAAK,EACL,KAAM,IACN,SAAU,GACV,UAAU,2BACV,aAAW,6BAOnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,YAAY,UAAW,CAAC,oBAAoB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,gBACjF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,GAAG,YACH,KAAK,OACL,YAAY,iBACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAS,EAAE,MAAM,CAAC,KAAK,EACxC,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,MAK1J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,OAAO,EAAE,EAAO,MAAM,CAAC,2BAA2B,CAAC,WAClE,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAgB,CAAC,GAChC,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,6HACA,yEACA,CAAA,EAAG,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAA,CAAE,EAE3D,gBAAe,YAEf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,SAAS,CAAA,CAAC,UAAU,gBAAgB,uBAGtC,EAAe,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,SAAS,CAAA,CAAC,UAAU,gBAAmB,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,UAAU,mBAEjF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,OAAQ,CAAE,EAClE,QAAS,CAAE,QAAS,EAAG,OAAQ,MAAO,EACtC,KAAM,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,OAAQ,CAAE,EAC/D,UAAW,CAAC,6BAA6B,EAAE,EAAO,MAAM,CAAA,CAAE,UAE1D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,cACjE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,GACP,SAAU,AAAC,GAAM,GAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,CACtJ,aAAW,qBAEV,GAAW,GAAG,CAAC,AAAC,GACf,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAqB,MAAO,EAAE,KAAK,UAAG,EAAE,KAAK,EAAjC,EAAE,KAAK,QAM1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,GAAG,eACH,QAAS,EACT,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,OAAO,EAC7C,SAAU,GACV,UAAU,sCAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,eAAe,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,uDAM1E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,UACjE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,YAAY,IACZ,MAAO,GAAkB,GACzB,SAAU,AAAC,GAAM,EAAkB,EAAE,MAAM,CAAC,KAAK,CAAG,SAAS,EAAE,MAAM,CAAC,KAAK,OAAI,GAC/E,IAAK,EACL,IAAK,IACL,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,MAK1J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,aACjE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,YAAY,MACZ,MAAO,GAAiB,GACxB,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,CAAG,WAAW,EAAE,MAAM,CAAC,KAAK,OAAI,GAChF,KAAM,GACN,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,MAK1J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,SACjE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,YAAY,SACZ,MAAO,GAAQ,GACf,SAAU,AAAC,GAAM,GAAQ,EAAE,MAAM,CAAC,KAAK,CAAG,SAAS,EAAE,MAAM,CAAC,KAAK,EAAI,QACrE,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,MAK1J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,YAAY,UAAW,CAAC,wBAAwB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,UACrF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,GAAG,YACH,KAAK,SACL,MAAO,GACP,SAAU,AAAC,GAAM,GAAa,KAAK,GAAG,CAAC,EAAG,KAAK,GAAG,CAAC,EAAG,SAAS,EAAE,MAAM,CAAC,KAAK,GAAK,KAClF,IAAK,EACL,IAAK,EACL,SAAU,GACV,UAAW,CAAC,iBAAiB,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,gDAAgD,CAAC,gBAUnK,IACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,kBAAkB,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,IAAI,CAAC,cAAc,CAAC,WAC/E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,yCACnB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAA,CAAE,UAAG,QAE1D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,MAAM,EAAE,EAAO,UAAU,CAAC,6BAA6B,CAAC,UACvE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,UAAU,oCACV,QAAS,CAAE,MAAO,CAAE,EACpB,QAAS,CAAE,MAAO,CAAA,EAAG,GAAS,CAAC,CAAC,AAAC,EACjC,WAAY,CAAE,SAAU,EAAI,SAOnC,IAAU,CAAC,IACV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gFACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,WAAW,CAAA,CAAC,UAAU,YACvB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,+BAAsB,8BAExC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,IAAK,GAAO,QAAQ,CAAE,QAAQ,CAAA,CAAA,EAAC,UAAU,kBAKnD,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iEACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,OAAO,CAAA,CAAC,UAAU,YACnB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAW,UAMjC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,GACT,SAAU,IAAgB,CAAC,EAAO,IAAI,GACtC,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,0IACA,4EACA,IAAgB,CAAC,EAAO,IAAI,GACxB,oDACA,6EAGL,GACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,yBAAyB,mBAI9C,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,YAAY,2BAWvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yEACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,qDAAqD,EAAE,EAAO,MAAM,CAAA,CAAE,WACrF,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,CAAC,sBAAsB,EAAE,EAAO,IAAI,CAAC,yBAAyB,CAAC,UAAE,qBAGhF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,YAAY,EAAE,EAAO,SAAS,CAAC,aAAa,CAAC,UAC5D,GAAkB,MAAQ,CAAA,EAAG,GAAgB,MAAM,CAAC,OAAO,CAAC,MAIjE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kCACZ,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,qBAAqB,EAAE,EAAO,IAAI,CAAC,sCAAsC,CAAC,UACzF,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,SAAS,CAAA,CAAC,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAC,aAAa,CAAC,KAElE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,8BAIlB,IAA3B,GAAgB,MAAM,CACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6EACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,qBAAqB,EAAE,EAAO,IAAI,CAAC,sCAAsC,CAAC,UACzF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAA,CAAE,KAEjD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAC,cAAc,CAAC,UAAE,mFAK7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mCACZ,GAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAA,EAAA,GAAA,EAAE,AAAF,EACT,qDACA,CAAC,MAAM,EAAE,EAAO,SAAS,CAAA,CAAE,YAI7B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,GAC/B,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,yGACA,wDACA,KAAmB,EAAM,GAAG,CACxB,2BACA,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,sBAAsB,CAAC,EAEtE,aAAY,KAAmB,EAAM,GAAG,CAAG,QAAU,gBAEpD,KAAmB,EAAM,GAAG,CAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,YAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,qBAKpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,oBAAoB,EAAE,EAAO,IAAI,CAAC,SAAS,CAAC,UAAG,EAAM,KAAK,GACzE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,YAAY,EAAE,EAAO,SAAS,CAAC,gBAAgB,CAAC,UAAG,EAAM,MAAM,CAAC,KAAK,CAAC,EAAG,MACxF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,yCAAyC,EAAE,EAAO,SAAS,CAAC,aAAa,CAAC,WACzF,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,sCACd,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,KAAK,CAAA,CAAC,UAAU,YAChB,GAAe,EAAM,QAAQ,KAEhC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,EAAM,GAAG,CAAC,UACjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAM,GAAG,SAKpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACZ,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAmB,GAClC,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,wDACA,sDACA,CAAA,EAAG,EAAO,SAAS,CAAC,2BAA2B,EAAE,EAAO,SAAS,CAAA,CAAE,EAErE,aAAW,sBACX,MAAM,0BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,kBAGpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAkB,EAAM,GAAG,EAC1C,UAAW,CAAA,EAAA,GAAA,EAAA,AAAE,EACX,wDACA,qDACA,CAAA,EAAG,EAAO,SAAS,CAAC,0BAA0B,EAAE,EAAO,SAAS,CAAA,CAAE,EAEpE,aAAW,eACX,MAAM,kBAEN,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,MAAM,CAAA,CAAC,UAAU,uBAjEjB,EAAM,GAAG,YA4EhC,CNruBA,IAAM,GAAgB,AAAC,IACrB,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAQvC,MAPA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAQ,OAAO,UAAU,CAAC,GAChC,EAAW,EAAM,OAAO,EACxB,IAAM,EAAY,AAAD,GAA4B,EAAW,EAAE,OAAO,EAEjE,OADA,EAAM,gBAAgB,CAAC,SAAU,GAC1B,IAAM,EAAM,mBAAmB,CAAC,SAAU,EACnD,EAAG,CAAC,EAAM,EACH,CACT,EAGM,GAAgB,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,SAAS,EAClC,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,gBACL,UAAU,wLACX,wBAIL,GA+BM,GAA+B,CACnC,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAa,CAAA,CAAC,UAAU,YAC/B,MAAO,wBACP,YAAa,yFACb,SAAU,2BACZ,EACA,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,YAC1B,MAAO,sBACP,YAAa,yFACb,SAAU,+BACZ,EACA,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,YAC1B,MAAO,kBACP,YAAa,uFACb,SAAU,8BACZ,EACD,CAGK,GAAgC,CACpC,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,YACzB,MAAO,oBACP,YAAa,wFACb,SAAU,0BACZ,EACA,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CAAC,UAAU,YACvB,MAAO,sBACP,YAAa,4EACb,SAAU,2BACZ,EACA,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,YACxB,MAAO,iBACP,YAAa,8EACb,SAAU,6BACZ,EACA,CACE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,YACrB,MAAO,0BACP,YAAa,4EACb,SAAU,8BACZ,EACD,AAGgB,KAAI,MAAsB,GAAmB,CAkD9D,IAAM,GAAqB,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,SAAS,AAAmB,CAC1D,QAAM,eACN,GAAgB,CAAK,CAItB,SAEC,AAAI,EAEA,CAAA,EAAA,EAAA,GAAA,EAAC,GAFc,GAEd,CACC,UAAU,oDACV,cAAY,gBAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,iBAAiB,EAAE,EAAS,qDAAuD,0DAAA,CAA2D,KAMnK,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,cAAY,gDADF,oDAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,WAAe,CAAC,sCAAiB,EAAE,EAAS,qDAAuD,0DAAA,CAA2D,GAC/J,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CACL,WAAY,sEACZ,IAAK,MACL,KAAM,KACR,2CALU,4IAOZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CACL,WAAY,wEACZ,OAAQ,MACR,MAAO,IACT,2CALU,8IAOZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CACL,gBAAiB,CAAC,gBAAgB,EAAE,EAAS,wBAA0B,kBAAkB,+CAA+C,EAAE,EAAS,wBAA0B,kBAAkB,sBAAsB,CAAC,CACtN,eAAgB,WAClB,YAJW,CAAC,sCAAiB,EAAE,EAAS,iBAAmB,iBAAA,CAAkB,ucAoBrF,GAEM,GAAqB,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,SAAS,AAAmB,eAC1D,GAAgB,CAAK,CAGtB,EAGC,IAAM,EADW,AACJ,GADkB,sBACP,GAAK,UAG7B,AAAI,EAEA,CAAA,EAAA,EAAA,GAAA,EAAC,GAFc,GAEd,CACC,UAAU,2CACV,KAAK,MACL,aAAW,wCAEV,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAK,GAAG,GAAG,CAAC,CAAC,EAAG,IACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,UAAU,8DACV,MAAO,CAAE,OAAQ,CAAA,EAAG,IAA0B,CAArB,EAAC,KAAK,GAAG,CAAK,GAAJ,GAAgB,EAAA,CAAE,CAAE,CAAC,CAAC,AAAC,GAFrD,MAUb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,KAAK,MACL,aAAW,iFAFD,8DAIT,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAK,GAAG,GAAG,CAAC,CAAC,EAAG,IACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAGC,MAAO,CACL,UAAW,CAAC,SAAS,EAAE,GAAO,EAAI,EAAK,GAAI,sBAAsB,CAAC,CAClE,eAAgB,CAAA,EAAO,IAAJ,EAAS,CAAC,CAAC,CAC9B,OAAQ,KACV,2CALU,oFADL,wIAiBf,GAEM,GAAc,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,SAAS,AAAY,SAC5C,CAAO,OACP,CAAK,QACL,CAAM,eACN,GAAgB,CAAK,CACrB,gBAAe,CAAK,CAOrB,EACC,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAErC,EAAe,EACjB,CAAE,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAAG,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,CAAE,EAC/D,CAAE,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAAG,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,WAAY,CAAE,SAAU,GAAK,MAAO,GAAc,GAAR,CAAY,CAAE,CAAE,EAE7H,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,OAAO,CAAA,CACb,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,aAAc,IAAM,GAAa,GACjC,aAAc,IAAM,EAAa,IACjC,QAAS,IAAM,GAAa,GAC5B,OAAQ,IAAM,GAAa,GAC3B,UAAU,iBACV,SAAU,EACV,KAAK,UACL,aAAY,CAAA,EAAG,EAAQ,KAAK,CAAC,EAAE,EAAE,EAAQ,WAAW,CAAA,EAAG,EAAe,iBAAmB,GAAA,CAAI,UAE7F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,gDAAgD,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,uDAAuD,EAAE,EAAY,CAAA,EAAG,EAAO,WAAW,CAAC,0BAA0B,CAAC,CAAG,GAAG,gDAAgD,EAAE,EAAe,aAAe,GAAA,CAAI,WACrT,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,mCAAmC,EAAE,EAAQ,QAAQ,CAAC,+FAA+F,CAAC,GACtK,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sGACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kDAAyC,WAG7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,oEAAoE,EAAE,EAAQ,QAAQ,CAAC,uDAAuD,EAAE,EAAe,kBAAoB,GAAA,CAAI,CAAE,cAAY,gBACnN,EAAQ,IAAI,GAEf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,CAAC,+BAA+B,EAAE,EAAO,IAAI,CAAC,aAAa,CAAC,UAAG,EAAQ,KAAK,GAC3F,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,mBAAmB,EAAE,EAAO,SAAS,CAAC,gBAAgB,CAAC,UAAG,EAAQ,WAAW,GAC5F,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,wDAAwD,EAAE,EAAQ,QAAQ,CAAC,+CAA+C,EAAE,EAAY,cAAgB,YAAA,CAAa,CACjL,cAAY,aAKtB,GAEM,GAAa,CAAA,EAAA,EAAA,IAAI,AAAJ,EAAK,SAAS,AAAW,QAC1C,CAAM,eACN,GAAgB,CAAK,CAItB,EACC,IAAM,EAAW,GAAc,sBACzB,EAAS,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,CAC3B,CAAE,KAAM,QAAS,MAAO,cAAe,MAAO,MAAO,EACrD,CAAE,KAAM,OAAQ,MAAO,cAAe,MAAO,KAAM,EACnD,CAAE,KAAM,aAAc,MAAO,cAAe,MAAO,KAAM,EACzD,CAAE,KAAM,SAAU,MAAO,eAAgB,MAAO,KAAM,EACtD,CAAE,KAAM,KAAM,MAAO,iBAAkB,MAAO,KAAM,EACrD,CAAE,EAAE,EAGC,EAAe,EAAW,GAAK,GAG/B,EAAkB,CAAA,EAAA,EAAA,OAAA,AAAO,EAC7B,IAAM,EAAO,GAAG,CAAC,IAAM,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAa,EAAG,IAAM,GAAqB,GAAhB,KAAK,MAAM,KAClF,CAAC,EAAQ,EAAa,EAOxB,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,SANsB,CAMZ,CALV,CAAE,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,EAAG,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,CAAE,EACvE,CAAE,QAAS,CAAE,QAAS,EAAG,MAAO,GAAK,EAAG,QAAS,CAAE,QAAS,EAAG,MAAO,EAAG,WAAY,CAAE,SAAU,GAAK,MAAO,EAAI,CAAE,CAAE,EAKrH,QAAQ,UACR,QAAQ,UACR,UAAU,iDACV,KAAK,MACL,aAAW,8GAEX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAe,CAAC,sEAAiD,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,MAAM,CAAG,cAAgB,cAAc,4BAA4B,CAAC,WAE9J,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAe,CAAC,0FAAqE,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,IAAI,CAAA,CAAE,WACpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAmD,cAAY,gDAAjD,qCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,+CACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,kDACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,oDAEjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,0CAAc,qCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CAAC,UAAU,0CAA0C,cAAY,SACvE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,WAAgB,CAAC,wCAAmB,EAAE,EAAO,SAAS,CAAC,YAAY,CAAC,UAAE,mBAEzE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,UAIjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAe,CAAC,2FAAsE,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,IAAI,CAAA,CAAE,WACrH,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgH,aAAW,UAAU,SAAU,CAAC,YAA9H,CAAC,kCAAa,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,qCAAqC,CAAC,UAC7G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,gCAErB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgH,aAAW,iBAAiB,SAAU,CAAC,YAArI,CAAC,kCAAa,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,qCAAqC,CAAC,UAC7G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,4BAEtB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAA2K,aAAW,OAAO,SAAU,CAAC,2CAAvL,yJAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,4BAElB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgH,aAAW,aAAa,SAAU,CAAC,YAAjI,CAAC,kCAAa,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,qCAAqC,CAAC,UAC7G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,4BAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgH,aAAW,SAAS,SAAU,CAAC,YAA7H,CAAC,kCAAa,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,qCAAqC,CAAC,UAC7G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,mCAKtB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,mCACZ,EAAO,GAAG,CAAC,CAAC,EAAO,IAClB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAGC,MAAO,CAAE,eAAgB,EAAgB,MAAQ,CAAA,EAAG,IAAU,IAAJ,EAAQ,EAAE,CAAC,AAAC,YAD3D,CAAC,sDAAiC,EAAE,CAAC,EAAgB,kBAAoB,GAAA,CAAI,WAGxF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,4BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,WAAe,CAAC,wDAAmC,EAAE,EAAO,SAAS,CAAC,SAAS,CAAC,UAAG,EAAM,IAAI,KAEhG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAe,CAAC,iEAA4C,EAAE,EAAO,IAAI,CAAC,yBAAyB,CAAC,WACnG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CAAE,MAAuB,CAAhB,CAAsB,KAAK,AAAe,GAAZ,MAAM,GADzC,CAAC,CAC6C,8CADnB,EAAE,EAAM,KAAK,CAAC,wCAAwC,CAAC,GAG/F,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,wDACZ,CAAe,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAQ,IAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAGC,MAAO,CAAE,OAAQ,CAAA,EAAG,EAAO,CAAC,CAAC,AAAC,YADnB,CAAC,kCAAa,EAAE,EAAM,KAAK,CAAC,wBAAwB,CAAC,EAD3D,SAOb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAW,CAAC,0BAA0B,EAAE,EAAO,SAAS,CAAA,CAAE,CAAE,cAAY,aAvB9E,EAAM,IAAI,KA8BrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,0CAAc,2BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAe,CAAC,oEAA+C,EAAE,EAAO,SAAS,CAAA,CAAE,WAClF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,2CAAK,SACN,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAA+E,KAAK,cAAc,gBAAe,EAAG,gBAAe,IAAK,gBAAe,aAAxI,CAAC,gCAAW,EAAE,EAAO,UAAU,CAAC,6BAA6B,CAAC,UAC5E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,MAAO,CAAE,MAAO,KAAM,YADX,CAAC,uEAAkD,EAAE,CAAC,EAAgB,mCAAqC,GAAA,CAAI,KAI9H,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,2CAAK,oQAgBlB,GAMM,GAAc,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,SAAS,AAAY,eAC5C,CAAa,QACb,CAAM,eACN,GAAgB,CAAK,YACrB,EAAa,EAAE,CAMhB,EACC,IAAM,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,CAChC,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CAAC,UAAU,0BAA4B,KAAM,QAAS,MAAO,0BAA2B,EACtG,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAM,CAAA,CAAC,UAAU,0BAA4B,KAAM,SAAU,MAAO,8BAA+B,EAC5G,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAa,CAAA,CAAC,UAAU,0BAA4B,KAAM,QAAS,MAAO,2BAA4B,EAC/G,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,0BAA4B,KAAM,SAAU,MAAO,2BAA4B,EACvG,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BAA4B,KAAM,QAAS,MAAO,+BAAgC,EAC3G,CAAE,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BAA4B,KAAM,OAAQ,MAAO,8BAA+B,EAC1G,CAAE,EAAE,EAGC,EAAiB,EACnB,CAAE,QAAS,CAAE,QAAS,CAAE,EAAG,QAAS,CAAE,QAAS,CAAE,CAAE,EACnD,CAAE,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAAG,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,CAAE,EAE9D,EAAkB,EACpB,CAAE,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,EAAG,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,CAAE,EACvE,CAAE,QAAS,CAAE,QAAS,EAAG,MAAO,EAAI,EAAG,QAAS,CAAE,QAAS,EAAG,MAAO,CAAE,CAAE,EAE7E,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,GAAG,eACH,UAAW,CAAC,aAAa,EAAE,EAAO,EAAE,CAAC,CAAC,EAAE,EAAO,IAAI,CAAC,UAAU,EAAE,EAAA,CAAY,CAC5E,KAAK,iBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAmB,OAAQ,EAAO,MAAM,CAAE,cAAe,IAE1D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,0CAA0C,EAAE,EAAO,WAAW,CAAC,8BAA8B,EAAE,EAAO,MAAM,CAAA,CAAE,CAC1H,KAAK,aACL,aAAW,2BAEX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAI,CAAA,CACH,KAAK,IACL,UAAW,CAAC,6CAA6C,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,kGAAkG,CAAC,CAClM,aAAW,uCAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAC,4CAA4C,CAAC,GAC1F,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,oBAAoB,EAAE,EAAO,aAAa,CAAC,6DAA6D,CAAC,UAAE,mBAE/H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2GACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,yBAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,sBAAsB,EAAE,EAAO,IAAI,CAAA,CAAE,UAAE,YAE3D,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,+OAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,YAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,wBAMzC,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CACC,UAAU,4GACV,kBAAgB,uBAGhB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,GAAK,KAAM,QAAS,EACjE,UAAU,wBAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAU,kMACV,KAAK,MACL,aAAW,4BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,yDAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oHAAoH,cAAY,cAKnJ,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,GAAK,MAAO,EAAI,EAC7D,UAAU,qCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,GAAG,aAAa,UAAU,iGAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oGAA2F,WAE7G,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,+BAA+B,EAAE,EAAO,SAAS,CAAC,WAAW,CAAC,UAAE,oBAIjF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,CAAC,CAAA,CACP,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,GAAK,MAAO,EAAI,EAC7D,UAAW,CAAC,gCAAgC,EAAE,EAAO,SAAS,CAAC,wDAAwD,CAAC,UACzH,8HAKD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,GAAK,MAAO,EAAI,EAC7D,UAAU,yBAEV,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,0VACV,aAAW,8BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,wBAAwB,cAAY,SACxD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,mBAKV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,SAAU,EACV,QAAQ,UACR,QAAQ,UACR,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,EAAG,MAAO,EAAI,EAC3D,UAAU,sDAEV,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAmB,cAAe,MAIrC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAW,OAAQ,EAAQ,cAAe,OAI7C,CAAA,EAAA,EAAA,GAAA,EAAC,UAAA,CACC,UAAU,sCACV,kBAAgB,0BAEhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,EAAG,EAC9D,YAAa,CAAE,QAAS,EAAG,EAAG,CAAE,EAChC,SAAU,CAAE,MAAM,CAAK,EACvB,WAAY,EAAgB,CAAC,EAAI,CAAE,SAAU,EAAI,EACjD,UAAU,uCAEV,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,GAAG,iBAAiB,UAAU,oEAA0D,yBACnE,IACvB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,oFAA2E,cAE7F,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAA,EAAG,EAAO,SAAS,CAAC,uCAAuC,CAAC,UAAE,+EAM9E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,EAAG,EAC9D,YAAa,CAAE,QAAS,EAAG,EAAG,CAAE,EAChC,SAAU,CAAE,MAAM,CAAK,EACvB,UAAU,yCAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8IACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sDACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,gDAAuC,qBAEzD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAE,EAAO,MAAM,CAAA,CAAE,MAEhD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEAAgE,KAAK,gBACjF,GAAkB,GAAG,CAAC,CAAC,EAAS,IAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAgC,QAAS,EAAS,MAAO,EAAO,OAAQ,EAAQ,cAAe,GAA9E,EAAQ,KAAK,QAMrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,EAAG,EAC9D,YAAa,CAAE,QAAS,EAAG,EAAG,CAAE,EAChC,SAAU,CAAE,MAAM,CAAK,EACvB,UAAU,yCAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4IACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,+BACpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8CAAqC,mBAEvD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAE,EAAO,MAAM,CAAA,CAAE,MAEhD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEAAgE,KAAK,gBACjF,GAAmB,GAAG,CAAC,CAAC,EAAS,IAChC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAgC,QAAS,EAAS,MAAO,EAAQ,EAAG,OAAQ,EAAQ,cAAe,EAAe,YAAY,CAAA,CAAA,GAA7G,EAAQ,KAAK,aAQzC,CAAA,EAAA,EAAA,GAAA,EAAC,UAAA,CACC,UAAU,sCACV,kBAAgB,6BAEhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,EAAG,EAC9D,YAAa,CAAE,QAAS,EAAG,EAAG,CAAE,EAChC,SAAU,CAAE,MAAM,CAAK,EACvB,UAAU,sCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,GAAG,oBAAoB,UAAU,uDAA8C,wBACnF,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAA,EAAG,EAAO,SAAS,CAAC,qBAAqB,CAAC,UAAE,sCAE5D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yEAAyE,KAAK,gBAC1F,EAAY,GAAG,CAAC,CAAC,EAAY,IAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,QAAS,EAAgB,CAAE,QAAS,EAAG,MAAO,CAAE,EAAI,CAAE,QAAS,EAAG,MAAO,EAAI,EAC7E,YAAa,CAAE,QAAS,EAAG,MAAO,CAAE,EACpC,SAAU,CAAE,KAAM,EAAK,EACvB,WAAY,EAAgB,CAAC,EAAI,CAAE,MAAO,AAAI,IAAI,EAClD,WAAY,EAAgB,CAAC,EAAI,CAAE,MAAO,IAAK,EAAG,CAAC,CAAE,EACrD,UAAU,4CACV,KAAK,qBAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,sFAAsF,EAAE,EAAW,KAAK,CAAC,sDAAsD,CAAC,CAC5K,cAAY,gBAEX,EAAW,IAAI,GAElB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,mBAAmB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAG,EAAW,IAAI,KAftE,EAAW,IAAI,UAuB9B,CAAA,EAAA,EAAA,GAAA,EAAC,UAAA,CACC,UAAU,sCACV,kBAAgB,qBAEhB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,EAAG,EAC9D,YAAa,CAAE,QAAS,EAAG,EAAG,CAAE,EAChC,SAAU,CAAE,MAAM,CAAK,EACvB,UAAU,yCAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,sCAAsC,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,iBAAiB,CAAC,WAC7G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,+DAA+D,cAAY,SACjG,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,GAAG,YAAY,UAAU,sDAA6C,yBAC1E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAA,EAAG,EAAO,SAAS,CAAC,kCAAkC,CAAC,UAAE,6FAGvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oEACb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,wUAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,UAAU,cAAY,SAAS,iBAGjD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CACH,KAAK,IACL,UAAW,CAAC,uFAAuF,EAAE,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,IAAI,CAAC,uDAAuD,EAAE,EAAO,MAAM,CAAC,wGAAwG,CAAC,UACjT,oCAST,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAW,CAAC,2CAA2C,EAAE,EAAO,MAAM,CAAA,CAAE,CAAE,KAAK,uBACrF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,CAAC,mBAAmB,EAAE,EAAO,SAAS,CAAA,CAAE,WAAE,qBACnC,IACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,wBACL,OAAO,SACP,IAAI,sBACJ,UAAU,4FACX,yBASf,GAMM,GAAoB,CAAA,EAAA,EAAA,IAAI,AAAJ,EAAK,SAAS,AAAkB,WACxD,CAAS,aACT,CAAW,aACX,CAAW,KACX,CAAG,MACH,CAAI,YACJ,CAAU,QACV,CAAM,aACN,CAAW,QACX,CAAM,UACN,CAAQ,CACR,aAAW,cACX,CAAY,CAcb,EACC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAW,CAAC,mFAAmF,EAAE,EAAO,MAAM,CAAC,CAAC,EAAE,EAAO,WAAW,CAAA,CAAE,CACtI,KAAK,UACL,aAAW,+BAGX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAW,CAAC,wBAAwB,EAAE,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAC,mHAAmH,CAAC,CACzO,aAAW,gBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAIpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAW,CAAC,0BAA0B,EAAE,EAAY,cAAgB,6CAA6C,yJAAyJ,CAAC,CAC3Q,aAAY,EAAY,QAAU,OAClC,eAAc,WAEb,EAAY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BAA6B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,4BAI7E,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAW,CAAC,wBAAwB,EAAE,EAAc,wBAA0B,CAAA,EAAG,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,mBAAmB,CAAC,CAAC,mHAAmH,EAAE,EAAc,gBAAkB,GAAA,CAAI,CAC/R,aAAY,EAAc,iBAAmB,kBAC7C,eAAc,WAEd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAIpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,SAAS,EAAE,EAAO,MAAM,CAAG,cAAgB,eAAe,gBAAgB,CAAC,CAAE,cAAY,SAG1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,QAAQ,YAAY,UAAW,CAAC,QAAQ,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,QACrE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,GAAG,YACH,KAAK,SACL,MAAO,EACP,SAAW,AAAD,GAAO,EAAY,OAAO,EAAE,MAAM,CAAC,KAAK,GAClD,IAAK,GACL,IAAK,IACL,UAAW,CAAC,uBAAuB,EAAE,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,IAAI,CAAC,4BAA4B,EAAE,EAAO,MAAM,CAAC,0EAA0E,CAAC,CACvL,aAAW,wBAKf,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAW,CAAC,wBAAwB,EAAE,EAAO,+BAAiC,CAAA,EAAG,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAC,mHAAmH,CAAC,CACvO,aAAY,EAAO,eAAiB,cACpC,eAAc,WAEd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAIpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,6BAA6B,EAAE,EAAO,SAAS,CAAC,yBAAyB,CAAC,CAAE,YAAU,SAAS,aAAW,4BC1xB1H,AD2xBE,SC3xBkB,AAAX,CAAwB,CAAE,EAAsB,CAAC,EAC/D,IAAM,EAAO,KAAK,KAAK,CAAC,EAAQ,GAAe,EACzC,EAAO,KAAK,KAAK,CAAC,EAAQ,GAAe,EAC/C,MAAO,CAAA,EAAG,EAAK,CAAC,EAAE,EAAA,CAAM,AAC1B,EDuxBoB,OAIpB,GAMe,SAAS,KACtB,GAAM,OAAE,CAAK,eAAE,CAAa,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,IACnC,CAAE,MAAO,CAAW,CAAE,CAAG,CAAA,EAAA,EAAA,kBAAA,AAAkB,IAE3C,EADuB,AACP,CADO,EAAA,EAAA,gBAAA,AAAgB,MACC,EACxC,EAAS,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,KArvBvB,QACC,CACL,CAmvB0C,EAnvBtC,GAFS,AAAkB,YAA4B,AAAlB,SAqvBQ,GAnvBpC,cAAgB,cAC7B,YAAa,EAAS,cAAgB,WACtC,WAAY,EAAS,cAAgB,eACrC,KAAM,EAAS,aAAe,iBAC9B,cAAe,EAAS,gBAAkB,iBAC1C,UAAW,EAAS,gBAAkB,iBACtC,UAAW,EAAS,gBAAkB,iBACtC,OAAQ,EAAS,kBAAoB,mBACrC,YAAa,EAAS,kBAAoB,mBAC1C,KAAM,EAAS,aAAe,WAC9B,UAAW,EAAS,cAAgB,qBACpC,CACF,GAuuBmE,CAAC,EAAO,EAAc,EACnF,EAAW,GAAc,sBAGzB,EAAa,CAAC,MAAM,EAAE,EAAA,CAAa,CAEnC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAqB,MACrD,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,WACnD,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAC3B,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAkB,GAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAElE,GAAS,AEx8BV,SAAS,AAAe,CAA2B,EACxD,GAAM,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,CACnD,WAAW,EACX,aAAa,EACb,YAAa,EACb,YAAa,EACb,WAAY,CACd,GAGM,EAAkB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAsB,MAC9C,EAAgB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAkB,MACxC,EAAc,CAAA,EAAA,EAAA,MAAM,AAAN,EAA4B,MAC1C,EAAgB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAwB,IAAI,KAClD,EAAe,CAAA,EAAA,EAAA,MAAA,AAAM,EAAgC,IAAI,KAGzD,EAAsB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAoB,EAAE,EAClD,EAAe,CAAA,EAAA,EAAA,MAAA,AAAM,EAAS,GAC9B,EAAe,CAAA,EAAA,EAAA,MAAM,AAAN,EAAe,GAC9B,EAAoB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAgB,MAG1C,EAAmB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAuB,MAChD,EAAoB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAS,EAAE,EACrC,EAAiB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAqB,MAC5C,EAAmB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAsB,MAG/C,EAAkB,CAAA,EAAA,EAAA,MAAA,AAAM,EAA2B,IAAI,KAGvD,EAAmB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACnC,GAAI,EAAgB,OAAO,CAAE,OAAO,EAAgB,OAAO,CAE3D,IAAM,EAAM,IAAI,aAChB,EAAgB,OAAO,CAAG,EAG1B,IAAM,EAAa,EAAI,UAAU,GACjC,EAAW,IAAI,CAAC,KAAK,CAAG,GACxB,EAAW,OAAO,CAAC,EAAI,WAAW,EAClC,EAAc,OAAO,CAAG,EAGxB,IAAM,EAAW,EAAI,cAAc,GAKnC,OAJA,EAAS,OAAO,CAAG,IACnB,EAAW,OAAO,CAAC,GACnB,EAAY,OAAO,CAAG,EAEf,CACT,EAAG,EAAE,EAGC,EAAqB,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,UACrC,IAAM,EAAM,IAIZ,MAHI,AAAc,aAAa,GAAvB,KAAK,EACX,MAAM,EAAI,MAAM,GAEX,CACT,EAAG,CAAC,EAAiB,EAGf,EAAY,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAEnC,IAAM,EAAS,EAAgB,OAAO,CAAC,GAAG,CAAC,GAC3C,GAAI,EAAQ,OAAO,EAEnB,IAAM,EAAM,MAAM,IACZ,EAAW,MAAM,MAAM,GACvB,EAAc,MAAM,EAAS,WAAW,GACxC,EAAc,MAAM,EAAI,eAAe,CAAC,GAG9C,OADA,EAAgB,OAAO,CAAC,GAAG,CAAC,EAAK,GAC1B,CACT,EAAG,CAAC,EAAmB,EAGjB,EAAoB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAC3C,IAAM,EAAM,MAAM,IACZ,EAAc,MAAM,EAAK,WAAW,GAE1C,OAAO,AADa,MAAM,EAAI,eAAe,CAAC,EAEhD,EAAG,CAAC,EAAmB,EAGjB,EAAwB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAAC,EAAqB,EAAmB,GAAG,IACpF,IAAM,EAAc,EAAO,cAAc,CAAC,GACpC,EAAiB,KAAK,KAAK,CAAC,EAAY,MAAM,CAAG,GACjD,EAAkB,EAAE,CAE1B,IAAK,IAAI,EAAI,EAAG,EAAI,EAAU,IAAK,CACjC,IAAI,EAAM,EACJ,EAAQ,EAAI,EACZ,EAAM,KAAK,GAAG,CAAC,EAAQ,EAAgB,EAAY,MAAM,EAE/D,IAAK,IAAI,EAAI,EAAO,EAAI,EAAK,IAAK,CAChC,IAAM,EAAM,KAAK,GAAG,CAAC,CAAW,CAAC,EAAE,EAC/B,EAAM,GAAK,GAAM,CAAA,CACvB,CACA,EAAM,IAAI,CAAC,EACb,CAEA,OAAO,CACT,EAAG,EAAE,EAGC,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IACjC,IAAM,EAAM,EAAgB,OAAO,CACnC,GAAI,CAAC,GAAO,CAAC,EAAc,OAAO,CAAE,OAAO,KAE3C,IAAI,EAAW,EAAc,OAAO,CAAC,GAAG,CAAC,EAAM,EAAE,EAC7C,EAAU,EAAa,OAAO,CAAC,GAAG,CAAC,EAAM,EAAE,EAiB/C,OAfK,IACH,EAAW,EAAI,EADF,QACY,GACzB,EAAU,EAAI,kBAAkB,GAEhC,EAAS,OAAO,CAAC,GACjB,EAAQ,OAAO,CAAC,EAAc,OAAO,EAErC,EAAc,OAAO,CAAC,GAAG,CAAC,EAAM,EAAE,CAAE,GACpC,EAAa,OAAO,CAAC,GAAG,CAAC,EAAM,EAAE,CAAE,IAIrC,EAAS,IAAI,CAAC,KAAK,CAAG,EAAM,IAAI,CAAG,EAAI,EAAM,MAAM,CAC/C,IAAS,EAAQ,GAAG,CAAC,KAAK,CAAG,EAAM,GAAA,AAAG,EAEnC,UAAE,UAAU,CAAQ,CAC7B,EAAG,EAAE,EAGC,EAAe,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAC/B,EACA,EACA,EACA,EACA,KAEA,IAMI,EANE,EAAM,EAAgB,OAAO,CACnC,GAAI,CAAC,EAAK,OAEV,IAAM,EAAQ,EAAc,GAC5B,GAAI,CAAC,EAAO,OAIZ,GAAI,EAAK,WAAW,CAClB,CADoB,CACX,EAAK,WAAW,MACpB,GAAI,EAAK,QAAQ,CACtB,CADwB,EACpB,CACF,EAAS,MAAM,EAAU,EAAK,QAAQ,CACxC,CAAE,MAAO,EAAG,CACV,QAAQ,KAAK,CAAC,wBAAyB,GACvC,MACF,CAGF,GAAI,CAAC,EAAQ,OAEb,IAAM,GAAkC,EAAK,SAAS,CAAG,CAAA,EAAY,CAA5C,IACnB,EAAoB,EAAK,MAAM,EAAI,EAGzC,GAAI,EAAmB,EAAO,QAAQ,CAAG,EAAG,OAE5C,IAAM,EAAS,EAAI,kBAAkB,GACrC,EAAO,MAAM,CAAG,EAGhB,IAAM,EAAW,EAAI,UAAU,GAC/B,EAAS,IAAI,CAAC,KAAK,CAAG,EAAK,IAAI,EAAI,EACnC,EAAO,OAAO,CAAC,GACf,EAAS,OAAO,CAAC,EAAM,QAAQ,EAE/B,IAAM,EAAO,KAAK,GAAG,CAAC,EAAG,EAAY,GAGrC,EAAO,KAAK,CAAC,EAFE,EAAmB,EAAI,AAEnB,CAFoB,EAAmB,EAAoB,GAI9E,EAAoB,OAAO,CAAC,IAAI,CAAC,QAC/B,EACA,OAAQ,EAAK,EAAE,CACf,QAAS,EAAM,EAAE,AACnB,GAEA,EAAO,OAAO,CAAG,KACf,EAAoB,OAAO,CAAG,EAAoB,OAAO,CAAC,MAAM,CAC9D,GAAK,EAAE,MAAM,GAAK,EAEtB,CACF,EAAG,CAAC,EAAe,EAAU,EAGvB,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACjC,EAAoB,OAAO,CAAC,OAAO,CAAC,CAAC,QAAE,CAAM,CAAE,IAC7C,GAAI,CACF,EAAO,IAAI,EACb,CAAE,MAAO,EAAG,CAEZ,CACF,GACA,EAAoB,OAAO,CAAG,EAChC,AADkC,EAC/B,EAAE,EAGC,EAAyB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACzC,GAAI,CAAC,EAAgB,OAAO,EAAI,CAAC,EAAM,SAAS,EAAI,CAAC,EAAS,OAE9D,IAAM,EAAM,EAAgB,OAAO,CAC7B,EAAU,EAAI,WAAW,CAAG,EAAa,OAAO,CAChD,EAAc,EAAa,OAAO,CAAkB,ADhFpD,ECgFqC,ADhF3B,GCgFmD,EDhF7C,ACgFqD,GAAG,CAwB9E,GArBI,EAAQ,WAAW,EAAI,GAAe,EAAQ,OAAO,EAAE,AAEzD,EAAa,OAAO,CAAG,EAAQ,SAAS,CACxC,EAAa,OAAO,CAAG,EAAI,WAAW,CAGtC,IACA,EAAQ,MAAM,CAAC,OAAO,CAAC,IACjB,AAAC,EAAM,IAAI,EAAE,AACf,EAAM,KAAK,CAAC,OAAO,CAAC,IAClB,EAAa,EAAM,EAAO,EAAI,WAAW,CAAE,EAAQ,SAAS,CAAE,EAAQ,GAAG,CAC3E,EAEJ,GAEA,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,YAAa,EAAQ,SAAS,CAAC,CAAC,GAEvD,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,aAAE,EAAY,CAAC,EAIlC,EAAY,OAAO,CAAE,CACvB,IAAM,EAAY,IAAI,WAAW,EAAY,OAAO,CAAC,iBAAiB,EACtE,EAAY,OAAO,CAAC,oBAAoB,CAAC,GACzC,IAAM,EAAU,EAAU,MAAM,CAAC,CAAC,EAAG,IAAM,EAAI,EAAG,GAAK,EAAU,MAAM,CACvE,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,YAAa,EAAU,IAAI,CAAC,CACrD,CAEA,EAAkB,OAAO,CAAG,sBAAsB,EACpD,EAAG,CAAC,EAAS,EAAM,SAAS,CAAE,EAAgB,EAAa,EAGrD,EAAO,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAC9B,GAAI,CAAC,EAAS,OAEd,IAAM,EAAM,MAAM,IAElB,IAEA,IAAM,EAAY,GAAY,EAAM,WAAW,CAC/C,EAAa,OAAO,CAAG,EACvB,EAAa,OAAO,CAAG,EAAI,WAAW,CAGtC,EAAQ,MAAM,CAAC,OAAO,CAAC,IAEL,AAChB,EADwB,EACpB,IAD0B,CAAC,IAAI,CAAC,GAAK,EAAE,IAAI,GAChC,CAAC,EAAM,IAAI,EAAE,AACxB,EAAM,IAAI,EAAE,AAEhB,EAAM,KAAK,CAAC,OAAO,CAAC,IAClB,EAAa,EAAM,EAAO,EAAI,WAAW,CAAE,EAAW,EAAQ,GAAG,CACnE,EACF,GAEA,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,WAAW,EAAM,YAAa,EAAU,CAAC,EAChE,EAAkB,OAAO,CAAG,sBAAsB,EACpD,EAAG,CAAC,EAAS,EAAM,WAAW,CAAE,EAAoB,EAAgB,EAAc,EAAuB,EAGnG,EAAQ,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACxB,IACI,EAAkB,OAAO,EAAE,AAC7B,qBAAqB,EAAkB,OAAO,EAEhD,EAAS,GAAM,CAAD,CAAG,GAAG,CAAC,CAAE,WAAW,EAAM,CAAC,CAC3C,EAAG,CAAC,EAAe,EAGb,EAAO,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACvB,IACA,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,YAAa,GAAS,YAAc,EAAQ,SAAS,CAAG,EAAE,CAAC,CACpF,EAAG,CAAC,EAAO,EAAQ,EAGb,EAAO,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,IACpB,EAAM,SAAS,CACjB,CADmB,CACd,GAEL,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,YAAa,EAAK,CAAC,CAE9C,EAAG,CAAC,EAAM,SAAS,CAAE,EAAK,EAGpB,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACxC,GAAI,CACF,IAAM,EAAS,MAAM,UAAU,YAAY,CAAC,YAAY,CAAC,CAAE,OAAO,CAAK,EACvE,GAAe,OAAO,CAAG,EAEzB,IAAM,EAAM,MAAM,IAGZ,EAAc,EAAI,uBAAuB,CAAC,GAC1C,EAAgB,EAAI,cAAc,GACxC,EAAc,OAAO,CAAG,IACxB,EAAY,OAAO,CAAC,GACpB,EAAiB,OAAO,CAAG,EAG3B,IAAM,EAAgB,IAAI,cAAc,EAAQ,CAC9C,SAAU,wBACZ,GAEA,EAAkB,OAAO,CAAG,EAAE,CAE9B,EAAc,eAAe,CAAG,AAAC,IAC3B,EAAE,IAAI,CAAC,IAAI,CAAG,GAAG,AACnB,EAAkB,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,CAEzC,EAEA,EAAiB,OAAO,CAAG,EAC3B,EAAc,KAAK,CAAC,KAEpB,CAF0B,CAEjB,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,aAAa,CAAK,CAAC,CAFW,EAKjD,AAAC,EAAM,SAAS,EAAE,AACpB,GAEJ,CAAE,MAAO,EAAG,CAEV,MADA,QAAQ,KAAK,CAAC,6BAA8B,GACtC,CACR,CACF,EAAG,CAAC,EAAoB,EAAM,SAAS,CAAE,EAAK,EAExC,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,SACzB,IAAI,QAAQ,AAAC,IAClB,IAAM,EAAgB,EAAiB,OAAO,AAC9C,CAAK,GAAD,AAKJ,EAAc,MAAM,CAAG,GALH,OAMlB,IAAM,EAAO,IAAI,KAAK,EAAkB,OAAO,CAAE,CAAE,KAAM,YAAa,GAGhE,EAAM,EAAgB,OAAO,CACnC,GAAI,EACF,GADO,AACH,CACF,IAAM,EAAc,MAAM,EAAK,WAAW,GACpC,EAAc,MAAM,EAAI,eAAe,CAAC,GAC9C,EAAQ,MAAE,EAAM,OAAQ,CAAY,EACtC,CAAE,MAAO,EAAG,CACV,QAAQ,KAAK,CAAC,8BAA+B,GAC7C,EAAQ,KACV,MAEA,EAAQ,MAIN,EAAe,OAAO,EAAE,CAC1B,EAAe,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,GAAS,EAAM,IAAI,IAC9D,EAAe,OAAO,CAAG,MAE3B,EAAiB,OAAO,CAAG,KAC3B,EAAiB,OAAO,CAAG,KAC3B,EAAkB,OAAO,CAAG,EAAE,AAChC,EAEA,EAAc,IAAI,GAClB,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,YAAa,GAAM,CAAC,GAjCzC,EAAQ,KAkCZ,GACC,EAAE,EAGL,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACR,GAAI,CAAC,EAAM,WAAW,EAAI,CAAC,EAAiB,OAAO,CAAE,OAErD,IAAM,EAAmB,KACvB,GAAI,EAAiB,OAAO,CAAE,CAC5B,IAAM,EAAY,IAAI,WAAW,EAAiB,OAAO,CAAC,iBAAiB,EAC3E,EAAiB,OAAO,CAAC,oBAAoB,CAAC,GAC9C,IAAM,EAAU,EAAU,MAAM,CAAC,CAAC,EAAG,IAAM,EAAI,EAAG,GAAK,EAAU,MAAM,CACvE,EAAS,IAAK,AAAC,CAAE,GAAG,CAAC,CAAE,WAAY,EAAU,IAAI,CAAC,CACpD,CACI,EAAM,WAAW,EAAE,AACrB,sBAAsB,EAE1B,EAEA,GACF,EAAG,CAAC,EAAM,WAAW,CAAC,EAGtB,IAAM,EAAY,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAC5B,EAAwB,KAAK,CAC7B,EACA,KAEA,GAAI,CAAC,EAAS,OAAO,KAErB,IAAM,EAAQ,GAAa,EAErB,EAAiC,EAD3B,GAAW,EAAQ,OAAA,AAAO,EACd,AAAqB,CAAA,EAAO,EAAQ,GAAG,IAGzD,EAAa,IAAI,oBAAoB,EAAG,KAAK,IAAI,CAAmB,MAAlB,GAA0B,OAC5E,EAAa,EAAW,UAAU,GAKxC,IAAK,IAAM,KAJX,EAAW,IAAI,CAAC,KAAK,CAAG,GACxB,EAAW,OAAO,CAAC,EAAW,WAAW,EAGrB,EAAQ,MAAM,EAAE,CAElC,GADgB,CACZ,CADoB,MAAM,CAAC,IAAI,CAAC,GAAK,EAAE,IAAI,GAChC,CAAC,EAAM,IAAI,EACtB,EAAM,IAAI,CADc,CACZ,QAEhB,IAAM,EAAY,EAAW,UAAU,GACvC,EAAU,IAAI,CAAC,KAAK,CAAG,EAAM,MAAM,CACnC,IAAM,EAAW,EAAW,kBAAkB,GAM9C,IAAK,IAAM,KALX,EAAS,GAAG,CAAC,KAAK,CAAG,EAAM,GAAG,CAE9B,EAAU,OAAO,CAAC,GAClB,EAAS,OAAO,CAAC,GAEE,EAAM,KAAK,EAAE,KAC1B,EAQJ,GANI,EAAK,WAAW,CAClB,CADoB,CACX,EAAK,WAAW,CAChB,EAAK,QAAQ,EAAE,CACxB,EAAS,EAAgB,OAAO,CAAC,GAAG,CAAC,EAAK,SAAQ,EAGhD,CAAC,EAAQ,SAEb,IAAM,GAAkC,EAAK,SAAS,CAAG,CAAA,EAAO,CAAvC,CAA+C,GAAG,IAC3E,GAAI,GAAoB,GACpB,EAAmB,EAAO,QAAQ,EAAI,EADD,CACI,QAE7C,IAAM,EAAS,EAAW,kBAAkB,GAC5C,EAAO,MAAM,CAAG,EAEhB,IAAM,EAAW,EAAW,UAAU,GACtC,EAAS,IAAI,CAAC,KAAK,CAAG,EAAK,IAAI,EAAI,EACnC,EAAO,OAAO,CAAC,GACf,EAAS,OAAO,CAAC,GAEjB,IAAM,EAAO,KAAK,GAAG,CAAC,EAAG,GACnB,EAAS,EAAmB,EAAI,CAAC,EAAmB,EAC1D,EAAO,KAAK,CAAC,EAAM,EACrB,CACF,CAEA,IAAM,EAAiB,MAAM,EAAW,cAAc,UAI7C,EAAiB,EAM5B,EAAG,CAAC,EAAQ,EAGN,EAAc,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,MAC9B,EACA,KAEA,GAAI,CAAC,EAAS,OAAO,KAErB,IAAM,EAAQ,IAAI,IACZ,EAAQ,GAAa,EAErB,EDpWA,CCoWiC,CAD3B,GAAW,EAAQ,CDnWjB,MCmWiB,AAAO,EACd,AAAqB,CAAA,EAAO,EAAQ,GAAG,IAE/D,IAAK,IAAM,KAAS,EAAQ,MAAM,CAAE,CAClC,GAA2B,IAAvB,EAAM,KAAK,CAAC,MAAM,CAAQ,SAE9B,IAAM,EAAa,IAAI,oBAAoB,EAAG,KAAK,IAAI,CAAmB,MAAlB,GAA0B,OAC5E,EAAY,EAAW,UAAU,GACvC,EAAU,IAAI,CAAC,KAAK,CAAG,EAAM,MAAM,CACnC,IAAM,EAAW,EAAW,kBAAkB,GAM9C,IAAK,IAAM,KALX,EAAS,GAAG,CAAC,KAAK,CAAG,EAAM,GAAG,CAE9B,EAAU,OAAO,CAAC,GAClB,EAAS,OAAO,CAAC,EAAW,WAAW,EAEpB,EAAM,KAAK,EAAE,KAC1B,EAQJ,GANI,EAAK,WAAW,CAClB,CADoB,CACX,EAAK,WAAW,CAChB,EAAK,QAAQ,EAAE,CACxB,EAAS,EAAgB,OAAO,CAAC,GAAG,CAAC,EAAK,SAAQ,EAGhD,CAAC,EAAQ,SAEb,IAAM,GAAkC,EAAK,SAAS,CAAG,CAAA,EAAO,CAAvC,CAA+C,GAAG,CD7X1D,GC8XjB,GAAI,GAAoB,EAAiB,SAEzC,IAAM,EAAS,EAAW,kBAAkB,GAC5C,EAAO,MAAM,CAAG,EAEhB,IAAM,EAAW,EAAW,UAAU,GACtC,EAAS,IAAI,CAAC,KAAK,CAAG,EAAK,IAAI,EAAI,EACnC,EAAO,OAAO,CAAC,GACf,EAAS,OAAO,CAAC,GAEjB,IAAM,EAAO,KAAK,GAAG,CAAC,EAAG,GACnB,EAAS,EAAmB,EAAI,CAAC,EAAmB,EAC1D,EAAO,KAAK,CAAC,EAAM,EACrB,CAGA,IAAM,EAAO,EADU,MAAM,EAAW,OACV,OADwB,IAEtD,EAAM,GAAG,CAAC,EAAM,IAAI,CAAE,EACxB,CAEA,OAAO,CACT,EAAG,CAAC,EAAQ,EAkBZ,MAfA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,IACD,KACL,IACI,EAAkB,OAAO,EAAE,AAC7B,qBAAqB,EAAkB,OAAO,EAE5C,EAAe,OAAO,EAAE,AAC1B,EAAe,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,GAAS,EAAM,IAAI,IAE5D,EAAgB,OAAO,EAAE,AAC3B,EAAgB,OAAO,CAAC,KAAK,EAEjC,EACC,CAAC,EAAe,EAEZ,CACL,GAAG,CAAK,MACR,QACA,OACA,OACA,iBACA,gBACA,EACA,YACA,0CACA,YACA,cACA,qBACA,CACF,CACF,EFoZgC,GACxB,GAAe,CAAA,EAAA,EAAA,MAAA,AAAM,EAAmB,MAI9C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAW,EAab,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KAEV,EAAG,CAAC,EAAQ,EAEZ,IAAM,GAAW,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAAC,EAAc,EAAyB,OAAO,IAC1E,EAAW,IACT,GAAI,CAAC,EAAM,OAAO,EAClB,IAAM,EAAW,EAAY,EAAM,EAAM,EAAK,MAAM,CAAC,MAAM,EAC3D,MAAO,CAAE,GAAG,CAAI,CAAE,OAAQ,IAAI,EAAK,MAAM,CAAE,EAAS,CAAE,UAAW,KAAK,GAAG,EAAG,CAC9E,EACF,EAAG,EAAE,EAEC,GAAc,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAAC,EAAiB,KAChD,EAAW,GACT,AAAK,EACE,CACL,CAFE,EAEC,AAFM,CAEF,CACP,OAAQ,EAAK,MAAM,CAAC,GAAG,CAAC,GAAK,EAAE,EAAE,GAAK,EAAU,CAAE,GAAG,CAAC,CAAE,GAAG,CAAQ,AAAD,EAAK,GACvE,UAAW,KAAK,GAAG,EACrB,EALkB,EAOtB,EAAG,EAAE,EAEC,GAAoB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KAC/B,GAEH,EADmB,EAAmB,EAD1B,KAED,MAEb,GAAc,GACd,GAAgB,EAClB,EAAG,CAAC,EAAQ,EAEN,GAAkB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACzC,GAAK,CAAD,EACJ,EAAe,IACf,AAFc,GAEV,CACF,IAAM,EAAO,MAAM,GAAO,SAAS,CAAC,EAAQ,EAAG,EAAQ,OAAO,EAC9D,GAAI,EAAM,CACR,IAAM,EAAM,IAAI,eAAe,CAAC,GAC1B,EAAI,SAAS,aAAa,CAAC,KACjC,EAAE,IAAI,CAAG,EACT,EAAE,QAAQ,CAAG,CAAA,EAAG,EAAQ,IAAI,CAAC,OAAO,CAAC,cAAe,KAAK,KAAK,EAAE,EAAA,CAAQ,CACxE,EAAE,KAAK,GACP,IAAI,eAAe,CAAC,EACtB,CACF,CAAE,MAAO,EAAG,CACV,QAAQ,KAAK,CAAC,iBAAkB,EAClC,CACA,GAAe,GACf,GAAc,GAChB,EAAG,CAAC,EAAS,GAAO,EAGd,GAAe,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC/B,GAAK,CAAD,CAEJ,GAAI,GAAO,CAFG,UAEQ,CAAE,CAEtB,IAAM,EAAS,MAAM,GAAO,aAAa,GACzC,GAAI,GAAU,EAAkB,CAE9B,IAAM,EAAU,MAAM,GAAiB,EAAO,MAAM,EAC9C,EAAW,IAAI,eAAe,CAAC,GAG/B,EAAU,EACd,CAAC,UAAU,EAAE,IAAI,OAAO,kBAAkB,GAAA,CAAI,CAC9C,EACA,KAAK,IAAI,CAAC,EAAO,MAAM,CAAC,QAAQ,CAAG,EAAQ,GAAG,CAAG,IACjD,GAGF,EAAW,GACT,AAAK,EACE,CACL,CAFE,EAAO,AAEN,CAAI,CACP,OAAQ,EAAK,MAAM,CAAC,GAAG,CAAC,GACtB,EAAE,EAAE,GAAK,EACL,CAAE,GAAG,CAAC,CAAE,MAAO,IAAI,EAAE,KAAK,CAAE,EAAQ,AAAC,EACrC,GAEN,UAAW,KAAK,GAAG,EACrB,EATkB,EAWtB,CACA,GAAoB,KACtB,KAAO,CAEL,IAAI,EAAgB,EAAQ,MAAM,CAAC,IAAI,CAAC,GAAK,EAAE,KAAK,GAAG,GAEvD,GAAI,CAAC,EAAe,CAElB,IAAM,EAAW,EAAY,YAAa,QAAS,EAAQ,MAAM,CAAC,MAAM,EACxE,EAAS,KAAK,EAAG,EACjB,EAAW,GACT,AAAK,EACE,CAAE,CADL,EAAO,AACC,CAAI,CAAE,OAAQ,IAAI,EAAK,MAAM,CAAE,EAAS,CAAE,UAAW,KAAK,GAAG,EAAG,EAD1D,GAGpB,EAAgB,EAAS,EAAE,AAC7B,CAEA,GAAoB,GACpB,MAAM,GAAO,cAAc,CAAC,EAC9B,CACF,EAAG,CAAC,EAAS,GAAQ,EAAiB,EA0BtC,GAvBA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAgB,AAAC,IAErB,IAAI,CAAC,QAAS,WAAW,CAAC,QAAQ,CAAE,EAAE,MAAM,CAAiB,OAAO,EAEpE,CAFuE,MAE/D,EAAE,IAAI,EACZ,IAAK,QACH,EAAE,cAAc,GACZ,GAAO,SAAS,CAAE,GAAO,KAAK,GAC7B,GAAO,IAAI,GAChB,KACF,KAAK,SACH,GAAgB,GAChB,GAAc,GACd,EAAkB,GAEtB,CACF,EAEA,OADA,OAAO,gBAAgB,CAAC,UAAW,GAC5B,IAAM,OAAO,mBAAmB,CAAC,UAAW,EACrD,EAAG,CAAC,GAAO,EAGP,CAAC,EACH,MACE,CAFU,AAEV,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,8DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0HACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,yBAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,gCAO7C,GAAI,CAAC,EACH,MACE,CAAA,EAAA,CAFa,CAEb,IAAA,EAAC,EAAA,cAAc,CAAA,WACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAA,GACD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAY,cAAe,GAAmB,OAAQ,EAAQ,cAAe,EAAe,WAAY,OAM/G,IAAM,GAAc,CAClB,CAAE,GAAI,UAAoB,MAAO,UAAW,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,WAAa,EAClF,CAAE,GAAI,QAAkB,MAAO,QAAS,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,WAAa,EAC9E,CAAE,GAAI,UAAoB,MAAO,WAAY,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,WAAa,EACrF,CAGD,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,cAAc,CAAA,WACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAA,GACD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,oBAAoB,EAAE,EAAO,EAAE,CAAC,CAAC,EAAE,EAAO,IAAI,CAAC,iBAAiB,EAAE,EAAA,CAAY,WAC7F,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,IAAK,GACL,KAAK,OACL,OAAO,UACP,UAAU,UACV,aAAW,sBAIb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,UAAW,CAAC,oDAAoD,EAAE,EAAO,WAAW,CAAC,UAAU,EAAE,EAAO,MAAM,CAAA,CAAE,CAChH,KAAK,mBAGL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAc,GAC7B,UAAW,CAAC,eAAe,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAC,mHAAmH,CAAC,CACjN,aAAW,kCAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,4BAElB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,SAAS,EAAE,EAAO,MAAM,CAAG,cAAgB,eAAe,gBAAgB,CAAC,CAAE,cAAY,SAC1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAU,8HACV,cAAY,gBAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,2CAEnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,CAAC,iCAAiC,EAAE,EAAO,IAAI,CAAC,qCAAqC,CAAC,UAClG,GAAS,MAAQ,gBAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,YAAY,EAAE,EAAO,SAAS,CAAC,gBAAgB,CAAC,UAC5D,EAAU,CAAA,EAAG,EAAQ,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAG,wBAOvD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,sCAAsC,EAAE,EAAO,UAAU,CAAC,WAAW,CAAC,CAClF,KAAK,UACL,aAAW,0BAEV,GAAY,GAAG,CAAC,AAAC,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,IAAM,EAAe,EAAK,EAAE,EACrC,KAAK,MACL,gBAAe,IAAgB,EAAK,EAAE,CACtC,gBAAe,CAAA,EAAG,EAAK,EAAE,CAAC,MAAM,CAAC,CACjC,UAAW,CAAC,yKAAyK,EAAE,IAAgB,EAAK,EAAE,CAAG,yBAA2B,CAAA,EAAG,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAC5S,WAEH,EAAK,IAAI,CACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAK,KAAK,KATZ,EAAK,EAAE,KAelB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6CAEb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,GAAK,KAAK,GAAG,CAAC,GAAK,EAAI,MAC9C,UAAW,CAAC,8BAA8B,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAC,4HAA4H,CAAC,CACzO,aAAW,oBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,cAErB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAQ,GAAK,KAAK,GAAG,CAAC,EAAG,EAAI,MAC5C,UAAW,CAAC,8BAA8B,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAC,4HAA4H,CAAC,CACzO,aAAW,mBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,SAAS,EAAE,EAAO,MAAM,CAAG,cAAgB,eAAe,gBAAgB,CAAC,CAAE,cAAY,SAG1G,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAe,WAC9B,UAAW,CAAC,yLAAyL,EAAkB,YAAhB,EAA4B,2BAA6B,CAAA,EAAG,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CACvR,aAAW,8BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gBACpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,UAIR,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAe,WAC9B,UAAW,CAAC,2QAA2Q,CAAC,CACxR,aAAW,8BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,8BACpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,mBAIrC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAc,GAC7B,SAAU,CAAC,GAAqC,IAA1B,EAAQ,MAAM,CAAC,MAAM,CAC3C,UAAU,wTACV,aAAW,2BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,8BACpB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,cAIrC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,EAAkB,CAAC,GAClC,UAAW,CAAC,yBAAyB,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,mHAAmH,CAAC,CACjM,aAAW,YACX,gBAAe,WAEf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,oBAMtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,GAAkB,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,CAAC,EAAG,EAC/D,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,KAAM,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,EAAG,EAAG,CAAC,EAAG,EAC5D,UAAW,CAAC,8CAA8C,EAAE,EAAO,WAAW,CAAC,UAAU,EAAE,EAAO,MAAM,CAAC,UAAU,CAAC,UAEpH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBAAgB,KAAK,UAAU,aAAW,0BACtD,GAAY,GAAG,CAAE,AAAD,GACf,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,KAAQ,EAAe,EAAK,EAAE,EAAG,GAAkB,EAAQ,EACpE,KAAK,MACL,gBAAe,IAAgB,EAAK,EAAE,CACtC,UAAW,CAAC,6GAA6G,EAAE,IAAgB,EAAK,EAAE,CAAG,yBAA2B,CAAA,EAAG,EAAO,IAAI,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAChN,WAEH,EAAK,IAAI,CACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAK,KAAK,KARZ,EAAK,EAAE,SAiBvB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,UAAW,GAAO,SAAS,CAC3B,YAAa,GAAO,WAAW,CAC/B,YAAa,GAAO,WAAW,CAC/B,IAAK,EAAQ,GAAG,CAChB,KAAM,EAAQ,WAAW,CACzB,WAAY,GAAO,UAAU,CAC7B,OAAQ,EACR,YAAa,IAAM,GAAO,SAAS,CAAG,GAAO,KAAK,GAAK,GAAO,IAAI,GAClE,OAAQ,GAAO,IAAI,CACnB,SAAU,GACV,YAAa,AAAC,GAAQ,EAAW,GAAQ,EAAO,CAAE,GAAG,CAAI,KAAE,CAAI,EAAI,GACnE,aAAc,IAAM,EAAW,GAAQ,EAAO,CAAE,GAAG,CAAI,CAAE,YAAa,CAAC,EAAK,WAAW,AAAC,EAAI,KAKhG,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,GAAG,eACH,UAAU,8BACV,KAAK,OACL,aAAW,4BAEX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,eAAe,CAAA,CAAC,KAAK,iBACH,YAAhB,GAA6B,GAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,GAAG,gBACH,KAAK,WACL,kBAAgB,cAChB,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,KAAsB,CAAhB,AAAkB,QAAS,CAAE,EACnC,EADuC,QAC7B,iDAGV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,yBAAyB,EAAE,EAAO,WAAW,CAAC,UAAU,EAAE,EAAO,MAAM,CAAC,+BAA+B,CAAC,CAAE,KAAK,eAAe,cAAY,iBACzJ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+BACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oDACZ,MAAM,IAAI,CAAC,CAAE,OAAQ,KAAK,IAAI,CAAC,GAAgB,GAAG,GAAG,CAAC,CAAC,EAAG,AAAd,IAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAY,UAAW,CAAC,iCAAiC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAE,MAAO,CAAE,SAAU,CAAA,EAAG,CAAC,EAAW,GAAK,GAAA,CAAG,CAAI,EAAK,EAAE,CAAC,AAAC,WAAI,EAAI,GAArI,SAMhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBAAuB,KAAK,OAAO,aAAW,yBAC1D,EAAQ,MAAM,CAAC,GAAG,CAAC,CAAC,EAAO,IAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAC,4BAA4B,EAAE,EAAO,MAAM,CAAC,aAAa,CAAC,CACtE,KAAK,WACL,aAAY,CAAC,MAAM,EAAE,EAAa,EAAE,EAAE,EAAE,EAAM,IAAI,CAAA,CAAE,WAGpD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,wCAAwC,EAAE,EAAO,WAAW,CAAC,UAAU,EAAE,EAAO,MAAM,CAAC,6BAA6B,CAAC,WACpI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,+BAA+B,EAAE,EAAO,IAAI,CAAC,SAAS,CAAC,UAAG,EAAM,IAAI,GACrF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAY,EAAM,EAAE,CAAE,CAAE,KAAM,CAAC,EAAM,IAAI,AAAC,GACzD,UAAW,CAAC,4JAA4J,EAAE,EAAM,IAAI,CAAG,2BAA6B,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CAChQ,aAAY,CAAA,EAAG,EAAM,IAAI,CAAG,SAAW,OAAO,CAAC,EAAE,EAAM,IAAI,CAAA,CAAE,CAC7D,eAAc,EAAM,IAAI,UACzB,MAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAY,EAAM,EAAE,CAAE,CAAE,KAAM,CAAC,EAAM,IAAI,AAAC,GACzD,UAAW,CAAC,4JAA4J,EAAE,EAAM,IAAI,CAAG,yBAA2B,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CAC9P,aAAY,CAAA,EAAG,EAAM,IAAI,CAAG,SAAW,OAAO,CAAC,EAAE,EAAM,IAAI,CAAA,CAAE,CAC7D,eAAc,EAAM,IAAI,UACzB,MAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAY,EAAM,EAAE,CAAE,CAAE,MAAO,CAAC,EAAM,KAAM,AAAD,GAC1D,UAAW,CAAC,2JAA2J,EAAE,EAAM,KAAK,CAAG,wBAA0B,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CAC7P,aAAY,CAAA,EAAG,EAAM,KAAK,CAAG,SAAW,MAAM,CAAC,EAAE,EAAM,IAAI,CAAC,cAAc,CAAC,CAC3E,eAAc,EAAM,KAAK,UAC1B,YAOL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,OAAO,EAAE,EAAO,EAAE,CAAC,SAAS,CAAC,UAC3C,EAAM,KAAK,CAAC,GAAG,CAAC,AAAC,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,4FACV,MAAO,CACL,KAAM,CAAA,EAAI,EAAK,SAAS,GAAG,CAAc,IAAI,CAAC,CAAC,CAC/C,MAAO,CAAA,EAAI,EAAK,WAAW,CA/apC,EA+auC,CAAc,IAAI,CAAC,CAAC,CAClD,gBAAiB,CAAkB,CAAC,EAAM,KAAK,CAAoC,EAAI,SACzF,EACA,KAAK,SACL,SAAU,EACV,aAAY,CAAC,MAAM,EAAE,EAAK,IAAI,CAAA,CAAE,WAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,iBAAiB,EAAE,EAAO,MAAM,CAAG,cAAgB,cAAA,CAAe,GACnF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,uCAAuC,EAAE,EAAO,MAAM,CAAG,gBAAkB,aAAa,SAAS,CAAC,UAAG,EAAK,IAAI,KAZ1H,EAAK,EAAE,OAxCb,EAAM,EAAE,GA4DjB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAS,CAAC,MAAM,EAAE,CAAC,GAAS,OAAO,QAAU,CAAC,EAAI,EAAA,CAAG,EACpE,UAAW,CAAC,kBAAkB,EAAE,EAAO,IAAI,CAAC,UAAU,EAAE,EAAO,MAAM,CAAC,wCAAwC,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,OAAO,EAAE,EAAO,SAAS,CAAC,uHAAuH,CAAC,CACxS,aAAW,0BAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,YAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAU,sBAzF1B,WA+FS,UAAhB,GAA2B,GAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,GAAG,cACH,KAAK,WACL,kBAAgB,YAChB,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,KAAsB,CAAhB,AAAkB,QAAS,CAAE,EACnC,EADuC,QAC7B,2GAET,EAAQ,MAAM,CAAC,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,CAAC,sCAAsC,EAAE,EAAO,IAAI,CAAC,iCAAiC,EAAE,EAAO,MAAM,CAAC,6BAA6B,CAAC,CAC/I,KAAK,QACL,aAAY,CAAA,EAAG,EAAM,IAAI,CAAC,cAAc,CAAC,WAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,mCAAmC,EAAE,EAAO,IAAI,CAAC,mDAAmD,CAAC,UAAG,EAAM,IAAI,GACnI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDAAgD,KAAK,SAAS,aAAY,CAAA,EAAG,EAAM,IAAI,CAAC,OAAO,CAAC,CAAE,gBAAe,KAAK,KAAK,CAAgB,IAAf,EAAM,MAAM,EAAS,gBAAe,EAAG,gBAAe,cAC/L,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,iBAAiB,EAAE,EAAO,UAAU,CAAC,aAAa,CAAC,GACpE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oHAAoH,MAAO,CAAE,OAAQ,CAAA,EAAkB,IAAf,EAAM,MAAM,CAAO,CAAC,CAAC,AAAC,OAE/K,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,oCAAoC,EAAE,EAAO,SAAS,CAAC,eAAe,CAAC,WAAG,KAAK,KAAK,CAAC,CAAC,EAAM,MAAM,EAAG,CAAC,CAAI,KAAK,SAChI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kCACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAY,EAAM,EAAE,CAAE,CAAE,KAAM,CAAC,EAAM,IAAI,AAAC,GACzD,UAAW,CAAC,yIAAyI,EAAE,EAAM,IAAI,CAAG,2BAA6B,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CAC7O,aAAY,CAAA,EAAG,EAAM,IAAI,CAAG,SAAW,OAAO,CAAC,EAAE,EAAM,IAAI,CAAA,CAAE,CAC7D,eAAc,EAAM,IAAI,UACzB,MAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAY,EAAM,EAAE,CAAE,CAAE,KAAM,CAAC,EAAM,IAAK,AAAD,GACxD,UAAW,CAAC,yIAAyI,EAAE,EAAM,IAAI,CAAG,yBAA2B,CAAA,EAAG,EAAO,UAAU,CAAC,CAAC,EAAE,EAAO,SAAS,CAAA,CAAE,CAAA,CAAE,CAC3O,aAAY,CAAA,EAAG,EAAM,IAAI,CAAG,SAAW,OAAO,CAAC,EAAE,EAAM,IAAI,CAAA,CAAE,CAC7D,eAAc,EAAM,IAAI,UACzB,WAzBE,EAAM,EAAE,IAXb,SA6CS,YAAhB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CAET,GAAG,gBACH,KAAK,WACL,kBAAgB,eAChB,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,KAAsB,CAAhB,AAAkB,QAAS,CAAE,EACnC,EADuC,QAC7B,uCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,OAAQ,EACR,UAAW,GAAS,GACpB,eAAgB,EAAU,AAAC,IAEzB,IAAM,EAAa,EAAQ,MAAM,CAAC,MAAM,CAAG,EAAa,MAAM,CACxD,EAAW,EAAY,EAAO,KAAK,CAAE,QAAS,GAC9C,EAAU,EACd,EAAO,KAAK,CACZ,EACe,CAAf,CAAsB,QAAQ,IAAE,EAAQ,GAAG,EAG5C,EAA6C,QAAQ,CAAG,EAAO,QAAQ,CACxE,EAAS,KAAK,CAAG,CAAC,EAAQ,CAC1B,EAAW,GAAQ,EAAO,CACxB,GAAG,CAAI,CACP,OAAQ,IAAI,EAAK,MAAM,CAAE,EAAS,AACpC,EAAI,GAEJ,EAAe,UACjB,OAAI,KA9BF,YAmCP,CAAC,GAA2B,YAAhB,GACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,UAAU,uDAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,yEAAyE,EAAE,EAAO,IAAI,CAAC,iCAAiC,CAAC,CAAE,cAAY,gBACtJ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAW,CAAC,sBAAsB,EAAE,EAAO,SAAS,CAAA,CAAE,KAE/D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAA,EAAG,EAAO,SAAS,CAAC,gCAAgC,CAAC,UAAE,oBACrE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,GAC/B,UAAU,yNACX,gCAUX,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAW,CAAC,8DAA8D,EAAE,EAAO,WAAW,CAAC,UAAU,EAAE,EAAO,MAAM,CAAA,CAAE,CAAE,KAAK,wBACvI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,2DAA2D,EAAE,EAAO,SAAS,CAAA,CAAE,WAC9F,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,6BAAmB,SAAO,KAAK,KAAK,CAAQ,IAAP,GAAY,OAChE,GACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAmB,cAAY,gBAAO,MACtD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,EAAQ,MAAM,CAAC,MAAM,CAAC,aAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,cAAY,gBAAO,MACzB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,GAAe,UAAF,OAI1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,0BAA0B,EAAE,EAAO,SAAS,CAAA,CAAE,WAAE,YACrD,IACV,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAK,wBACL,OAAO,SACP,IAAI,sBACJ,UAAU,0EACX,mBAOL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,KAAsB,CAAhB,AAAkB,QAAS,CAAE,EACnC,EADuC,QAC7B,uFACV,KAAK,SACL,aAAW,OACX,kBAAgB,0BAEhB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,MAAO,EAAG,EAAG,CAAE,EAAI,CAAE,MAAO,GAAK,EAAG,EAAG,EAClE,QAAS,CAAE,MAAO,EAAG,EAAG,CAAE,EAC1B,KAAM,EAAgB,CAAE,MAAO,EAAG,EAAG,CAAE,EAAI,CAAE,MAAO,GAAK,EAAG,EAAG,EAC/D,UAAW,CAAC,gDAAgD,EAAE,EAAO,WAAW,CAAC,kCAAkC,EAAE,EAAO,MAAM,CAAA,CAAE,WAEpI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,GAC/B,UAAW,CAAC,+CAA+C,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,8HAA8H,CAAC,CAClO,aAAW,wBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAC,CAAA,CAAC,UAAU,cAEf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,GAAG,iBAAiB,UAAW,CAAC,8BAA8B,EAAE,EAAO,IAAI,CAAC,KAAK,CAAC,UAAE,cACxF,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAA,EAAG,EAAO,SAAS,CAAC,qBAAqB,CAAC,UAAE,iCAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2CACZ,CACC,CAAE,GAAI,SAAU,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,0BAA4B,MAAO,SAAU,KAAM,iBAAkB,SAAU,0BAA2B,EAC/I,CAAE,GAAI,SAAU,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,0BAA4B,MAAO,SAAU,KAAM,eAAgB,SAAU,2BAA4B,EACjJ,CAAE,GAAI,WAAY,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0BAA4B,MAAO,WAAY,KAAM,mBAAoB,SAAU,2BAA4B,EACxJ,CAAE,GAAI,cAAe,KAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,0BAA4B,MAAO,cAAe,KAAM,iBAAkB,SAAU,+BAAgC,EACpK,CAAC,GAAG,CAAC,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,KACF,GAEH,EADmB,EAA8B,EADrC,KAED,SAD2B,EAAI,EAAE,CAAqB,aAAe,aAGlF,GAAgB,GACD,eAAe,CAA1B,EAAI,EAAE,EACR,EAAe,UAEnB,EACA,UAAW,CAAC,+DAA+D,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,OAAO,EAAE,EAAO,WAAW,CAAC,0IAA0I,CAAC,CACxR,aAAY,CAAA,EAAG,EAAI,KAAK,CAAC,EAAE,EAAE,EAAI,IAAI,CAAA,CAAE,WAEvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,qEAAqE,EAAE,EAAI,QAAQ,CAAC,yDAAyD,CAAC,CAAE,cAAY,gBAC1K,EAAI,IAAI,GAEX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAE,EAAO,IAAI,CAAC,qBAAqB,CAAC,UAAG,EAAI,KAAK,GAC7E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,uBAAuB,EAAE,EAAO,SAAS,CAAC,gBAAgB,CAAC,UAAG,EAAI,IAAI,KAlBlF,EAAI,EAAE,YA4BzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UACb,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,QAAS,CAAE,EAAI,CAAE,QAAS,CAAE,EACvD,QAAS,CAAE,QAAS,CAAE,EACtB,KAAsB,CAAhB,AAAkB,QAAS,CAAE,EACnC,EADuC,QAC7B,uFACV,KAAK,SACL,aAAW,OACX,kBAAgB,wBAEhB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,QAAS,EAAgB,CAAE,MAAO,EAAG,EAAG,CAAE,EAAI,CAAE,MAAO,GAAK,EAAG,EAAG,EAClE,QAAS,CAAE,MAAO,EAAG,EAAG,CAAE,EAC1B,KAAM,EAAgB,CAAE,MAAO,EAAG,EAAG,CAAE,EAAI,CAAE,MAAO,GAAK,EAAG,EAAG,EAC/D,UAAW,CAAC,gDAAgD,EAAE,EAAO,WAAW,CAAC,kCAAkC,EAAE,EAAO,MAAM,CAAA,CAAE,WAEpI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAc,GAC7B,UAAW,CAAC,+CAA+C,EAAE,EAAO,SAAS,CAAC,OAAO,EAAE,EAAO,IAAI,CAAC,8HAA8H,CAAC,CAClO,aAAW,wBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAC,CAAA,CAAC,UAAU,cAEf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,GAAG,eAAe,UAAW,CAAC,6BAA6B,EAAE,EAAO,IAAI,CAAC,aAAa,CAAC,UAAE,mBAC7F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,OAC/B,SAAU,EACV,UAAW,CAAC,2CAA2C,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,OAAO,EAAE,EAAO,WAAW,CAAC,gKAAgK,CAAC,CAC1R,mBAAiB,qBAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAE,EAAO,IAAI,CAAC,qBAAqB,CAAC,UAAE,uBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,GAAG,WAAW,UAAW,CAAC,mBAAmB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,6BAE1E,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAgB,OAC/B,SAAU,EACV,UAAW,CAAC,2CAA2C,EAAE,EAAO,IAAI,CAAC,QAAQ,EAAE,EAAO,MAAM,CAAC,OAAO,EAAE,EAAO,WAAW,CAAC,gKAAgK,CAAC,CAC1R,mBAAiB,qBAEjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,YAAY,EAAE,EAAO,IAAI,CAAC,qBAAqB,CAAC,UAAE,qBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,GAAG,WAAW,UAAW,CAAC,mBAAmB,EAAE,EAAO,SAAS,CAAA,CAAE,UAAE,qCAG3E,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAC,oDAAoD,EAAE,EAAO,SAAS,CAAA,CAAE,CAAE,KAAK,SAAS,YAAU,mBACjH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,uBAAuB,cAAY,SACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAU,gCAW9C"}