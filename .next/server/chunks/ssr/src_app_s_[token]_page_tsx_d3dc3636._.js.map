{"version":3,"sources":["../../../../src/app/s/%5Btoken%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { motion } from 'framer-motion';\nimport { Loader2, AlertCircle, CheckCircle, Home } from 'lucide-react';\n\ninterface ChatMessage {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: number;\n  metadata?: {\n    model?: string;\n    tokens?: number;\n    draftUpdates?: string[];\n  };\n}\n\ninterface SavedSession {\n  sessionId: string;\n  draft: {\n    brief: {\n      problem: string;\n      audience: string;\n      currentWorkaround: string;\n      desiredOutcome: string;\n      constraints: string[];\n    };\n    prd: {\n      goals: string[];\n      nonGoals: string[];\n      keyWorkflows: string[];\n      scopeMvp: string[];\n      risks: string[];\n      successMetrics: string[];\n    };\n    prototype: {\n      screens: string[];\n      primaryFlow: string;\n      dataInputs: string[];\n      notes: string;\n    };\n    designDirection: {\n      toneWords: string[];\n      uiDensity: 'compact' | 'comfortable' | 'spacious';\n      typographyNotes: string;\n      componentRules: string[];\n      selectedTheme?: string;\n    };\n  };\n  chatHistory: ChatMessage[];\n  eventLog: unknown[];\n  createdAt: number;\n  expiresAt: number;\n}\n\ntype LoadState = 'loading' | 'success' | 'error' | 'notfound' | 'expired';\n\nexport default function SavedSessionPage() {\n  const params = useParams();\n  const router = useRouter();\n  const token = params.token as string;\n\n  const [loadState, setLoadState] = useState<LoadState>('loading');\n  const [session, setSession] = useState<SavedSession | null>(null);\n  const [error, setError] = useState<string>('');\n\n  useEffect(() => {\n    async function loadSession() {\n      try {\n        const response = await fetch(`/api/save?token=${encodeURIComponent(token)}`);\n        const data = await response.json();\n\n        if (response.ok && data.success) {\n          setSession(data);\n          setLoadState('success');\n\n          // Store in localStorage for the session brain to pick up\n          const sessionState = {\n            sessionId: data.sessionId,\n            createdAt: data.createdAt,\n            lastModified: Date.now(),\n            draft: data.draft,\n            chatHistory: data.chatHistory || [],\n            eventLog: data.eventLog || [],\n            notifications: [],\n          };\n          localStorage.setItem('openclaw_session', JSON.stringify(sessionState));\n        } else if (response.status === 404) {\n          setLoadState('notfound');\n          setError('This saved session could not be found.');\n        } else if (response.status === 410) {\n          setLoadState('expired');\n          setError('This saved session has expired.');\n        } else {\n          setLoadState('error');\n          setError(data.error || 'Failed to load session');\n        }\n      } catch (err) {\n        setLoadState('error');\n        setError('Network error. Please try again.');\n      }\n    }\n\n    if (token) {\n      loadSession();\n    }\n  }, [token]);\n\n  const handleGoHome = () => {\n    router.push('/');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 flex items-center justify-center p-6\">\n      <div\n        className=\"absolute inset-0 bg-cover bg-center bg-no-repeat opacity-30\"\n        style={{\n          backgroundImage: 'url(https://2oczblkb3byymav8.public.blob.vercel-storage.com/aurora.jpeg)',\n        }}\n      />\n      <div className=\"absolute inset-0 bg-black/50\" />\n\n      <motion.div\n        className=\"relative z-10 max-w-md w-full\"\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.3 }}\n      >\n        <div className=\"bg-white/5 backdrop-blur-xl rounded-3xl border border-white/10 p-8\">\n          {loadState === 'loading' && (\n            <div className=\"text-center\">\n              <Loader2 className=\"w-12 h-12 text-purple-400 animate-spin mx-auto mb-4\" />\n              <h1 className=\"text-white text-xl font-semibold mb-2\">Loading your draft...</h1>\n              <p className=\"text-white/50 text-sm\">Please wait while we retrieve your saved session.</p>\n            </div>\n          )}\n\n          {loadState === 'success' && session && (\n            <div className=\"text-center\">\n              <div className=\"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n                <CheckCircle className=\"w-8 h-8 text-green-400\" />\n              </div>\n              <h1 className=\"text-white text-xl font-semibold mb-2\">Draft Loaded!</h1>\n              <p className=\"text-white/50 text-sm mb-6\">\n                Your saved project draft has been restored to your session.\n              </p>\n\n              {/* Brief preview */}\n              <div className=\"bg-white/5 rounded-xl p-4 mb-6 text-left\">\n                <h3 className=\"text-white/70 text-xs uppercase tracking-wider mb-3\">Brief Summary</h3>\n                {session.draft.brief.problem && (\n                  <div className=\"mb-2\">\n                    <span className=\"text-white/40 text-xs\">Building:</span>\n                    <p className=\"text-white/80 text-sm truncate\">{session.draft.brief.problem}</p>\n                  </div>\n                )}\n                {session.draft.brief.audience && (\n                  <div>\n                    <span className=\"text-white/40 text-xs\">For:</span>\n                    <p className=\"text-white/80 text-sm truncate\">{session.draft.brief.audience}</p>\n                  </div>\n                )}\n              </div>\n\n              <button\n                onClick={handleGoHome}\n                className=\"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium py-3 px-6 rounded-full hover:opacity-90 transition-opacity\"\n              >\n                <Home className=\"w-4 h-4\" />\n                Go to OpenClaw-OS\n              </button>\n            </div>\n          )}\n\n          {(loadState === 'error' || loadState === 'notfound' || loadState === 'expired') && (\n            <div className=\"text-center\">\n              <div className=\"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4\">\n                <AlertCircle className=\"w-8 h-8 text-red-400\" />\n              </div>\n              <h1 className=\"text-white text-xl font-semibold mb-2\">\n                {loadState === 'notfound' && 'Session Not Found'}\n                {loadState === 'expired' && 'Session Expired'}\n                {loadState === 'error' && 'Error Loading Session'}\n              </h1>\n              <p className=\"text-white/50 text-sm mb-6\">{error}</p>\n\n              <button\n                onClick={handleGoHome}\n                className=\"w-full flex items-center justify-center gap-2 bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-6 rounded-full transition-colors\"\n              >\n                <Home className=\"w-4 h-4\" />\n                Start Fresh\n              </button>\n            </div>\n          )}\n\n          {/* Expiration notice for successful loads */}\n          {loadState === 'success' && session && (\n            <p className=\"text-white/30 text-xs text-center mt-4\">\n              This link expires {new Date(session.expiresAt).toLocaleDateString()}\n            </p>\n          )}\n        </div>\n      </motion.div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}