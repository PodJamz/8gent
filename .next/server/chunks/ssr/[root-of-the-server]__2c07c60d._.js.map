{"version":3,"sources":["../../../../node_modules/.pnpm/%40swc%2Bhelpers%400.5.15/node_modules/%40swc/helpers/cjs/_interop_require_default.cjs","../../../../src/components/profile/ProfileHero.tsx/__nextjs-internal-proxy.mjs","../../../../src/lib/sanitize-server.ts"],"sourcesContent":["\"use strict\";\n\nfunction _interop_require_default(obj) {\n    return obj && obj.__esModule ? obj : { default: obj };\n}\nexports._ = _interop_require_default;\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/profile/ProfileHero.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/profile/ProfileHero.tsx\",\n    \"default\",\n);\n","/**\n * Server-Safe HTML Sanitization\n *\n * Provides HTML sanitization that works in both server and client contexts.\n * Uses a whitelist approach for allowed HTML tags and attributes.\n *\n * For blog/vault content from MDX files, this is defense-in-depth since\n * the content is from trusted local files processed at build time.\n */\n\n// Allowed HTML tags (common in blog/MDX content)\nconst ALLOWED_TAGS = new Set([\n  // Text content\n  'p', 'span', 'div', 'br', 'hr',\n  // Headings\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\n  // Lists\n  'ul', 'ol', 'li',\n  // Formatting\n  'strong', 'b', 'em', 'i', 'u', 's', 'strike', 'del', 'ins', 'mark',\n  'small', 'sub', 'sup',\n  // Links and media\n  'a', 'img', 'figure', 'figcaption',\n  // Code\n  'pre', 'code', 'kbd', 'samp', 'var',\n  // Tables\n  'table', 'thead', 'tbody', 'tfoot', 'tr', 'th', 'td', 'caption',\n  // Quotes and definitions\n  'blockquote', 'q', 'cite', 'abbr', 'dfn',\n  // Other\n  'details', 'summary', 'time', 'address', 'article', 'section', 'aside',\n  'header', 'footer', 'nav', 'main',\n]);\n\n// Allowed attributes per tag (or * for all tags)\nconst ALLOWED_ATTRIBUTES: Record<string, Set<string>> = {\n  '*': new Set(['class', 'id', 'style', 'title', 'lang', 'dir', 'tabindex', 'role', 'aria-label', 'aria-hidden', 'aria-describedby']),\n  'a': new Set(['href', 'target', 'rel', 'download']),\n  'img': new Set(['src', 'alt', 'width', 'height', 'loading', 'decoding']),\n  'time': new Set(['datetime']),\n  'abbr': new Set(['title']),\n  'td': new Set(['colspan', 'rowspan']),\n  'th': new Set(['colspan', 'rowspan', 'scope']),\n  'ol': new Set(['start', 'type', 'reversed']),\n  'li': new Set(['value']),\n  'code': new Set(['data-language', 'data-theme']),\n  'pre': new Set(['data-language', 'data-theme']),\n};\n\n// Dangerous URL protocols\nconst DANGEROUS_PROTOCOLS = /^(javascript|vbscript|data):/i;\n\n/**\n * Check if a URL is safe (not javascript: or other dangerous protocols)\n */\nfunction isSafeUrl(url: string): boolean {\n  if (!url) return true;\n  const trimmed = url.trim().toLowerCase();\n  return !DANGEROUS_PROTOCOLS.test(trimmed);\n}\n\n/**\n * Escape HTML entities in a string\n */\nfunction escapeHtml(str: string): string {\n  const escapeMap: Record<string, string> = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n  };\n  return str.replace(/[&<>\"']/g, (char) => escapeMap[char] || char);\n}\n\n/**\n * Simple HTML tag parser for server-side sanitization\n * This is a lightweight alternative to full DOM parsing\n */\nfunction sanitizeHtmlServer(html: string): string {\n  // Replace dangerous script and event handlers\n  let sanitized = html\n    // Remove script tags entirely\n    .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\n    // Remove style tags (can contain expressions in IE)\n    .replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, '')\n    // Remove on* event handlers\n    .replace(/\\s+on\\w+\\s*=\\s*(\"[^\"]*\"|'[^']*'|[^\\s>]*)/gi, '')\n    // Remove javascript: URLs in href/src\n    .replace(/(href|src)\\s*=\\s*[\"']?\\s*javascript:[^\"'>\\s]*/gi, '$1=\"\"')\n    // Remove data: URLs that could be dangerous\n    .replace(/(href|src)\\s*=\\s*[\"']?\\s*data:text\\/html[^\"'>\\s]*/gi, '$1=\"\"')\n    // Remove expression() in styles (IE vulnerability)\n    .replace(/expression\\s*\\(/gi, 'blocked(')\n    // Remove -moz-binding (Firefox XBL vulnerability)\n    .replace(/-moz-binding\\s*:/gi, '-blocked:');\n\n  return sanitized;\n}\n\n/**\n * Sanitize HTML content for safe rendering\n * Works in both server and client contexts\n *\n * @param dirty - The potentially unsafe HTML string\n * @returns Sanitized HTML string safe for rendering\n */\nexport function sanitizeHtmlSafe(dirty: string): string {\n  if (!dirty) return '';\n\n  // Server-side sanitization\n  if (typeof window === 'undefined') {\n    return sanitizeHtmlServer(dirty);\n  }\n\n  // Client-side: use DOMPurify if available\n  try {\n    // Dynamic import to avoid bundling issues\n    const DOMPurify = require('dompurify');\n    return DOMPurify.sanitize(dirty, {\n      ALLOWED_TAGS: Array.from(ALLOWED_TAGS),\n      ALLOWED_ATTR: [\n        ...ALLOWED_ATTRIBUTES['*'],\n        ...ALLOWED_ATTRIBUTES['a'],\n        ...ALLOWED_ATTRIBUTES['img'],\n        'datetime', 'colspan', 'rowspan', 'scope', 'start', 'type', 'reversed', 'value',\n        'data-language', 'data-theme',\n      ],\n    });\n  } catch {\n    // Fallback to server-side sanitization\n    return sanitizeHtmlServer(dirty);\n  }\n}\n\n/**\n * Create sanitized dangerouslySetInnerHTML prop (server-safe)\n * @param dirty - The potentially unsafe HTML string\n * @returns Object suitable for dangerouslySetInnerHTML prop\n */\nexport function createSafeHtmlServer(dirty: string): { __html: string } {\n  return { __html: sanitizeHtmlSafe(dirty) };\n}\n"],"names":[],"mappings":"iZAKA,EAAQ,CAAC,CAHT,EAGY,OAHsB,AAAzB,CAA4B,EACjC,OAAO,GAAO,EAAI,UAAU,CAAG,EAAM,CAAE,QAAS,CAAI,CACxD,wDCFe,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAuB,AAAvB,EACX,WAAa,MAAM,AAAI,MAAM,wSAA0S,EACvU,uEACA,iEAHW,CAAA,EADf,AACe,EADf,CAAA,CAAA,OACe,uBAAA,AAAuB,EAClC,WAAa,MAAM,AAAI,MAAM,oRAAsR,EACnT,mDACA,iGCuIG,SAAS,EAAqB,CAAa,QAChD,MAAO,CAAE,OAjCT,CAD+B,AAkCd,EAAiB,CAjC9B,CAAC,CA3BW,AA0B4B,AAKhB,EA7BzB,EADD,EA0BU,GAzBF,CAAC,wBADqB,8BACkC,GAChE,CACC,OAAO,CAAC,2CAD2C,QACS,GAC7D,CACC,OAAO,CAAC,mBADmB,0BAC2B,GACvD,CACC,OAAO,CAAC,6BAD6B,qBACsB,QAC5D,CACC,OAAO,CAAC,mCADmC,mBACoB,QAChE,CACC,OAAO,CAAC,oBAAqB,WAC9B,CACC,OAAO,CAAC,EAH0C,mBAGpB,aAad,EAiCsB,CAC3C,IAhDsD","ignoreList":[0,1]}