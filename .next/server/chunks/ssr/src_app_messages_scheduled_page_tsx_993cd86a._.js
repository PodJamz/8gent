module.exports=[671322,a=>{"use strict";var b=a.i(499969),c=a.i(863050),d=a.i(567031),e=a.i(278739),f=a.i(233849),g=a.i(135981),h=a.i(677409),i=a.i(128002),j=a.i(282763),k=a.i(509183),l=a.i(342725),m=a.i(390341),n=a.i(496760),o=a.i(887080),p=a.i(662482),q=a.i(745682),r=a.i(239335),s=a.i(189198),t=a.i(368114),u=a.i(374570);let v={whatsapp:"WhatsApp",imessage:"iMessage",telegram:"Telegram",slack:"Slack",discord:"Discord",email:"Email"},w={one_time:{icon:j.Clock,label:"One-time",color:"text-blue-400"},recurring:{icon:l.Repeat,label:"Recurring",color:"text-emerald-400"},trigger:{icon:r.Bell,label:"Trigger",color:"text-amber-400"}},x={pending:{label:"Pending",color:"text-amber-400",bg:"bg-amber-500/20"},sending:{label:"Sending",color:"text-blue-400",bg:"bg-blue-500/20"},sent:{label:"Sent",color:"text-emerald-400",bg:"bg-emerald-500/20"},failed:{label:"Failed",color:"text-red-400",bg:"bg-red-500/20"},cancelled:{label:"Cancelled",color:"text-gray-400",bg:"bg-gray-500/20"}};function y({message:a,onCancel:c,onDelete:e,isCancelling:f,isDeleting:g}){let h=w[a.scheduleType],i=x[a.status],r=h?.icon||j.Clock;return(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:(0,t.cn)("p-1.5 rounded-lg bg-white/5",h?.color),children:(0,b.jsx)(r,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-white",children:a.title||"Scheduled Message"}),(0,b.jsx)("span",{className:(0,t.cn)("text-xs",h?.color),children:h?.label})]})]}),(0,b.jsx)("span",{className:(0,t.cn)("text-xs px-2 py-0.5 rounded-full",i?.color,i?.bg),children:i?.label})]}),(0,b.jsx)("div",{className:"mb-3 p-3 rounded-lg bg-black/20",children:(0,b.jsx)("p",{className:"text-sm text-white/80 line-clamp-2",children:"ai_generated"===a.messageType?(0,b.jsx)("span",{className:"italic text-white/60",children:"AI will generate content at send time"}):a.content})}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-white/50 mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(k.Calendar,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:function(a){if(!a)return"Not scheduled";let b=new Date(a),c=new Date,d=b.toDateString()===c.toDateString(),e=new Date(c);e.setDate(e.getDate()+1);let f=b.toDateString()===e.toDateString(),g=b.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return d?`Today at ${g}`:f?`Tomorrow at ${g}`:b.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}(a.nextSendAt)})]}),a.cronExpression&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.Repeat,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:a.cronExpression})]}),a.sendCount>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Send,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:["Sent ",a.sendCount,"x"]})]})]}),a.targetPlatforms&&a.targetPlatforms.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:a.targetPlatforms.map(a=>(0,b.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-white/60",children:v[a]||a},a))}),a.error&&(0,b.jsxs)("div",{className:"mb-3 p-2 rounded-lg bg-red-500/10 border border-red-500/20 flex items-start gap-2",children:[(0,b.jsx)(q.AlertCircle,{className:"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-xs text-red-200",children:a.error})]}),"pending"===a.status&&(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{onClick:c,disabled:f,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-white/70 bg-white/5 hover:bg-white/10 transition-colors disabled:opacity-50",children:[f?(0,b.jsx)(p.Loader2,{className:"w-3 h-3 animate-spin"}):(0,b.jsx)(o.X,{className:"w-3 h-3"}),"Cancel"]}),(0,b.jsx)("button",{onClick:e,disabled:g,className:"flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors disabled:opacity-50",children:g?(0,b.jsx)(p.Loader2,{className:"w-3 h-3 animate-spin"}):(0,b.jsx)(m.Trash2,{className:"w-3 h-3"})})]}),("sent"===a.status||"cancelled"===a.status||"failed"===a.status)&&(0,b.jsxs)("button",{onClick:e,disabled:g,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 transition-colors disabled:opacity-50",children:[g?(0,b.jsx)(p.Loader2,{className:"w-3 h-3 animate-spin"}):(0,b.jsx)(m.Trash2,{className:"w-3 h-3"}),"Delete"]})]})}function z({isOpen:a,onClose:e,onCreate:f,isCreating:g}){let[h,i]=(0,c.useState)(""),[k,m]=(0,c.useState)(""),[n,q]=(0,c.useState)("one_time"),[r,s]=(0,c.useState)(""),[u,v]=(0,c.useState)("09:00"),[w,x]=(0,c.useState)("0 9 * * *");return a?(0,b.jsx)(d.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:e,children:(0,b.jsxs)(d.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md bg-zinc-900 rounded-2xl border border-white/10 overflow-hidden max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-4 border-b border-white/10 flex items-center justify-between sticky top-0 bg-zinc-900 z-10",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Schedule Message"}),(0,b.jsx)("button",{onClick:e,className:"p-1 rounded-lg hover:bg-white/10 transition-colors",children:(0,b.jsx)(o.X,{className:"w-5 h-5 text-white/60"})})]}),(0,b.jsxs)("form",{onSubmit:a=>{let b;if(a.preventDefault(),h.trim()){if("one_time"===n&&r){let[a,c,d]=r.split("-").map(Number),[e,f]=u.split(":").map(Number);b=new Date(a,c-1,d,e,f).getTime()}f({content:h.trim(),scheduleType:n,scheduledFor:b,cronExpression:"recurring"===n?w:void 0,title:k.trim()||void 0,category:"custom"})}},className:"p-4 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:"Title (optional)"}),(0,b.jsx)("input",{type:"text",value:k,onChange:a=>m(a.target.value),placeholder:"e.g., Morning check-in",className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Message ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("textarea",{value:h,onChange:a=>i(a.target.value),placeholder:"What would you like 8gent to send?",rows:3,required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Schedule Type"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>q("one_time"),className:(0,t.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors","one_time"===n?"bg-primary text-primary-foreground":"bg-white/5 text-white/70 hover:bg-white/10"),children:[(0,b.jsx)(j.Clock,{className:"w-4 h-4"}),"One-time"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>q("recurring"),className:(0,t.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors","recurring"===n?"bg-primary text-primary-foreground":"bg-white/5 text-white/70 hover:bg-white/10"),children:[(0,b.jsx)(l.Repeat,{className:"w-4 h-4"}),"Recurring"]})]})]}),"one_time"===n&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Date ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"date",value:r,onChange:a=>s(a.target.value),min:new Date().toISOString().split("T")[0],required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white focus:outline-none focus:border-white/30 transition-colors"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Time ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"time",value:u,onChange:a=>v(a.target.value),required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white focus:outline-none focus:border-white/30 transition-colors"})]})]}),"recurring"===n&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:["Cron Expression ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:w,onChange:a=>x(a.target.value),placeholder:"0 9 * * *",required:!0,className:"w-full px-3 py-2 rounded-lg bg-white/5 border border-white/10 text-white placeholder-white/30 focus:outline-none focus:border-white/30 transition-colors"}),(0,b.jsx)("p",{className:"text-xs text-white/40 mt-1",children:"Example: 0 9 * * * = every day at 9:00 AM"})]}),(0,b.jsx)("button",{type:"submit",disabled:g||!h.trim(),className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-sm font-medium text-white bg-[hsl(142_70%_45%)] hover:bg-[hsl(142_70%_40%)] transition-colors disabled:opacity-50",children:g?(0,b.jsx)(p.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Clock,{className:"w-4 h-4"}),"Schedule Message"]})})]})]})}):null}function A(){let{user:a,isLoaded:k}=(0,u.useUser)(),l=a?.id||"",[m,n]=(0,c.useState)(!1),[o,r]=(0,c.useState)(!1),[t,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),C=(0,f.useQuery)(g.api.scheduledMessages.getUserScheduledMessages,l?{userId:l}:"skip"),D=(0,f.useMutation)(g.api.scheduledMessages.createScheduledMessage),E=(0,f.useMutation)(g.api.scheduledMessages.cancelScheduledMessage),F=(0,f.useMutation)(g.api.scheduledMessages.deleteScheduledMessage),G=async a=>{if(!l)return void B("Please sign in to schedule messages.");r(!0),B(null);try{await D({userId:l,content:a.content,messageType:"text",scheduleType:a.scheduleType,scheduledFor:a.scheduledFor,cronExpression:a.cronExpression,title:a.title,category:a.category}),n(!1)}catch(a){console.error("Failed to create scheduled message:",a),B("Failed to schedule message. Please try again.")}finally{r(!1)}},H=async a=>{v(a),B(null);try{await E({messageId:a})}catch(a){console.error("Failed to cancel message:",a),B("Failed to cancel message. Please try again.")}finally{v(null)}},I=async a=>{x(a),B(null);try{await F({messageId:a})}catch(a){console.error("Failed to delete message:",a),B("Failed to delete message. Please try again.")}finally{x(null)}},J=C?.filter(a=>"pending"===a.status)||[],K=C?.filter(a=>"pending"!==a.status)||[];return(0,b.jsxs)("div",{className:"min-h-screen bg-zinc-950",children:[(0,b.jsx)("header",{className:"sticky top-0 z-40 bg-zinc-950/80 backdrop-blur-xl border-b border-white/10",children:(0,b.jsxs)("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(s.default,{href:"/messages",className:"p-2 -ml-2 rounded-lg hover:bg-white/10 transition-colors","aria-label":"Back to messages",children:(0,b.jsx)(h.ChevronLeft,{className:"w-5 h-5 text-white"})}),(0,b.jsx)("h1",{className:"text-xl font-semibold text-white",children:"Scheduled"})]}),(0,b.jsx)("button",{onClick:()=>n(!0),className:"p-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:(0,b.jsx)(i.Plus,{className:"w-5 h-5"})})]})}),(0,b.jsxs)("main",{className:"max-w-lg mx-auto px-4 py-6",children:[A&&(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-xl bg-red-500/10 border border-red-500/20 flex items-start gap-3",children:[(0,b.jsx)(q.AlertCircle,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),(0,b.jsx)("p",{className:"text-sm text-red-200/80",children:A})]}),k&&C?(0,b.jsxs)("div",{className:"space-y-6",children:[J.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-sm font-medium text-white/60 uppercase tracking-wider mb-3",children:["Upcoming (",J.length,")"]}),(0,b.jsx)("div",{className:"space-y-3",children:(0,b.jsx)(e.AnimatePresence,{children:J.map(a=>(0,b.jsx)(y,{message:a,onCancel:()=>H(a.messageId),onDelete:()=>I(a.messageId),isCancelling:t===a.messageId,isDeleting:w===a.messageId},a.messageId))})})]}),K.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-sm font-medium text-white/60 uppercase tracking-wider mb-3",children:["History (",K.length,")"]}),(0,b.jsx)("div",{className:"space-y-3",children:(0,b.jsx)(e.AnimatePresence,{children:K.map(a=>(0,b.jsx)(y,{message:a,onCancel:()=>H(a.messageId),onDelete:()=>I(a.messageId),isCancelling:t===a.messageId,isDeleting:w===a.messageId},a.messageId))})})]}),0===J.length&&0===K.length&&(0,b.jsxs)(d.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center py-12",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/5 flex items-center justify-center",children:(0,b.jsx)(j.Clock,{className:"w-8 h-8 text-white/30"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No scheduled messages"}),(0,b.jsx)("p",{className:"text-sm text-white/50 mb-6",children:"Schedule messages to be sent at specific times or on a recurring basis."}),(0,b.jsxs)("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary/90 transition-colors",children:[(0,b.jsx)(i.Plus,{className:"w-4 h-4"}),"Schedule a Message"]})]})]}):(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(p.Loader2,{className:"w-6 h-6 text-white/50 animate-spin"})})]}),(0,b.jsx)(e.AnimatePresence,{children:m&&(0,b.jsx)(z,{isOpen:m,onClose:()=>n(!1),onCreate:G,isCreating:o})})]})}a.s(["default",()=>A])}];

//# sourceMappingURL=src_app_messages_scheduled_page_tsx_993cd86a._.js.map