{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/lib/watch/watch-utils.ts"],"sourcesContent":["/**\n * Watch Utilities\n * Animation helpers and time calculations for watch faces\n */\n\n// Get current time angles for watch hands\nexport function getTimeAngles(date: Date = new Date()): {\n  hours: number;\n  minutes: number;\n  seconds: number;\n  milliseconds: number;\n} {\n  const hours = date.getHours() % 12;\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const milliseconds = date.getMilliseconds();\n\n  // Calculate smooth angles (continuous movement)\n  const secondsWithMs = seconds + milliseconds / 1000;\n  const minutesWithSeconds = minutes + secondsWithMs / 60;\n  const hoursWithMinutes = hours + minutesWithSeconds / 60;\n\n  return {\n    hours: hoursWithMinutes * 30, // 360° / 12 hours = 30° per hour\n    minutes: minutesWithSeconds * 6, // 360° / 60 minutes = 6° per minute\n    seconds: secondsWithMs * 6, // 360° / 60 seconds = 6° per second\n    milliseconds: milliseconds * 0.36, // For ultra-smooth if needed\n  };\n}\n\n// Convert HSL string to CSS\nexport function hslToCSS(hsl: string): string {\n  // If already a valid CSS color, return as-is\n  if (hsl.startsWith('hsl') || hsl.startsWith('rgb') || hsl.startsWith('#')) {\n    return hsl;\n  }\n  // Convert \"h s% l%\" format to \"hsl(h, s%, l%)\"\n  const parts = hsl.split(' ');\n  if (parts.length >= 3) {\n    return `hsl(${parts[0]}, ${parts[1]}, ${parts[2]})`;\n  }\n  return hsl;\n}\n\n// Convert to Roman numerals\nexport function toRoman(num: number): string {\n  const romanNumerals: [number, string][] = [\n    [12, 'XII'], [11, 'XI'], [10, 'X'], [9, 'IX'],\n    [8, 'VIII'], [7, 'VII'], [6, 'VI'], [5, 'V'],\n    [4, 'IV'], [3, 'III'], [2, 'II'], [1, 'I'],\n  ];\n\n  for (const [value, numeral] of romanNumerals) {\n    if (num === value) return numeral;\n  }\n  return String(num);\n}\n\n// Generate positions around the dial\nexport function getPositionOnCircle(\n  angle: number,\n  radius: number,\n  centerX: number = 50,\n  centerY: number = 50\n): { x: number; y: number } {\n  // Convert angle to radians, offset by -90° so 0° is at 12 o'clock\n  const radians = ((angle - 90) * Math.PI) / 180;\n  return {\n    x: centerX + radius * Math.cos(radians),\n    y: centerY + radius * Math.sin(radians),\n  };\n}\n\n// Generate tick marks for the dial\nexport function generateTickMarks(\n  count: number,\n  majorEvery: number = 5\n): Array<{ angle: number; isMajor: boolean }> {\n  const marks: Array<{ angle: number; isMajor: boolean }> = [];\n  for (let i = 0; i < count; i++) {\n    marks.push({\n      angle: (360 / count) * i,\n      isMajor: i % majorEvery === 0,\n    });\n  }\n  return marks;\n}\n\n// Format date for date window\nexport function formatDateWindow(date: Date = new Date()): string {\n  return date.getDate().toString().padStart(2, '0');\n}\n\n// Watch size presets\nexport const WATCH_SIZES = {\n  xs: 80,\n  sm: 120,\n  md: 180,\n  lg: 240,\n  xl: 320,\n  showcase: 400,\n} as const;\n\nexport type WatchSize = keyof typeof WATCH_SIZES;\n\n// Easing functions for smooth animations\nexport const easings = {\n  // Spring-like easing for hands\n  spring: 'cubic-bezier(0.175, 0.885, 0.32, 1.275)',\n  // Smooth deceleration\n  easeOut: 'cubic-bezier(0.33, 1, 0.68, 1)',\n  // Linear for continuous rotation\n  linear: 'linear',\n};\n\n// Calculate hand dimensions based on style\nexport function getHandDimensions(\n  style: string,\n  type: 'hour' | 'minute' | 'second'\n): { length: number; width: number; tailLength: number } {\n  const dimensions: Record<string, Record<string, { length: number; width: number; tailLength: number }>> = {\n    dauphine: {\n      hour: { length: 28, width: 4, tailLength: 8 },\n      minute: { length: 38, width: 3, tailLength: 8 },\n      second: { length: 38, width: 1.5, tailLength: 12 },\n    },\n    baton: {\n      hour: { length: 26, width: 3.5, tailLength: 6 },\n      minute: { length: 38, width: 2.5, tailLength: 6 },\n      second: { length: 40, width: 1, tailLength: 14 },\n    },\n    mercedes: {\n      hour: { length: 26, width: 5, tailLength: 6 },\n      minute: { length: 38, width: 4, tailLength: 6 },\n      second: { length: 40, width: 1.5, tailLength: 14 },\n    },\n    snowflake: {\n      hour: { length: 26, width: 5, tailLength: 6 },\n      minute: { length: 38, width: 4, tailLength: 6 },\n      second: { length: 40, width: 1.5, tailLength: 14 },\n    },\n    sword: {\n      hour: { length: 28, width: 4, tailLength: 7 },\n      minute: { length: 40, width: 3, tailLength: 7 },\n      second: { length: 40, width: 1.2, tailLength: 14 },\n    },\n    leaf: {\n      hour: { length: 27, width: 5, tailLength: 7 },\n      minute: { length: 38, width: 4, tailLength: 7 },\n      second: { length: 38, width: 1.5, tailLength: 12 },\n    },\n    alpha: {\n      hour: { length: 26, width: 4.5, tailLength: 8 },\n      minute: { length: 38, width: 3.5, tailLength: 8 },\n      second: { length: 40, width: 1, tailLength: 14 },\n    },\n  };\n\n  return dimensions[style]?.[type] || dimensions.dauphine[type];\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/lib/watch/theme-to-watch.ts"],"sourcesContent":["/**\n * Theme to Watch DNA Algorithm\n *\n * Analyzes theme tokens and procedurally generates watch characteristics.\n * Each of the 43 themes will produce a unique, aesthetically matched watch face.\n */\n\nimport { themes, type ThemeName } from '@/lib/themes/definitions';\n\n// Watch style types - auto-detected from theme characteristics\nexport type WatchStyle =\n  | 'sporty'    // High contrast, bold - think Explorer II, Speedmaster\n  | 'elegant'   // Low saturation, refined - think Calatrava, Saxonia\n  | 'minimal'   // Clean, no numerals - think Nomos, Max Bill\n  | 'digital'   // Tech themes - LED/LCD segments\n  | 'vintage'   // Warm, aged - think patina, domed crystal\n  | 'field'     // Military, utilitarian - think field watches\n  | 'diver';    // Bold markers, high legibility\n\n// Hand styles\nexport type HandStyle = 'dauphine' | 'baton' | 'sword' | 'leaf' | 'alpha' | 'mercedes' | 'snowflake';\n\n// Index/marker styles\nexport type IndexStyle = 'baton' | 'roman' | 'arabic' | 'dots' | 'mixed' | 'none';\n\n// Watch DNA - the procedurally generated characteristics\nexport interface WatchDNA {\n  theme: ThemeName;\n  style: WatchStyle;\n\n  // Colors (HSL strings)\n  dialColor: string;\n  dialTexture: 'sunburst' | 'guilloche' | 'matte' | 'gradient' | 'brushed';\n  handColor: string;\n  secondsHandColor: string;\n  indexColor: string;\n  lumeColor: string;\n  bezelColor: string;\n\n  // Structure\n  handStyle: HandStyle;\n  indexStyle: IndexStyle;\n  hasDateWindow: boolean;\n  datePosition: 3 | 6;\n  hasSubdials: boolean;\n\n  // Aesthetics\n  hasCrystalDome: boolean;\n  hasChapterRing: boolean;\n  caseFinish: 'polished' | 'brushed' | 'mixed';\n\n  // Font for any text\n  font: string;\n}\n\n// HSL color structure\ninterface HSLColor {\n  h: number;\n  s: number;\n  l: number;\n}\n\n// Parse HSL string \"h s% l%\" to object\nfunction parseHSL(hsl: string): HSLColor {\n  const parts = hsl.split(' ').map(p => parseFloat(p.replace('%', '')));\n  return { h: parts[0] || 0, s: parts[1] || 0, l: parts[2] || 0 };\n}\n\n// Convert HSL object to CSS string\nfunction hslToCSS(color: HSLColor, alpha?: number): string {\n  if (alpha !== undefined) {\n    return `hsla(${color.h}, ${color.s}%, ${color.l}%, ${alpha})`;\n  }\n  return `hsl(${color.h}, ${color.s}%, ${color.l}%)`;\n}\n\n// Adjust HSL values\nfunction adjustHSL(color: HSLColor, adjustments: Partial<HSLColor>): HSLColor {\n  return {\n    h: Math.max(0, Math.min(360, (color.h + (adjustments.h || 0)) % 360)),\n    s: Math.max(0, Math.min(100, color.s + (adjustments.s || 0))),\n    l: Math.max(0, Math.min(100, color.l + (adjustments.l || 0))),\n  };\n}\n\n// Theme color tokens (extracted from CSS variables)\n// This maps to the actual CSS --theme-* variables\ninterface ThemeTokens {\n  background: string;\n  foreground: string;\n  primary: string;\n  secondary: string;\n  accent: string;\n  muted: string;\n  border: string;\n  font: string;\n}\n\n// Manually extracted theme tokens from themes.css\n// In a real implementation, these would be read from CSS or a config\nconst THEME_TOKENS: Record<ThemeName, ThemeTokens> = {\n  'utilitarian': {\n    background: '45 30% 92%',\n    foreground: '0 0% 0%',\n    primary: '15 85% 55%',\n    secondary: '45 20% 85%',\n    accent: '15 85% 55%',\n    muted: '45 15% 88%',\n    border: '0 0% 0%',\n    font: 'SF Mono',\n  },\n  'base': {\n    background: '0 0% 100%',\n    foreground: '222 84% 5%',\n    primary: '222 47% 11%',\n    secondary: '210 40% 96%',\n    accent: '210 40% 96%',\n    muted: '210 40% 96%',\n    border: '214 32% 91%',\n    font: 'Inter',\n  },\n  'claude': {\n    background: '30 20% 98%',\n    foreground: '20 14% 10%',\n    primary: '24 90% 55%',\n    secondary: '30 20% 90%',\n    accent: '24 80% 60%',\n    muted: '30 15% 92%',\n    border: '30 20% 85%',\n    font: 'Söhne',\n  },\n  'chatgpt': {\n    background: '0 0% 98%',\n    foreground: '0 0% 10%',\n    primary: '161 23% 45%',\n    secondary: '0 0% 94%',\n    accent: '161 23% 45%',\n    muted: '0 0% 92%',\n    border: '0 0% 85%',\n    font: 'OpenAI Sans',\n  },\n  'vercel': {\n    background: '0 0% 100%',\n    foreground: '0 0% 5%',\n    primary: '0 0% 5%',\n    secondary: '0 0% 95%',\n    accent: '0 0% 5%',\n    muted: '0 0% 96%',\n    border: '0 0% 90%',\n    font: 'Geist',\n  },\n  'kodama-grove': {\n    background: '120 20% 97%',\n    foreground: '120 30% 10%',\n    primary: '142 70% 35%',\n    secondary: '120 20% 88%',\n    accent: '142 60% 40%',\n    muted: '120 15% 90%',\n    border: '120 20% 82%',\n    font: 'Nunito',\n  },\n  'vintage-paper': {\n    background: '40 30% 95%',\n    foreground: '30 20% 15%',\n    primary: '30 50% 35%',\n    secondary: '40 25% 85%',\n    accent: '30 60% 45%',\n    muted: '40 20% 88%',\n    border: '40 25% 78%',\n    font: 'Courier Prime',\n  },\n  'claymorphism': {\n    background: '220 20% 97%',\n    foreground: '220 30% 15%',\n    primary: '220 80% 55%',\n    secondary: '220 20% 88%',\n    accent: '260 70% 60%',\n    muted: '220 15% 90%',\n    border: '220 20% 85%',\n    font: 'Poppins',\n  },\n  'nature': {\n    background: '45 25% 96%',\n    foreground: '30 30% 12%',\n    primary: '85 50% 40%',\n    secondary: '45 20% 85%',\n    accent: '30 60% 50%',\n    muted: '45 15% 88%',\n    border: '45 20% 78%',\n    font: 'Lora',\n  },\n  'neo-brutalism': {\n    background: '60 100% 97%',\n    foreground: '0 0% 0%',\n    primary: '0 0% 0%',\n    secondary: '60 100% 85%',\n    accent: '350 100% 60%',\n    muted: '60 50% 90%',\n    border: '0 0% 0%',\n    font: 'Space Grotesk',\n  },\n  'elegant-luxury': {\n    background: '45 20% 96%',\n    foreground: '40 15% 12%',\n    primary: '45 70% 45%',\n    secondary: '45 15% 88%',\n    accent: '45 80% 50%',\n    muted: '45 10% 90%',\n    border: '45 20% 80%',\n    font: 'Playfair Display',\n  },\n  'pastel-dreams': {\n    background: '300 30% 97%',\n    foreground: '280 20% 20%',\n    primary: '280 60% 65%',\n    secondary: '300 25% 90%',\n    accent: '330 70% 70%',\n    muted: '300 20% 92%',\n    border: '300 25% 85%',\n    font: 'Quicksand',\n  },\n  'cosmic-night': {\n    background: '240 30% 8%',\n    foreground: '240 10% 95%',\n    primary: '270 80% 60%',\n    secondary: '240 25% 15%',\n    accent: '200 100% 65%',\n    muted: '240 20% 12%',\n    border: '240 25% 20%',\n    font: 'Orbitron',\n  },\n  'clean-slate': {\n    background: '210 20% 98%',\n    foreground: '210 25% 10%',\n    primary: '210 100% 50%',\n    secondary: '210 15% 92%',\n    accent: '210 90% 55%',\n    muted: '210 12% 94%',\n    border: '210 15% 88%',\n    font: 'Inter',\n  },\n  'caffeine': {\n    background: '30 25% 95%',\n    foreground: '25 40% 12%',\n    primary: '25 70% 35%',\n    secondary: '30 20% 88%',\n    accent: '25 80% 45%',\n    muted: '30 15% 90%',\n    border: '30 20% 80%',\n    font: 'Merriweather',\n  },\n  'ocean-breeze': {\n    background: '195 30% 97%',\n    foreground: '200 30% 12%',\n    primary: '195 80% 45%',\n    secondary: '195 25% 90%',\n    accent: '175 70% 50%',\n    muted: '195 20% 92%',\n    border: '195 25% 85%',\n    font: 'Nunito Sans',\n  },\n  'perpetuity': {\n    background: '0 0% 4%',\n    foreground: '0 0% 95%',\n    primary: '0 0% 85%',\n    secondary: '0 0% 10%',\n    accent: '0 0% 70%',\n    muted: '0 0% 8%',\n    border: '0 0% 15%',\n    font: 'Inter',\n  },\n  'midnight-bloom': {\n    background: '270 30% 8%',\n    foreground: '300 20% 95%',\n    primary: '300 70% 55%',\n    secondary: '270 25% 15%',\n    accent: '330 80% 60%',\n    muted: '270 20% 12%',\n    border: '270 25% 20%',\n    font: 'Cormorant Garamond',\n  },\n  'northern-lights': {\n    background: '220 25% 10%',\n    foreground: '180 30% 95%',\n    primary: '160 80% 50%',\n    secondary: '220 20% 18%',\n    accent: '280 70% 60%',\n    muted: '220 15% 15%',\n    border: '220 20% 22%',\n    font: 'Raleway',\n  },\n  'sunset-horizon': {\n    background: '25 30% 96%',\n    foreground: '15 30% 12%',\n    primary: '15 85% 55%',\n    secondary: '25 25% 88%',\n    accent: '35 90% 55%',\n    muted: '25 20% 90%',\n    border: '25 25% 82%',\n    font: 'Josefin Sans',\n  },\n  'modern-minimal': {\n    background: '0 0% 100%',\n    foreground: '0 0% 8%',\n    primary: '0 0% 15%',\n    secondary: '0 0% 96%',\n    accent: '0 0% 25%',\n    muted: '0 0% 94%',\n    border: '0 0% 90%',\n    font: 'Inter',\n  },\n  'candyland': {\n    background: '330 40% 97%',\n    foreground: '340 30% 15%',\n    primary: '340 85% 60%',\n    secondary: '330 35% 90%',\n    accent: '180 70% 50%',\n    muted: '330 30% 92%',\n    border: '330 35% 85%',\n    font: 'Baloo 2',\n  },\n  'cyberpunk': {\n    background: '260 30% 8%',\n    foreground: '180 100% 60%',\n    primary: '320 100% 55%',\n    secondary: '260 25% 15%',\n    accent: '60 100% 50%',\n    muted: '260 20% 12%',\n    border: '320 80% 40%',\n    font: 'Share Tech Mono',\n  },\n  'retro-arcade': {\n    background: '240 40% 8%',\n    foreground: '120 100% 60%',\n    primary: '350 100% 55%',\n    secondary: '240 35% 15%',\n    accent: '60 100% 55%',\n    muted: '240 30% 12%',\n    border: '240 40% 20%',\n    font: 'Press Start 2P',\n  },\n  'quantum-rose': {\n    background: '340 25% 96%',\n    foreground: '340 20% 12%',\n    primary: '340 75% 55%',\n    secondary: '340 20% 90%',\n    accent: '20 80% 55%',\n    muted: '340 15% 92%',\n    border: '340 20% 85%',\n    font: 'DM Sans',\n  },\n  'bold-tech': {\n    background: '220 25% 10%',\n    foreground: '0 0% 98%',\n    primary: '210 100% 55%',\n    secondary: '220 20% 18%',\n    accent: '150 80% 50%',\n    muted: '220 15% 15%',\n    border: '220 20% 22%',\n    font: 'Space Grotesk',\n  },\n  'violet-bloom': {\n    background: '270 25% 97%',\n    foreground: '270 25% 12%',\n    primary: '270 70% 55%',\n    secondary: '270 20% 90%',\n    accent: '300 65% 60%',\n    muted: '270 15% 92%',\n    border: '270 20% 85%',\n    font: 'Outfit',\n  },\n  't3-chat': {\n    background: '250 30% 6%',\n    foreground: '0 0% 98%',\n    primary: '270 80% 60%',\n    secondary: '250 25% 12%',\n    accent: '200 100% 55%',\n    muted: '250 20% 10%',\n    border: '250 25% 18%',\n    font: 'Cal Sans',\n  },\n  'mocha-mousse': {\n    background: '25 30% 94%',\n    foreground: '20 35% 15%',\n    primary: '20 55% 40%',\n    secondary: '25 25% 85%',\n    accent: '20 65% 50%',\n    muted: '25 20% 88%',\n    border: '25 25% 78%',\n    font: 'Libre Baskerville',\n  },\n  'amethyst-haze': {\n    background: '280 20% 96%',\n    foreground: '280 25% 15%',\n    primary: '280 60% 55%',\n    secondary: '280 15% 90%',\n    accent: '320 55% 60%',\n    muted: '280 12% 92%',\n    border: '280 18% 85%',\n    font: 'Spectral',\n  },\n  'doom-64': {\n    background: '0 0% 5%',\n    foreground: '0 100% 50%',\n    primary: '0 100% 45%',\n    secondary: '0 80% 10%',\n    accent: '30 100% 50%',\n    muted: '0 60% 8%',\n    border: '0 100% 30%',\n    font: 'Permanent Marker',\n  },\n  'amber-minimal': {\n    background: '45 35% 97%',\n    foreground: '40 30% 12%',\n    primary: '40 85% 50%',\n    secondary: '45 30% 92%',\n    accent: '35 90% 55%',\n    muted: '45 25% 94%',\n    border: '45 30% 88%',\n    font: 'Inter',\n  },\n  'solar-dusk': {\n    background: '25 35% 12%',\n    foreground: '35 30% 92%',\n    primary: '25 90% 55%',\n    secondary: '25 30% 18%',\n    accent: '45 95% 55%',\n    muted: '25 25% 15%',\n    border: '25 30% 22%',\n    font: 'Rubik',\n  },\n  'starry-night': {\n    background: '230 40% 10%',\n    foreground: '60 50% 90%',\n    primary: '220 70% 55%',\n    secondary: '230 35% 18%',\n    accent: '60 80% 60%',\n    muted: '230 30% 15%',\n    border: '230 35% 22%',\n    font: 'Crimson Pro',\n  },\n  'soft-pop': {\n    background: '15 40% 97%',\n    foreground: '10 35% 15%',\n    primary: '10 75% 60%',\n    secondary: '15 35% 92%',\n    accent: '340 70% 65%',\n    muted: '15 30% 94%',\n    border: '15 35% 88%',\n    font: 'Nunito',\n  },\n  'sage-garden': {\n    background: '120 15% 96%',\n    foreground: '130 25% 15%',\n    primary: '130 40% 45%',\n    secondary: '120 12% 90%',\n    accent: '90 50% 50%',\n    muted: '120 10% 92%',\n    border: '120 15% 85%',\n    font: 'Source Serif Pro',\n  },\n  'notebook': {\n    background: '45 40% 96%',\n    foreground: '220 80% 20%',\n    primary: '220 85% 45%',\n    secondary: '45 35% 90%',\n    accent: '0 75% 55%',\n    muted: '45 30% 92%',\n    border: '200 60% 75%',\n    font: 'Patrick Hand',\n  },\n  'research': {\n    background: '0 0% 100%',\n    foreground: '220 15% 15%',\n    primary: '220 75% 50%',\n    secondary: '0 0% 96%',\n    accent: '160 70% 45%',\n    muted: '0 0% 94%',\n    border: '220 20% 88%',\n    font: 'IBM Plex Sans',\n  },\n  'field-guide': {\n    background: '45 30% 94%',\n    foreground: '90 25% 18%',\n    primary: '90 45% 35%',\n    secondary: '45 25% 88%',\n    accent: '25 70% 50%',\n    muted: '45 20% 90%',\n    border: '90 30% 75%',\n    font: 'Vollkorn',\n  },\n  'denim': {\n    background: '215 35% 95%',\n    foreground: '220 40% 15%',\n    primary: '215 60% 45%',\n    secondary: '215 30% 88%',\n    accent: '200 70% 50%',\n    muted: '215 25% 90%',\n    border: '215 35% 78%',\n    font: 'Inter',\n  },\n  'google': {\n    background: '0 0% 100%',\n    foreground: '0 0% 15%',\n    primary: '217 89% 61%',\n    secondary: '214 12% 95%',\n    accent: '4 90% 58%',\n    muted: '220 14% 96%',\n    border: '214 32% 91%',\n    font: 'Google Sans',\n  },\n  'apple': {\n    background: '0 0% 100%',\n    foreground: '0 0% 0%',\n    primary: '211 100% 50%',\n    secondary: '220 10% 96%',\n    accent: '211 100% 50%',\n    muted: '220 10% 94%',\n    border: '220 13% 91%',\n    font: 'SF Pro',\n  },\n  'microsoft': {\n    background: '0 0% 100%',\n    foreground: '0 0% 11%',\n    primary: '206 100% 42%',\n    secondary: '210 14% 93%',\n    accent: '206 100% 42%',\n    muted: '210 11% 96%',\n    border: '210 14% 89%',\n    font: 'Segoe UI',\n  },\n  'notion': {\n    background: '0 0% 100%',\n    foreground: '0 0% 9%',\n    primary: '0 0% 9%',\n    secondary: '45 6% 97%',\n    accent: '0 0% 9%',\n    muted: '45 4% 95%',\n    border: '45 6% 90%',\n    font: 'Inter',\n  },\n  'cursor': {\n    background: '0 0% 0%',\n    foreground: '0 0% 100%',\n    primary: '191 100% 50%',\n    secondary: '240 2% 12%',\n    accent: '191 100% 50%',\n    muted: '240 2% 16%',\n    border: '240 2% 20%',\n    font: 'Inter',\n  },\n  'miro': {\n    background: '47 100% 98%',\n    foreground: '222 47% 11%',\n    primary: '39 100% 50%',\n    secondary: '47 20% 92%',\n    accent: '39 100% 50%',\n    muted: '47 15% 95%',\n    border: '47 10% 88%',\n    font: 'Inter',\n  },\n  'nike': {\n    background: '40 30% 95%',\n    foreground: '0 0% 8%',\n    primary: '0 0% 8%',\n    secondary: '40 20% 90%',\n    accent: '28 100% 55%',\n    muted: '40 15% 88%',\n    border: '40 20% 85%',\n    font: 'Helvetica Neue',\n  },\n  'adidas': {\n    background: '0 0% 98%',\n    foreground: '0 0% 8%',\n    primary: '210 100% 45%',\n    secondary: '0 0% 94%',\n    accent: '0 0% 8%',\n    muted: '0 0% 92%',\n    border: '0 0% 88%',\n    font: 'Helvetica Neue',\n  },\n  'tao': {\n    background: '220 30% 8%',\n    foreground: '210 20% 78%',\n    primary: '200 40% 55%',\n    secondary: '220 25% 15%',\n    accent: '200 45% 50%',\n    muted: '220 20% 12%',\n    border: '220 25% 20%',\n    font: 'Crimson Text',\n  },\n  'kinetic-editorial': {\n    background: '0 0% 4%',\n    foreground: '0 0% 96%',\n    primary: '0 0% 96%',\n    secondary: '0 0% 12%',\n    accent: '0 0% 80%',\n    muted: '0 0% 8%',\n    border: '0 0% 20%',\n    font: 'Space Grotesk',\n  },\n};\n\n// Detect watch style from theme characteristics\nfunction detectWatchStyle(tokens: ThemeTokens): WatchStyle {\n  const bg = parseHSL(tokens.background);\n  const fg = parseHSL(tokens.foreground);\n  const primary = parseHSL(tokens.primary);\n  const accent = parseHSL(tokens.accent);\n\n  // Calculate contrast and saturation metrics\n  const contrast = Math.abs(bg.l - fg.l);\n  const primarySat = primary.s;\n  const accentSat = accent.s;\n  const avgSat = (primarySat + accentSat) / 2;\n  const isDark = bg.l < 30;\n  const isMonochrome = primary.s < 15 && accent.s < 15;\n\n  // Font-based detection\n  const fontLower = tokens.font.toLowerCase();\n  const isMonospace = fontLower.includes('mono') || fontLower.includes('code');\n  const isSerif = fontLower.includes('serif') || fontLower.includes('times') || fontLower.includes('georgia');\n  const isPlayful = fontLower.includes('press start') || fontLower.includes('permanent') || fontLower.includes('hand');\n\n  // Digital/tech themes\n  if (isMonospace || fontLower.includes('orbitron') || fontLower.includes('share tech')) {\n    return 'digital';\n  }\n\n  // High contrast + bold = sporty or diver\n  if (contrast > 80 && avgSat > 60) {\n    return isDark ? 'diver' : 'sporty';\n  }\n\n  // Very high saturation accent = sporty\n  if (accentSat > 85) {\n    return 'sporty';\n  }\n\n  // Warm sepia/vintage tones\n  if (primary.h >= 20 && primary.h <= 45 && primary.s < 60 && bg.l > 85) {\n    return 'vintage';\n  }\n\n  // Military/field - utilitarian fonts or earthy tones\n  if (fontLower.includes('mono') && !isDark || (primary.h >= 80 && primary.h <= 130)) {\n    return 'field';\n  }\n\n  // Very low saturation + clean = minimal\n  if (isMonochrome || (avgSat < 30 && contrast > 60)) {\n    return 'minimal';\n  }\n\n  // Serif fonts or low saturation = elegant\n  if (isSerif || (avgSat < 50 && !isDark && primary.s < 40)) {\n    return 'elegant';\n  }\n\n  // Default based on darkness\n  return isDark ? 'diver' : 'elegant';\n}\n\n// Detect hand style based on watch style and theme\nfunction detectHandStyle(style: WatchStyle, tokens: ThemeTokens): HandStyle {\n  const fontLower = tokens.font.toLowerCase();\n\n  switch (style) {\n    case 'sporty':\n      return 'mercedes'; // Like Rolex sport watches\n    case 'diver':\n      return 'snowflake'; // Like Tudor Black Bay\n    case 'elegant':\n      return 'dauphine'; // Classic dress watch\n    case 'minimal':\n      return 'baton'; // Simple, modern\n    case 'vintage':\n      return 'leaf'; // Classic vintage look\n    case 'field':\n      return 'sword'; // Military heritage\n    case 'digital':\n      return 'baton'; // Digital style\n    default:\n      return 'dauphine';\n  }\n}\n\n// Detect index style based on watch style\nfunction detectIndexStyle(style: WatchStyle, tokens: ThemeTokens): IndexStyle {\n  const fontLower = tokens.font.toLowerCase();\n  const isSerif = fontLower.includes('serif') || fontLower.includes('playfair') || fontLower.includes('times');\n\n  switch (style) {\n    case 'sporty':\n      return 'baton'; // Applied indices\n    case 'diver':\n      return 'dots'; // Luminous dots\n    case 'elegant':\n      return isSerif ? 'roman' : 'baton';\n    case 'minimal':\n      return 'none'; // Very clean\n    case 'vintage':\n      return 'arabic'; // Classic numerals\n    case 'field':\n      return 'arabic'; // Legible military style\n    case 'digital':\n      return 'none'; // Digital display\n    default:\n      return 'baton';\n  }\n}\n\n// Detect dial texture based on theme\nfunction detectDialTexture(style: WatchStyle, tokens: ThemeTokens): WatchDNA['dialTexture'] {\n  const bg = parseHSL(tokens.background);\n\n  switch (style) {\n    case 'elegant':\n      return bg.l > 50 ? 'sunburst' : 'guilloche';\n    case 'sporty':\n      return 'matte';\n    case 'diver':\n      return 'matte';\n    case 'vintage':\n      return 'matte';\n    case 'minimal':\n      return 'matte';\n    case 'digital':\n      return 'matte';\n    case 'field':\n      return 'brushed';\n    default:\n      return 'matte';\n  }\n}\n\n/**\n * Main function: Convert theme tokens to Watch DNA\n */\nexport function themeToWatch(themeName: ThemeName): WatchDNA {\n  const tokens = THEME_TOKENS[themeName];\n  if (!tokens) {\n    throw new Error(`Unknown theme: ${themeName}`);\n  }\n\n  const style = detectWatchStyle(tokens);\n  const bg = parseHSL(tokens.background);\n  const fg = parseHSL(tokens.foreground);\n  const primary = parseHSL(tokens.primary);\n  const accent = parseHSL(tokens.accent);\n  const secondary = parseHSL(tokens.secondary);\n\n  // Determine dial color (usually darker for legibility)\n  const isDark = bg.l < 30;\n  let dialColor: HSLColor;\n\n  if (isDark) {\n    // Dark themes: use background or slightly adjusted\n    dialColor = adjustHSL(bg, { l: 5 });\n  } else {\n    // Light themes: create a darker dial or use background\n    dialColor = style === 'minimal' || style === 'elegant'\n      ? adjustHSL(bg, { l: -3 })\n      : adjustHSL(bg, { l: -10, s: 5 });\n  }\n\n  // Hand colors - high contrast against dial\n  const handColor = isDark ? fg : adjustHSL(fg, { l: -10 });\n\n  // Seconds hand - use accent color for pop\n  const secondsHandColor = accent;\n\n  // Index color - slightly muted from hand color\n  const indexColor = adjustHSL(handColor, { s: -10, l: isDark ? -5 : 5 });\n\n  // Lume color - greenish glow for most, blue for some\n  const lumeColor: HSLColor = style === 'diver'\n    ? { h: 180, s: 100, l: 70 } // Blue lume\n    : { h: 120, s: 80, l: 75 }; // Green lume\n\n  // Bezel color\n  const bezelColor = style === 'diver'\n    ? adjustHSL(primary, { l: -20 })\n    : adjustHSL(secondary, { l: -5 });\n\n  return {\n    theme: themeName,\n    style,\n\n    dialColor: hslToCSS(dialColor),\n    dialTexture: detectDialTexture(style, tokens),\n    handColor: hslToCSS(handColor),\n    secondsHandColor: hslToCSS(secondsHandColor),\n    indexColor: hslToCSS(indexColor),\n    lumeColor: hslToCSS(lumeColor),\n    bezelColor: hslToCSS(bezelColor),\n\n    handStyle: detectHandStyle(style, tokens),\n    indexStyle: detectIndexStyle(style, tokens),\n    hasDateWindow: style !== 'minimal' && style !== 'digital',\n    datePosition: style === 'diver' ? 3 : 6,\n    hasSubdials: style === 'sporty',\n\n    hasCrystalDome: style === 'vintage' || style === 'elegant',\n    hasChapterRing: style === 'field' || style === 'vintage',\n    caseFinish: style === 'sporty' || style === 'diver' ? 'brushed' : 'polished',\n\n    font: tokens.font,\n  };\n}\n\n/**\n * Get all theme watches - for gallery view\n */\nexport function getAllThemeWatches(): WatchDNA[] {\n  return themes.map(t => themeToWatch(t.name));\n}\n\n/**\n * Get watch style description\n */\nexport function getWatchStyleDescription(style: WatchStyle): string {\n  const descriptions: Record<WatchStyle, string> = {\n    sporty: 'Bold sport chronograph with high legibility',\n    elegant: 'Refined dress watch with classic proportions',\n    minimal: 'Ultra-clean design with essential elements only',\n    digital: 'Tech-inspired with modern digital aesthetic',\n    vintage: 'Heritage-inspired with warm, aged character',\n    field: 'Military-inspired with utilitarian precision',\n    diver: 'Professional tool watch built for depth',\n  };\n  return descriptions[style];\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1038, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/lib/gallery-images.ts"],"sourcesContent":["// Shared gallery images used across OpenClaw-OS\n// Used by: Photos app, Desktop screensaver\n\nexport const GALLERY_IMAGES = [\n  { src: 'https://2oczblkb3byymav8.public.blob.vercel-storage.com/FB394334-6F13-446C-8B43-57C993D05E01.png', alt: 'OpenClaw-OS Vision' },\n  { src: 'https://2oczblkb3byymav8.public.blob.vercel-storage.com/0505D0AD-9EBF-4675-B3AC-ABF92501F024.png', alt: 'OpenClaw-OS Workspace' },\n  { src: '/photos/aurora.jpeg', alt: 'Aurora' },\n  { src: '/photos/Corballis.jpeg', alt: 'Corballis' },\n  { src: '/photos/Donabatebeach.jpeg', alt: 'Donabate Beach' },\n  { src: '/photos/Donabatebeach2.jpeg', alt: 'Donabate Beach' },\n  { src: '/photos/Glenofthedowns.jpeg', alt: 'Glen of the Downs' },\n  { src: '/photos/Mistysunrise.jpeg', alt: 'Misty Sunrise' },\n  { src: '/photos/Nightsky.jpeg', alt: 'Night Sky' },\n  { src: '/photos/Nightskytree.jpeg', alt: 'Night Sky Tree' },\n  { src: '/photos/Portranedemense.jpeg', alt: 'Portrane Demesne' },\n  { src: '/photos/Robin.jpeg', alt: 'Robin' },\n  { src: '/photos/Skygrange.jpeg', alt: 'Sky Grange' },\n  { src: '/photos/Sunriseoverhowth.jpeg', alt: 'Sunrise over Howth' },\n  { src: '/photos/Sunriseportrane.jpeg', alt: 'Sunrise Portrane' },\n  { src: '/photos/sunsetachill.jpeg', alt: 'Sunset Achill' },\n  { src: '/photos/SunsetPortrane.jpeg', alt: 'Sunset Portrane' },\n  { src: '/photos/SunsetSalvador.jpeg', alt: 'Sunset Salvador' },\n] as const;\n\nexport type GalleryImage = typeof GALLERY_IMAGES[number];\n"],"names":[],"mappings":"AAAA,gDAAgD;AAChD,2CAA2C;;;;;AAEpC,MAAM,iBAAiB;IAC5B;QAAE,KAAK;QAAoG,KAAK;IAAqB;IACrI;QAAE,KAAK;QAAoG,KAAK;IAAwB;IACxI;QAAE,KAAK;QAAuB,KAAK;IAAS;IAC5C;QAAE,KAAK;QAA0B,KAAK;IAAY;IAClD;QAAE,KAAK;QAA8B,KAAK;IAAiB;IAC3D;QAAE,KAAK;QAA+B,KAAK;IAAiB;IAC5D;QAAE,KAAK;QAA+B,KAAK;IAAoB;IAC/D;QAAE,KAAK;QAA6B,KAAK;IAAgB;IACzD;QAAE,KAAK;QAAyB,KAAK;IAAY;IACjD;QAAE,KAAK;QAA6B,KAAK;IAAiB;IAC1D;QAAE,KAAK;QAAgC,KAAK;IAAmB;IAC/D;QAAE,KAAK;QAAsB,KAAK;IAAQ;IAC1C;QAAE,KAAK;QAA0B,KAAK;IAAa;IACnD;QAAE,KAAK;QAAiC,KAAK;IAAqB;IAClE;QAAE,KAAK;QAAgC,KAAK;IAAmB;IAC/D;QAAE,KAAK;QAA6B,KAAK;IAAgB;IACzD;QAAE,KAAK;QAA+B,KAAK;IAAkB;IAC7D;QAAE,KAAK;QAA+B,KAAK;IAAkB;CAC9D"}},
    {"offset": {"line": 1125, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/context/PrivateMusicContext.tsx"],"sourcesContent":["'use client';\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  type ReactNode,\n} from 'react';\nimport { useUser } from '@clerk/nextjs';\nimport { useConvex, useQuery, useMutation } from '@/lib/openclaw/hooks';\nimport { api } from '@/lib/convex-shim';\n\n// Track type matching the format from Convex\nexport interface PrivateTrack {\n  id: string;\n  title: string;\n  artist: string;\n  album: string;\n  albumArt: string;\n  audioSrc: string;\n  lyrics?: string;\n  notes?: string;\n}\n\ninterface CollaboratorInfo {\n  id: string;\n  displayName: string | undefined;\n  email: string;\n  role: 'collaborator' | 'admin' | 'owner' | 'viewer' | string;\n}\n\ninterface PrivateMusicContextType {\n  // Auth state (from Clerk)\n  isSignedIn: boolean;\n  isLoading: boolean;\n\n  // Collaborator state (from Convex)\n  isCollaborator: boolean;\n  isAdmin: boolean;\n  collaborator: CollaboratorInfo | null;\n\n  // Tracks\n  privateTracks: PrivateTrack[];\n  isLoadingTracks: boolean;\n\n  // For checking if user has private access\n  hasPrivateAccess: boolean;\n}\n\nconst PrivateMusicContext = createContext<PrivateMusicContextType | null>(null);\n\n// Default values for when Convex isn't available (SSG/SSR)\nconst defaultValue: PrivateMusicContextType = {\n  isSignedIn: false,\n  isLoading: true,\n  isCollaborator: false,\n  isAdmin: false,\n  collaborator: null,\n  privateTracks: [],\n  isLoadingTracks: false,\n  hasPrivateAccess: false,\n};\n\n// Inner provider that uses Convex hooks\nfunction PrivateMusicProviderInner({ children }: { children: ReactNode }) {\n  const { isSignedIn, isLoaded: isClerkLoaded } = useUser();\n\n  // Query collaborator status from Convex (only when signed in)\n  const collaboratorStatus = useQuery(\n    api.privateMusic.getMyCollaboratorStatus,\n    isSignedIn ? {} : 'skip'\n  );\n\n  // Query private tracks (only when user is a collaborator)\n  const privateTracks = useQuery(\n    api.privateMusic.getMyPrivateTracks,\n    collaboratorStatus?.isCollaborator ? {} : 'skip'\n  );\n\n  // Link collaborator account on first sign-in (if email matches pending invite)\n  const linkAccount = useMutation(api.privateMusic.linkCollaboratorAccount);\n\n  useEffect(() => {\n    if (isSignedIn && collaboratorStatus && !collaboratorStatus.isCollaborator) {\n      // Try to link account in case this is a pending collaborator signing in\n      linkAccount().catch(() => {\n        // Silently fail - user just isn't a collaborator\n      });\n    }\n  }, [isSignedIn, collaboratorStatus, linkAccount]);\n\n  const isLoading = !isClerkLoaded || (isSignedIn && collaboratorStatus === undefined);\n  const isLoadingTracks = collaboratorStatus?.isCollaborator && privateTracks === undefined;\n\n  const value: PrivateMusicContextType = {\n    isSignedIn: !!isSignedIn,\n    isLoading,\n    isCollaborator: collaboratorStatus?.isCollaborator ?? false,\n    isAdmin: collaboratorStatus?.isAdmin ?? false,\n    collaborator: collaboratorStatus?.collaborator ?? null,\n    privateTracks: (privateTracks as PrivateTrack[]) ?? [],\n    isLoadingTracks: !!isLoadingTracks,\n    hasPrivateAccess: !!collaboratorStatus?.isCollaborator,\n  };\n\n  return (\n    <PrivateMusicContext.Provider value={value}>\n      {children}\n    </PrivateMusicContext.Provider>\n  );\n}\n\n// Outer provider that checks if Convex is available\nexport function PrivateMusicProvider({ children }: { children: ReactNode }) {\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n  }, []);\n\n  // During SSR/SSG, render with default values\n  if (!isMounted) {\n    return (\n      <PrivateMusicContext.Provider value={defaultValue}>\n        {children}\n      </PrivateMusicContext.Provider>\n    );\n  }\n\n  // On client, use the inner provider with Convex hooks\n  return <PrivateMusicProviderInner>{children}</PrivateMusicProviderInner>;\n}\n\nexport function usePrivateMusic() {\n  const context = useContext(PrivateMusicContext);\n  if (!context) {\n    throw new Error('usePrivateMusic must be used within a PrivateMusicProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAOA;AACA;AACA;;;AAXA;;;;;AAkDA,MAAM,oCAAsB,IAAA,uXAAa,EAAiC;AAE1E,2DAA2D;AAC3D,MAAM,eAAwC;IAC5C,YAAY;IACZ,WAAW;IACX,gBAAgB;IAChB,SAAS;IACT,cAAc;IACd,eAAe,EAAE;IACjB,iBAAiB;IACjB,kBAAkB;AACpB;AAEA,wCAAwC;AACxC,SAAS,0BAA0B,EAAE,QAAQ,EAA2B;;IACtE,MAAM,EAAE,UAAU,EAAE,UAAU,aAAa,EAAE,GAAG,IAAA,iUAAO;IAEvD,8DAA8D;IAC9D,MAAM,qBAAqB,IAAA,8IAAQ,EACjC,sIAAG,CAAC,YAAY,CAAC,uBAAuB,EACxC,aAAa,CAAC,IAAI;IAGpB,0DAA0D;IAC1D,MAAM,gBAAgB,IAAA,8IAAQ,EAC5B,sIAAG,CAAC,YAAY,CAAC,kBAAkB,EACnC,oBAAoB,iBAAiB,CAAC,IAAI;IAG5C,+EAA+E;IAC/E,MAAM,cAAc,IAAA,iJAAW,EAAC,sIAAG,CAAC,YAAY,CAAC,uBAAuB;IAExE,IAAA,mXAAS;+CAAC;YACR,IAAI,cAAc,sBAAsB,CAAC,mBAAmB,cAAc,EAAE;gBAC1E,wEAAwE;gBACxE,cAAc,KAAK;2DAAC;oBAClB,iDAAiD;oBACnD;;YACF;QACF;8CAAG;QAAC;QAAY;QAAoB;KAAY;IAEhD,MAAM,YAAY,CAAC,iBAAkB,cAAc,uBAAuB;IAC1E,MAAM,kBAAkB,oBAAoB,kBAAkB,kBAAkB;IAEhF,MAAM,QAAiC;QACrC,YAAY,CAAC,CAAC;QACd;QACA,gBAAgB,oBAAoB,kBAAkB;QACtD,SAAS,oBAAoB,WAAW;QACxC,cAAc,oBAAoB,gBAAgB;QAClD,eAAe,AAAC,iBAAoC,EAAE;QACtD,iBAAiB,CAAC,CAAC;QACnB,kBAAkB,CAAC,CAAC,oBAAoB;IAC1C;IAEA,qBACE,sYAAC,oBAAoB,QAAQ;QAAC,OAAO;kBAClC;;;;;;AAGP;GA9CS;;QACyC,iUAAO;QAG5B,8IAAQ;QAMb,8IAAQ;QAMV,iJAAW;;;KAhBxB;AAiDF,SAAS,qBAAqB,EAAE,QAAQ,EAA2B;;IACxE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,kXAAQ,EAAC;IAE3C,IAAA,mXAAS;0CAAC;YACR,aAAa;QACf;yCAAG,EAAE;IAEL,6CAA6C;IAC7C,IAAI,CAAC,WAAW;QACd,qBACE,sYAAC,oBAAoB,QAAQ;YAAC,OAAO;sBAClC;;;;;;IAGP;IAEA,sDAAsD;IACtD,qBAAO,sYAAC;kBAA2B;;;;;;AACrC;IAlBgB;MAAA;AAoBT,SAAS;;IACd,MAAM,UAAU,IAAA,oXAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB"}},
    {"offset": {"line": 1260, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/hooks/useAdminSession.ts"],"sourcesContent":["\"use client\";\n\n/**\n * Admin Session Hook\n *\n * Provides client-side access to admin session state.\n * Used to conditionally show admin-only features.\n */\n\nimport { useState, useEffect, useCallback } from \"react\";\n\ninterface AdminSession {\n  isAuthenticated: boolean;\n  username?: string;\n  isLoading: boolean;\n}\n\nexport function useAdminSession(): AdminSession & { refresh: () => Promise<void> } {\n  const [session, setSession] = useState<AdminSession>({\n    isAuthenticated: false,\n    isLoading: true,\n  });\n\n  const checkSession = useCallback(async () => {\n    try {\n      const res = await fetch(\"/api/auth/admin\");\n      const data = await res.json();\n      setSession({\n        isAuthenticated: data.isAuthenticated ?? false,\n        username: data.username,\n        isLoading: false,\n      });\n    } catch {\n      setSession({\n        isAuthenticated: false,\n        isLoading: false,\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    checkSession();\n  }, [checkSession]);\n\n  return {\n    ...session,\n    refresh: checkSession,\n  };\n}\n\nexport default useAdminSession;\n"],"names":[],"mappings":";;;;;;AAEA;;;;;CAKC,GAED;;AATA;;AAiBO,SAAS;;IACd,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kXAAQ,EAAe;QACnD,iBAAiB;QACjB,WAAW;IACb;IAEA,MAAM,eAAe,IAAA,qXAAW;qDAAC;YAC/B,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,WAAW;oBACT,iBAAiB,KAAK,eAAe,IAAI;oBACzC,UAAU,KAAK,QAAQ;oBACvB,WAAW;gBACb;YACF,EAAE,OAAM;gBACN,WAAW;oBACT,iBAAiB;oBACjB,WAAW;gBACb;YACF;QACF;oDAAG,EAAE;IAEL,IAAA,mXAAS;qCAAC;YACR;QACF;oCAAG;QAAC;KAAa;IAEjB,OAAO;QACL,GAAG,OAAO;QACV,SAAS;IACX;AACF;GA/BgB;uCAiCD"}},
    {"offset": {"line": 1320, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/hooks/useFeatureAccess.tsx"],"sourcesContent":["/**\n * useFeatureAccess - Hook for checking feature/area access\n *\n * Checks if the current user has access to a specific feature or area.\n * Returns access status and a function to show the graceful denial overlay.\n */\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { useQuery } from '@/lib/openclaw/hooks';\nimport { useUser } from '@clerk/nextjs';\nimport { useAdminSession } from './useAdminSession';\n\n// Type assertion for userManagement module\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet userManagementApi: any;\ntry {\n  // Dynamic import to handle cases where Convex isn't configured\n  userManagementApi = require('../../convex/_generated/api').api?.userManagement;\n} catch {\n  userManagementApi = null;\n}\n\nexport type FeatureType =\n  | 'humans'\n  | 'studio'\n  | 'vault'\n  | 'calendar'\n  | 'prototyping'\n  | 'privateMusic'\n  | 'designCanvas'\n  | 'security'\n  | 'analytics';\n\ninterface FeatureAccessResult {\n  hasAccess: boolean;\n  isLoading: boolean;\n  reason?: string;\n  showAccessGate: () => void;\n  hideAccessGate: () => void;\n  isGateOpen: boolean;\n}\n\n// Map features to their required permission keys\nconst FEATURE_TO_PERMISSION: Record<FeatureType, string> = {\n  humans: 'areas',\n  studio: 'areas',\n  vault: 'areas',\n  calendar: 'areas',\n  prototyping: 'areas',\n  privateMusic: 'privateMusic',\n  designCanvas: 'designCanvas',\n  security: 'security',\n  analytics: 'analytics',\n};\n\n// Area slugs for area-based features\nconst AREA_FEATURES = ['humans', 'studio', 'vault', 'calendar', 'prototyping'];\n\nexport function useFeatureAccess(feature: FeatureType): FeatureAccessResult {\n  const { user, isLoaded: isClerkLoaded } = useUser();\n  const { isAuthenticated: isAdmin, isLoading: isAdminLoading } = useAdminSession();\n  const [isGateOpen, setIsGateOpen] = useState(false);\n\n  // Get managed user data if logged in\n  const clerkId = user?.id;\n  const managedUser = useQuery(\n    userManagementApi?.getManagedUserByClerkId,\n    clerkId ? { clerkId } : 'skip'\n  );\n\n  const isLoading: boolean = !isClerkLoaded || isAdminLoading || Boolean(clerkId && managedUser === undefined);\n\n  // Determine access\n  const accessResult = useMemo(() => {\n    // Still loading\n    if (isLoading) {\n      return { hasAccess: false, reason: 'Loading...' };\n    }\n\n    // Admin always has access\n    if (isAdmin) {\n      return { hasAccess: true };\n    }\n\n    // Not logged in = visitor\n    if (!user) {\n      return {\n        hasAccess: false,\n        reason: 'This feature requires an account. Sign in or request access.',\n      };\n    }\n\n    // User is logged in but not in managed users\n    if (!managedUser) {\n      return {\n        hasAccess: false,\n        reason: 'This feature is available to invited collaborators.',\n      };\n    }\n\n    // User is deactivated\n    if (!managedUser.isActive) {\n      return {\n        hasAccess: false,\n        reason: 'Your account has been deactivated. Contact the owner for assistance.',\n      };\n    }\n\n    // Owner has access to everything\n    if (managedUser.role === 'owner') {\n      return { hasAccess: true };\n    }\n\n    // Admin role has access to everything\n    if (managedUser.role === 'admin') {\n      return { hasAccess: true };\n    }\n\n    // Check specific permission\n    const permissionKey = FEATURE_TO_PERMISSION[feature];\n\n    if (AREA_FEATURES.includes(feature)) {\n      // Area-based access\n      const hasAreaAccess = managedUser.permissions?.areas?.includes(feature);\n      if (!hasAreaAccess) {\n        return {\n          hasAccess: false,\n          reason: `This area is reserved for users with ${feature} access.`,\n        };\n      }\n      return { hasAccess: true };\n    }\n\n    // Feature toggle access\n    const hasFeatureAccess = managedUser.permissions?.[permissionKey as keyof typeof managedUser.permissions];\n    if (!hasFeatureAccess) {\n      return {\n        hasAccess: false,\n        reason: `This feature requires ${feature} permission.`,\n      };\n    }\n\n    return { hasAccess: true };\n  }, [isLoading, isAdmin, user, managedUser, feature]);\n\n  const showAccessGate = useCallback(() => {\n    setIsGateOpen(true);\n  }, []);\n\n  const hideAccessGate = useCallback(() => {\n    setIsGateOpen(false);\n  }, []);\n\n  return {\n    hasAccess: accessResult.hasAccess,\n    isLoading,\n    reason: accessResult.reason,\n    showAccessGate,\n    hideAccessGate,\n    isGateOpen,\n  };\n}\n\n/**\n * Higher-order component wrapper for protected features\n */\nexport function withFeatureAccess<P extends object>(\n  WrappedComponent: React.ComponentType<P>,\n  feature: FeatureType\n) {\n  return function ProtectedComponent(props: P) {\n    const { hasAccess, isLoading } = useFeatureAccess(feature);\n\n    if (isLoading) {\n      return null; // Or a loading spinner\n    }\n\n    if (!hasAccess) {\n      return null; // The AccessGate will be shown separately\n    }\n\n    return <WrappedComponent {...props} />;\n  };\n}\n\nexport default useFeatureAccess;\n"],"names":[],"mappings":";;;;;;;;;AAAA;;;;;CAKC,GAED;AACA;AACA;AACA;;;;;;;AAEA,2CAA2C;AAC3C,8DAA8D;AAC9D,IAAI;AACJ,IAAI;IACF,+DAA+D;IAC/D,oBAAoB;;;;SAAuC,GAAG,EAAE;AAClE,EAAE,OAAM;IACN,oBAAoB;AACtB;AAsBA,iDAAiD;AACjD,MAAM,wBAAqD;IACzD,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,UAAU;IACV,aAAa;IACb,cAAc;IACd,cAAc;IACd,UAAU;IACV,WAAW;AACb;AAEA,qCAAqC;AACrC,MAAM,gBAAgB;IAAC;IAAU;IAAU;IAAS;IAAY;CAAc;AAEvE,SAAS,iBAAiB,OAAoB;;IACnD,MAAM,EAAE,IAAI,EAAE,UAAU,aAAa,EAAE,GAAG,IAAA,iUAAO;IACjD,MAAM,EAAE,iBAAiB,OAAO,EAAE,WAAW,cAAc,EAAE,GAAG,IAAA,qJAAe;IAC/E,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,kXAAQ,EAAC;IAE7C,qCAAqC;IACrC,MAAM,UAAU,MAAM;IACtB,MAAM,cAAc,IAAA,8IAAQ,EAC1B,mBAAmB,yBACnB,UAAU;QAAE;IAAQ,IAAI;IAG1B,MAAM,YAAqB,CAAC,iBAAiB,kBAAkB,QAAQ,WAAW,gBAAgB;IAElG,mBAAmB;IACnB,MAAM,eAAe,IAAA,iXAAO;kDAAC;YAC3B,gBAAgB;YAChB,IAAI,WAAW;gBACb,OAAO;oBAAE,WAAW;oBAAO,QAAQ;gBAAa;YAClD;YAEA,0BAA0B;YAC1B,IAAI,SAAS;gBACX,OAAO;oBAAE,WAAW;gBAAK;YAC3B;YAEA,0BAA0B;YAC1B,IAAI,CAAC,MAAM;gBACT,OAAO;oBACL,WAAW;oBACX,QAAQ;gBACV;YACF;YAEA,6CAA6C;YAC7C,IAAI,CAAC,aAAa;gBAChB,OAAO;oBACL,WAAW;oBACX,QAAQ;gBACV;YACF;YAEA,sBAAsB;YACtB,IAAI,CAAC,YAAY,QAAQ,EAAE;gBACzB,OAAO;oBACL,WAAW;oBACX,QAAQ;gBACV;YACF;YAEA,iCAAiC;YACjC,IAAI,YAAY,IAAI,KAAK,SAAS;gBAChC,OAAO;oBAAE,WAAW;gBAAK;YAC3B;YAEA,sCAAsC;YACtC,IAAI,YAAY,IAAI,KAAK,SAAS;gBAChC,OAAO;oBAAE,WAAW;gBAAK;YAC3B;YAEA,4BAA4B;YAC5B,MAAM,gBAAgB,qBAAqB,CAAC,QAAQ;YAEpD,IAAI,cAAc,QAAQ,CAAC,UAAU;gBACnC,oBAAoB;gBACpB,MAAM,gBAAgB,YAAY,WAAW,EAAE,OAAO,SAAS;gBAC/D,IAAI,CAAC,eAAe;oBAClB,OAAO;wBACL,WAAW;wBACX,QAAQ,CAAC,qCAAqC,EAAE,QAAQ,QAAQ,CAAC;oBACnE;gBACF;gBACA,OAAO;oBAAE,WAAW;gBAAK;YAC3B;YAEA,wBAAwB;YACxB,MAAM,mBAAmB,YAAY,WAAW,EAAE,CAAC,cAAsD;YACzG,IAAI,CAAC,kBAAkB;gBACrB,OAAO;oBACL,WAAW;oBACX,QAAQ,CAAC,sBAAsB,EAAE,QAAQ,YAAY,CAAC;gBACxD;YACF;YAEA,OAAO;gBAAE,WAAW;YAAK;QAC3B;iDAAG;QAAC;QAAW;QAAS;QAAM;QAAa;KAAQ;IAEnD,MAAM,iBAAiB,IAAA,qXAAW;wDAAC;YACjC,cAAc;QAChB;uDAAG,EAAE;IAEL,MAAM,iBAAiB,IAAA,qXAAW;wDAAC;YACjC,cAAc;QAChB;uDAAG,EAAE;IAEL,OAAO;QACL,WAAW,aAAa,SAAS;QACjC;QACA,QAAQ,aAAa,MAAM;QAC3B;QACA;QACA;IACF;AACF;GAvGgB;;QAC4B,iUAAO;QACe,qJAAe;QAK3D,8IAAQ;;;AAqGvB,SAAS,kBACd,gBAAwC,EACxC,OAAoB;;IAEpB,UAAO,SAAS,mBAAmB,KAAQ;;QACzC,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,iBAAiB;QAElD,IAAI,WAAW;YACb,OAAO,MAAM,uBAAuB;QACtC;QAEA,IAAI,CAAC,WAAW;YACd,OAAO,MAAM,0CAA0C;QACzD;QAEA,qBAAO,sYAAC;YAAkB,GAAG,KAAK;;;;;;IACpC;;YAXmC;;;AAYrC;uCAEe"}},
    {"offset": {"line": 1529, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/hooks/useMusicPlayerMorph.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { useMotionValue, useTransform, animate, MotionValue } from 'framer-motion';\n\nexport type MorphState = 'ipod' | 'island' | 'expanded' | 'morphing';\n\ninterface UseMusicPlayerMorphReturn {\n  // Current morph state\n  morphProgress: number;\n  morphState: MorphState;\n  isDragging: boolean;\n  isMobile: boolean;\n\n  // Motion values for smooth animations\n  progress: MotionValue<number>;\n\n  // Derived transforms for different elements\n  ipodScale: MotionValue<number>;\n  ipodBorderRadius: MotionValue<number>;\n  ipodWidth: MotionValue<number>;\n  ipodHeight: MotionValue<string>;\n  panelOpacity: MotionValue<number>;\n\n  // Actions\n  expand: () => void;\n  collapse: () => void;\n  toggleExpanded: () => void;\n\n  // Gesture handlers for scrubbing\n  onDragStart: () => void;\n  onDrag: (progress: number) => void;\n  onDragEnd: () => void;\n\n  // Set morph progress directly (for scrubbing)\n  setMorphProgress: (progress: number) => void;\n}\n\nexport function useMusicPlayerMorph(): UseMusicPlayerMorphReturn {\n  const [morphState, setMorphState] = useState<MorphState>('ipod');\n  const [isDragging, setIsDragging] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n\n  // Motion value for smooth, interruptible animations\n  const progress = useMotionValue(0);\n  const [morphProgress, setMorphProgressState] = useState(0);\n\n  // Sync motion value with state\n  useEffect(() => {\n    const unsubscribe = progress.on('change', (v) => {\n      setMorphProgressState(v);\n    });\n    return unsubscribe;\n  }, [progress]);\n\n  // Detect mobile viewport\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Derived transforms for iPod morphing\n  // Desktop: iPod stays centered, scales subtly, panels appear around it\n  // Mobile: iPod morphs into Dynamic Island (small pill at top)\n\n  const ipodScale = useTransform(\n    progress,\n    isMobile ? [0, 0.5, 1] : [0, 0.5, 1],\n    isMobile ? [1, 0.5, 0.35] : [1, 0.98, 0.95]  // Subtle scale for desktop elegance\n  );\n\n  const ipodBorderRadius = useTransform(\n    progress,\n    [0, 0.5, 1],\n    isMobile ? [32, 24, 22] : [32, 30, 28]\n  );\n\n  const ipodWidth = useTransform(\n    progress,\n    [0, 0.5, 1],\n    isMobile ? [300, 180, 140] : [300, 300, 300]  // Desktop keeps full width\n  );\n\n  const ipodHeight = useTransform(\n    progress,\n    [0, 0.5, 1],\n    isMobile ? ['auto', '70px', '52px'] : ['auto', 'auto', 'auto']\n  );\n\n  // Smooth panel fade - starts earlier, finishes with elegant timing\n  const panelOpacity = useTransform(\n    progress,\n    [0, 0.15, 0.5, 1],\n    [0, 0, 0.7, 1]\n  );\n\n  // Premium spring animation - lower stiffness, controlled damping for silk-smooth feel\n  const animateTo = useCallback((target: number) => {\n    animate(progress, target, {\n      type: 'spring',\n      stiffness: 260,  // Lower for smoother, more relaxed animation\n      damping: 28,     // Slight underdamping for subtle bounce\n      mass: 0.9,       // Adds weight for premium feel\n    });\n  }, [progress]);\n\n  // Expand to full view\n  const expand = useCallback(() => {\n    setMorphState('expanded');\n    animateTo(1);\n  }, [animateTo]);\n\n  // Collapse back to iPod\n  const collapse = useCallback(() => {\n    setMorphState('ipod');\n    animateTo(0);\n  }, [animateTo]);\n\n  // Toggle between states\n  const toggleExpanded = useCallback(() => {\n    if (morphState === 'expanded') {\n      collapse();\n    } else {\n      expand();\n    }\n  }, [morphState, expand, collapse]);\n\n  // Gesture handlers for scrubbing the morph\n  const onDragStart = useCallback(() => {\n    setIsDragging(true);\n    setMorphState('morphing');\n  }, []);\n\n  const onDrag = useCallback((newProgress: number) => {\n    // Clamp between 0 and 1\n    const clamped = Math.max(0, Math.min(1, newProgress));\n    progress.set(clamped);\n  }, [progress]);\n\n  const onDragEnd = useCallback(() => {\n    setIsDragging(false);\n\n    // Snap to nearest state based on current progress\n    const currentProgress = progress.get();\n\n    if (isMobile) {\n      // Mobile: snap to iPod (0), island (0.5), or expanded (1)\n      if (currentProgress < 0.25) {\n        setMorphState('ipod');\n        animateTo(0);\n      } else if (currentProgress < 0.75) {\n        setMorphState('island');\n        animateTo(0.5);\n      } else {\n        setMorphState('expanded');\n        animateTo(1);\n      }\n    } else {\n      // Desktop: snap to iPod (0) or expanded (1)\n      if (currentProgress < 0.5) {\n        setMorphState('ipod');\n        animateTo(0);\n      } else {\n        setMorphState('expanded');\n        animateTo(1);\n      }\n    }\n  }, [progress, isMobile, animateTo]);\n\n  // Direct progress setter for external control\n  const setMorphProgress = useCallback((newProgress: number) => {\n    progress.set(Math.max(0, Math.min(1, newProgress)));\n  }, [progress]);\n\n  return {\n    morphProgress,\n    morphState,\n    isDragging,\n    isMobile,\n    progress,\n    ipodScale,\n    ipodBorderRadius,\n    ipodWidth,\n    ipodHeight,\n    panelOpacity,\n    expand,\n    collapse,\n    toggleExpanded,\n    onDragStart,\n    onDrag,\n    onDragEnd,\n    setMorphProgress,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAAA;;AAHA;;;AAsCO,SAAS;;IACd,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,kXAAQ,EAAa;IACzD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,kXAAQ,EAAC;IAC7C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,kXAAQ,EAAC;IAEzC,oDAAoD;IACpD,MAAM,WAAW,IAAA,mVAAc,EAAC;IAChC,MAAM,CAAC,eAAe,sBAAsB,GAAG,IAAA,kXAAQ,EAAC;IAExD,+BAA+B;IAC/B,IAAA,mXAAS;yCAAC;YACR,MAAM,cAAc,SAAS,EAAE,CAAC;6DAAU,CAAC;oBACzC,sBAAsB;gBACxB;;YACA,OAAO;QACT;wCAAG;QAAC;KAAS;IAEb,yBAAyB;IACzB,IAAA,mXAAS;yCAAC;YACR,MAAM;6DAAc;oBAClB,YAAY,OAAO,UAAU,GAAG;gBAClC;;YACA;YACA,OAAO,gBAAgB,CAAC,UAAU;YAClC;iDAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACpD;wCAAG,EAAE;IAEL,uCAAuC;IACvC,uEAAuE;IACvE,8DAA8D;IAE9D,MAAM,YAAY,IAAA,2UAAY,EAC5B,UACA,WAAW;QAAC;QAAG;QAAK;KAAE,GAAG;QAAC;QAAG;QAAK;KAAE,EACpC,WAAW;QAAC;QAAG;QAAK;KAAK,GAAG;QAAC;QAAG;QAAM;KAAK,CAAE,oCAAoC;;IAGnF,MAAM,mBAAmB,IAAA,2UAAY,EACnC,UACA;QAAC;QAAG;QAAK;KAAE,EACX,WAAW;QAAC;QAAI;QAAI;KAAG,GAAG;QAAC;QAAI;QAAI;KAAG;IAGxC,MAAM,YAAY,IAAA,2UAAY,EAC5B,UACA;QAAC;QAAG;QAAK;KAAE,EACX,WAAW;QAAC;QAAK;QAAK;KAAI,GAAG;QAAC;QAAK;QAAK;KAAI,CAAE,2BAA2B;;IAG3E,MAAM,aAAa,IAAA,2UAAY,EAC7B,UACA;QAAC;QAAG;QAAK;KAAE,EACX,WAAW;QAAC;QAAQ;QAAQ;KAAO,GAAG;QAAC;QAAQ;QAAQ;KAAO;IAGhE,mEAAmE;IACnE,MAAM,eAAe,IAAA,2UAAY,EAC/B,UACA;QAAC;QAAG;QAAM;QAAK;KAAE,EACjB;QAAC;QAAG;QAAG;QAAK;KAAE;IAGhB,sFAAsF;IACtF,MAAM,YAAY,IAAA,qXAAW;sDAAC,CAAC;YAC7B,IAAA,0UAAO,EAAC,UAAU,QAAQ;gBACxB,MAAM;gBACN,WAAW;gBACX,SAAS;gBACT,MAAM;YACR;QACF;qDAAG;QAAC;KAAS;IAEb,sBAAsB;IACtB,MAAM,SAAS,IAAA,qXAAW;mDAAC;YACzB,cAAc;YACd,UAAU;QACZ;kDAAG;QAAC;KAAU;IAEd,wBAAwB;IACxB,MAAM,WAAW,IAAA,qXAAW;qDAAC;YAC3B,cAAc;YACd,UAAU;QACZ;oDAAG;QAAC;KAAU;IAEd,wBAAwB;IACxB,MAAM,iBAAiB,IAAA,qXAAW;2DAAC;YACjC,IAAI,eAAe,YAAY;gBAC7B;YACF,OAAO;gBACL;YACF;QACF;0DAAG;QAAC;QAAY;QAAQ;KAAS;IAEjC,2CAA2C;IAC3C,MAAM,cAAc,IAAA,qXAAW;wDAAC;YAC9B,cAAc;YACd,cAAc;QAChB;uDAAG,EAAE;IAEL,MAAM,SAAS,IAAA,qXAAW;mDAAC,CAAC;YAC1B,wBAAwB;YACxB,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG;YACxC,SAAS,GAAG,CAAC;QACf;kDAAG;QAAC;KAAS;IAEb,MAAM,YAAY,IAAA,qXAAW;sDAAC;YAC5B,cAAc;YAEd,kDAAkD;YAClD,MAAM,kBAAkB,SAAS,GAAG;YAEpC,IAAI,UAAU;gBACZ,0DAA0D;gBAC1D,IAAI,kBAAkB,MAAM;oBAC1B,cAAc;oBACd,UAAU;gBACZ,OAAO,IAAI,kBAAkB,MAAM;oBACjC,cAAc;oBACd,UAAU;gBACZ,OAAO;oBACL,cAAc;oBACd,UAAU;gBACZ;YACF,OAAO;gBACL,4CAA4C;gBAC5C,IAAI,kBAAkB,KAAK;oBACzB,cAAc;oBACd,UAAU;gBACZ,OAAO;oBACL,cAAc;oBACd,UAAU;gBACZ;YACF;QACF;qDAAG;QAAC;QAAU;QAAU;KAAU;IAElC,8CAA8C;IAC9C,MAAM,mBAAmB,IAAA,qXAAW;6DAAC,CAAC;YACpC,SAAS,GAAG,CAAC,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG;QACvC;4DAAG;QAAC;KAAS;IAEb,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACF;AACF;GA/JgB;;QAMG,mVAAc;QAyBb,2UAAY;QAML,2UAAY;QAMnB,2UAAY;QAMX,2UAAY;QAOV,2UAAY"}},
    {"offset": {"line": 1789, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/hooks/useStreamingChat.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useRef } from 'react';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type ToolStatus = 'pending' | 'executing' | 'complete' | 'error' | 'denied';\n\nexport interface ActiveToolCall {\n  id: string;\n  name: string;\n  status: ToolStatus;\n  result?: unknown;\n  error?: string;\n}\n\nexport interface ChatMessage {\n  id: string;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n  isStreaming?: boolean;\n  /** Chain-of-thought reasoning (from local models like Ollama with thinking) */\n  thinking?: string;\n  /** Whether thinking is still being streamed */\n  isThinkingStreaming?: boolean;\n  /** Active tool calls for this message */\n  toolCalls?: ActiveToolCall[];\n}\n\nexport interface UseStreamingChatOptions {\n  /** Model to use (claude, opus, sonnet, default) */\n  model?: string;\n  /** Optional theme context to include in system prompt */\n  themeContext?: string;\n  /** Callback when streaming starts */\n  onStreamStart?: () => void;\n  /** Callback when streaming ends */\n  onStreamEnd?: () => void;\n  /** Callback on error */\n  onError?: (error: Error) => void;\n}\n\nexport interface UseStreamingChatReturn {\n  messages: ChatMessage[];\n  isStreaming: boolean;\n  error: string | null;\n  /** Currently active tool calls (from streaming message) */\n  activeToolCalls: ActiveToolCall[];\n  sendMessage: (content: string) => Promise<void>;\n  clearMessages: () => void;\n  setMessages: React.Dispatch<React.SetStateAction<ChatMessage[]>>;\n  abortStream: () => void;\n}\n\n// ============================================================================\n// Hook\n// ============================================================================\n\nexport function useStreamingChat(\n  options: UseStreamingChatOptions = {}\n): UseStreamingChatReturn {\n  const { model = 'default', themeContext, onStreamStart, onStreamEnd, onError } = options;\n\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [isStreaming, setIsStreaming] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [activeToolCalls, setActiveToolCalls] = useState<ActiveToolCall[]>([]);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  const generateId = () => `msg_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`;\n\n  const sendMessage = useCallback(\n    async (content: string) => {\n      if (!content.trim() || isStreaming) return;\n\n      setError(null);\n\n      // Create user message\n      const userMessage: ChatMessage = {\n        id: generateId(),\n        role: 'user',\n        content: content.trim(),\n        timestamp: new Date(),\n      };\n\n      // Create placeholder for assistant response\n      const assistantMessage: ChatMessage = {\n        id: generateId(),\n        role: 'assistant',\n        content: '',\n        timestamp: new Date(),\n        isStreaming: true,\n        thinking: '',\n        isThinkingStreaming: false,\n      };\n\n      setMessages((prev) => [...prev, userMessage, assistantMessage]);\n      setIsStreaming(true);\n      onStreamStart?.();\n\n      // Create abort controller for this request\n      abortControllerRef.current = new AbortController();\n\n      try {\n        // Prepare messages for API (exclude the placeholder)\n        const apiMessages = [...messages, userMessage].map((m) => ({\n          role: m.role,\n          content: m.content,\n        }));\n\n        const response = await fetch('/api/chat/stream', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            messages: apiMessages,\n            model,\n            themeContext,\n          }),\n          signal: abortControllerRef.current.signal,\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json().catch(() => ({}));\n          throw new Error(errorData.error || 'Failed to get response');\n        }\n\n        const reader = response.body?.getReader();\n        if (!reader) {\n          throw new Error('No response body');\n        }\n\n        const decoder = new TextDecoder();\n        let accumulatedContent = '';\n        let accumulatedThinking = '';\n\n        while (true) {\n          const { done, value } = await reader.read();\n          if (done) break;\n\n          const chunk = decoder.decode(value, { stream: true });\n          const lines = chunk.split('\\n');\n\n          for (const line of lines) {\n            if (line.startsWith('data: ')) {\n              const data = line.slice(6);\n              if (data === '[DONE]') continue;\n\n              try {\n                const parsed = JSON.parse(data);\n\n                // Handle content (main response)\n                if (parsed.content) {\n                  accumulatedContent += parsed.content;\n                  // Update the assistant message with accumulated content\n                  setMessages((prev) =>\n                    prev.map((m) =>\n                      m.id === assistantMessage.id\n                        ? { ...m, content: accumulatedContent, isThinkingStreaming: false }\n                        : m\n                    )\n                  );\n                }\n\n                // Handle thinking/reasoning (chain of thought)\n                if (parsed.thinking) {\n                  accumulatedThinking += parsed.thinking;\n                  // Update the assistant message with accumulated thinking\n                  setMessages((prev) =>\n                    prev.map((m) =>\n                      m.id === assistantMessage.id\n                        ? { ...m, thinking: accumulatedThinking, isThinkingStreaming: true }\n                        : m\n                    )\n                  );\n                }\n\n                // Handle tool call start\n                if (parsed.toolCall) {\n                  const { id, name, status } = parsed.toolCall;\n                  setActiveToolCalls((prev) => {\n                    const existing = prev.find((tc) => tc.id === id);\n                    if (existing) {\n                      return prev.map((tc) =>\n                        tc.id === id ? { ...tc, status: status as ToolStatus } : tc\n                      );\n                    }\n                    return [...prev, { id, name, status: status as ToolStatus }];\n                  });\n                }\n\n                // Handle tool result\n                if (parsed.toolResult) {\n                  const { id, name, result } = parsed.toolResult;\n                  setActiveToolCalls((prev) =>\n                    prev.map((tc) =>\n                      tc.id === id ? { ...tc, status: 'complete' as ToolStatus, result } : tc\n                    )\n                  );\n                }\n\n                // Handle tool error\n                if (parsed.toolError) {\n                  const { id, error: toolError } = parsed.toolError;\n                  setActiveToolCalls((prev) =>\n                    prev.map((tc) =>\n                      tc.id === id ? { ...tc, status: 'error' as ToolStatus, error: toolError } : tc\n                    )\n                  );\n                }\n\n                // Handle tool denied (access control)\n                if (parsed.toolDenied) {\n                  const { name, reason } = parsed.toolDenied;\n                  const deniedId = `denied_${Date.now()}`;\n                  setActiveToolCalls((prev) => [\n                    ...prev,\n                    { id: deniedId, name, status: 'denied' as ToolStatus, error: reason },\n                  ]);\n                }\n              } catch {\n                // Skip invalid JSON\n              }\n            }\n          }\n        }\n\n        // Mark streaming as complete and attach tool calls to message\n        setActiveToolCalls((currentTools) => {\n          // Capture final tools before clearing\n          setMessages((prev) =>\n            prev.map((m) =>\n              m.id === assistantMessage.id\n                ? {\n                    ...m,\n                    isStreaming: false,\n                    isThinkingStreaming: false,\n                    toolCalls: currentTools.length > 0 ? [...currentTools] : undefined,\n                  }\n                : m\n            )\n          );\n          return []; // Clear active tool calls\n        });\n      } catch (err) {\n        if (err instanceof Error && err.name === 'AbortError') {\n          // Request was aborted, just mark streaming as complete\n          setMessages((prev) =>\n            prev.map((m) =>\n              m.id === assistantMessage.id\n                ? { ...m, isStreaming: false, content: m.content || 'Request cancelled.' }\n                : m\n            )\n          );\n        } else {\n          const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n          setError(errorMessage);\n          onError?.(err instanceof Error ? err : new Error(errorMessage));\n\n          // Update the assistant message with error\n          setMessages((prev) =>\n            prev.map((m) =>\n              m.id === assistantMessage.id\n                ? {\n                    ...m,\n                    isStreaming: false,\n                    content: `Sorry, I encountered an error: ${errorMessage}. Please try again.`,\n                  }\n                : m\n            )\n          );\n        }\n      } finally {\n        setIsStreaming(false);\n        abortControllerRef.current = null;\n        onStreamEnd?.();\n      }\n    },\n    [messages, isStreaming, model, themeContext, onStreamStart, onStreamEnd, onError]\n  );\n\n  const clearMessages = useCallback(() => {\n    setMessages([]);\n    setError(null);\n    setActiveToolCalls([]);\n  }, []);\n\n  const abortStream = useCallback(() => {\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n  }, []);\n\n  return {\n    messages,\n    isStreaming,\n    error,\n    activeToolCalls,\n    sendMessage,\n    clearMessages,\n    setMessages,\n    abortStream,\n  };\n}\n\nexport default useStreamingChat;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2087, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/hooks/useMusicGeneration.ts"],"sourcesContent":["/**\n * useMusicGeneration Hook\n *\n * Provides music generation capabilities via local ACE-Step through Lynkr tunnel.\n * Handles generation, analysis, and stem separation with progress tracking.\n * Persists jobs and tracks to Convex for history and library features.\n */\n\nimport { useState, useCallback, useRef } from 'react';\nimport { useMutation } from '@/lib/openclaw/hooks';\nimport { api } from '@/lib/convex-shim';\nimport { Id } from '../../convex/_generated/dataModel';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface MusicGenerateParams {\n  prompt: string;\n  lyrics?: string;\n  duration?: number; // 10-600 seconds\n  bpm?: number; // 30-300\n  key?: string; // e.g., \"C major\", \"A minor\"\n  timeSignature?: string; // e.g., \"4/4\", \"3/4\", \"6/8\"\n  referenceAudio?: string; // URL to reference audio (style transfer)\n  referenceStrength?: number; // 0-1 (lower = lighter style transfer)\n  model?: string;\n  lmModel?: string;\n  format?: 'mp3' | 'wav' | 'flac';\n  title?: string;\n  saveToJamz?: boolean;\n  projectId?: string;\n  // Full ACE-Step 1.5 parameter support\n  vocalLanguage?: string; // ISO: en, zh, ja, ko, es, fr, de, it, pt, ru\n  thinking?: boolean; // Use 5Hz LM for enhanced quality\n  sampleMode?: boolean; // Auto-generate caption/lyrics via LM\n  sampleQuery?: string; // Description for sample mode\n  useFormat?: boolean; // LM-enhanced caption formatting\n  inferenceSteps?: number; // 1-200 (8 for turbo, 32-64 for base)\n  guidanceScale?: number; // Prompt guidance coefficient\n  seed?: number; // -1 for random\n  batchSize?: number; // 1-8\n  taskType?: 'text2music' | 'cover' | 'repaint' | 'lego' | 'extract' | 'complete';\n  srcAudio?: string; // Source audio for cover/repaint\n  instruction?: string; // Edit instruction\n  repaintingStart?: number; // Start time for repaint (seconds)\n  repaintingEnd?: number; // End time for repaint (seconds)\n}\n\nexport interface MusicGenerateResult {\n  id: string;\n  status: 'completed' | 'processing' | 'failed';\n  audioUrl?: string;\n  audioBase64?: string;\n  duration: number;\n  metadata: {\n    bpm: number;\n    key: string;\n    timeSignature: string;\n    model: string;\n    lmModel?: string;\n    vocalLanguage?: string;\n  };\n  provider: string;\n  title?: string;\n}\n\nexport interface AudioAnalysisResult {\n  bpm?: number;\n  key?: string;\n  timeSignature?: string;\n  caption?: string;\n  lyrics?: {\n    text: string;\n    timestamps?: { start: number; end: number; text: string }[];\n  };\n  provider: string;\n}\n\nexport interface StemSeparationResult {\n  stems: Record<string, string>; // stem name -> audio URL\n  provider: string;\n}\n\nexport type MusicGenerationStatus =\n  | 'idle'\n  | 'generating'\n  | 'analyzing'\n  | 'separating'\n  | 'completed'\n  | 'error';\n\nexport interface MusicGenerationState {\n  status: MusicGenerationStatus;\n  progress: number; // 0-100\n  message: string;\n  result: MusicGenerateResult | null;\n  error: string | null;\n}\n\n// ============================================================================\n// Hook\n// ============================================================================\n\nexport function useMusicGeneration() {\n  const [state, setState] = useState<MusicGenerationState>({\n    status: 'idle',\n    progress: 0,\n    message: '',\n    result: null,\n    error: null,\n  });\n\n  const abortControllerRef = useRef<AbortController | null>(null);\n  const currentJobIdRef = useRef<Id<\"musicGenerationJobs\"> | null>(null);\n\n  // Convex mutations for job persistence\n  const createJob = useMutation(api.musicGeneration.createJob);\n  const startJob = useMutation(api.musicGeneration.startJob);\n  const completeJob = useMutation(api.musicGeneration.completeJob);\n  const failJob = useMutation(api.musicGeneration.failJob);\n\n  /**\n   * Check if ACE-Step is available\n   */\n  const checkAvailability = useCallback(async (): Promise<{\n    available: boolean;\n    reason?: string;\n    models?: string[];\n  }> => {\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'GET',\n      });\n\n      return await response.json();\n    } catch {\n      return { available: false, reason: 'Connection failed' };\n    }\n  }, []);\n\n  /**\n   * Generate music from prompt and optional lyrics\n   * Now persists jobs to Convex for history and library features\n   */\n  const generate = useCallback(async (params: MusicGenerateParams): Promise<MusicGenerateResult | null> => {\n    // Cancel any in-progress generation\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n\n    abortControllerRef.current = new AbortController();\n\n    setState({\n      status: 'generating',\n      progress: 0,\n      message: 'Starting music generation...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      // Create job in Convex for tracking and history\n      let jobId: Id<\"musicGenerationJobs\"> | null = null;\n      try {\n        jobId = await createJob({\n          prompt: params.prompt,\n          lyrics: params.lyrics,\n          duration: params.duration || 30,\n          bpm: params.bpm,\n          key: params.key,\n          timeSignature: params.timeSignature,\n          title: params.title,\n        });\n        currentJobIdRef.current = jobId;\n\n        // Mark as processing\n        await startJob({ jobId });\n      } catch (convexError) {\n        // If not authenticated, continue without Convex persistence\n        console.warn('[useMusicGeneration] Convex job creation failed (user may not be authenticated):', convexError);\n      }\n\n      // Simulate progress updates (ACE-Step doesn't stream progress)\n      const progressInterval = setInterval(() => {\n        setState(prev => {\n          if (prev.status !== 'generating') return prev;\n          const newProgress = Math.min(prev.progress + Math.random() * 15, 90);\n          return {\n            ...prev,\n            progress: newProgress,\n            message: getProgressMessage(newProgress),\n          };\n        });\n      }, 2000);\n\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ ...params, action: 'generate' }),\n        signal: abortControllerRef.current.signal,\n      });\n\n      clearInterval(progressInterval);\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Generation failed');\n      }\n\n      const result: MusicGenerateResult = await response.json();\n\n      // Complete the job in Convex with results\n      if (jobId && result.audioUrl) {\n        try {\n          await completeJob({\n            jobId,\n            audioUrl: result.audioUrl,\n            metadata: {\n              actualBpm: result.metadata.bpm,\n              actualKey: result.metadata.key,\n              actualDuration: result.duration,\n              model: result.metadata.model,\n              lmModel: result.metadata.lmModel,\n            },\n          });\n        } catch (convexError) {\n          console.warn('[useMusicGeneration] Convex job completion failed:', convexError);\n        }\n      }\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Music generated successfully!',\n        result,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        setState(prev => ({\n          ...prev,\n          status: 'idle',\n          progress: 0,\n          message: 'Generation cancelled',\n        }));\n        return null;\n      }\n\n      const errorMessage = error instanceof Error ? error.message : 'Generation failed';\n\n      // Mark job as failed in Convex\n      if (currentJobIdRef.current) {\n        try {\n          await failJob({\n            jobId: currentJobIdRef.current,\n            error: errorMessage,\n          });\n        } catch (convexError) {\n          console.warn('[useMusicGeneration] Convex job failure recording failed:', convexError);\n        }\n      }\n\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, [createJob, startJob, completeJob, failJob]);\n\n  /**\n   * Analyze audio to extract BPM, key, etc.\n   */\n  const analyze = useCallback(async (\n    audioUrl: string,\n    extract?: ('bpm' | 'key' | 'time_signature' | 'caption' | 'lyrics')[]\n  ): Promise<AudioAnalysisResult | null> => {\n    setState({\n      status: 'analyzing',\n      progress: 50,\n      message: 'Analyzing audio...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'analyze',\n          audioUrl,\n          extract: extract || ['bpm', 'key', 'time_signature', 'caption'],\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Analysis failed');\n      }\n\n      const result: AudioAnalysisResult = await response.json();\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Analysis complete!',\n        result: null,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Analysis failed';\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, []);\n\n  /**\n   * Separate audio into stems (vocals, drums, bass, other)\n   */\n  const separateStems = useCallback(async (\n    audioUrl: string,\n    stems?: ('vocals' | 'drums' | 'bass' | 'other' | 'piano' | 'guitar')[]\n  ): Promise<StemSeparationResult | null> => {\n    setState({\n      status: 'separating',\n      progress: 30,\n      message: 'Separating stems...',\n      result: null,\n      error: null,\n    });\n\n    try {\n      const response = await fetch('/api/music/generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'separate',\n          audioUrl,\n          stems: stems || ['vocals', 'drums', 'bass', 'other'],\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Stem separation failed');\n      }\n\n      const result: StemSeparationResult = await response.json();\n\n      setState({\n        status: 'completed',\n        progress: 100,\n        message: 'Stems separated!',\n        result: null,\n        error: null,\n      });\n\n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Stem separation failed';\n      setState({\n        status: 'error',\n        progress: 0,\n        message: errorMessage,\n        result: null,\n        error: errorMessage,\n      });\n\n      return null;\n    }\n  }, []);\n\n  /**\n   * Cancel in-progress generation\n   */\n  const cancel = useCallback(() => {\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n      abortControllerRef.current = null;\n    }\n  }, []);\n\n  /**\n   * Reset state\n   */\n  const reset = useCallback(() => {\n    cancel();\n    setState({\n      status: 'idle',\n      progress: 0,\n      message: '',\n      result: null,\n      error: null,\n    });\n  }, [cancel]);\n\n  return {\n    // State\n    ...state,\n    isGenerating: state.status === 'generating',\n    isAnalyzing: state.status === 'analyzing',\n    isSeparating: state.status === 'separating',\n    isProcessing: ['generating', 'analyzing', 'separating'].includes(state.status),\n\n    // Actions\n    generate,\n    analyze,\n    separateStems,\n    checkAvailability,\n    cancel,\n    reset,\n  };\n}\n\n// ============================================================================\n// Helpers\n// ============================================================================\n\nfunction getProgressMessage(progress: number): string {\n  if (progress < 20) return 'Initializing models...';\n  if (progress < 40) return 'Processing prompt...';\n  if (progress < 60) return 'Generating audio...';\n  if (progress < 80) return 'Applying effects...';\n  return 'Finalizing...';\n}\n\n// ============================================================================\n// Presets\n// ============================================================================\n\nexport const MUSIC_PRESETS = {\n  podcastIntro: {\n    prompt: 'upbeat professional podcast intro, modern electronic, clean production',\n    duration: 15,\n    bpm: 120,\n    key: 'C major',\n  },\n  lofi: {\n    prompt: 'lo-fi hip hop study beats, vinyl crackle, mellow piano, soft drums, rainy day mood',\n    duration: 120,\n    bpm: 85,\n    key: 'F major',\n  },\n  epicTrailer: {\n    prompt: 'cinematic orchestral trailer music, building tension, brass swells, timpani, heroic',\n    duration: 60,\n    bpm: 90,\n    key: 'D minor',\n  },\n  ambient: {\n    prompt: 'peaceful ambient soundscape, soft pads, nature sounds, meditation music',\n    duration: 180,\n    bpm: 60,\n    key: 'A minor',\n  },\n  edm: {\n    prompt: 'high energy EDM, festival drop, punchy kick, saw wave lead, side-chain compression',\n    duration: 180,\n    bpm: 128,\n    key: 'F minor',\n  },\n  acoustic: {\n    prompt: 'warm acoustic folk, fingerpicked guitar, soft vocals, campfire vibes',\n    duration: 120,\n    bpm: 100,\n    key: 'G major',\n  },\n} as const;\n\nexport type MusicPreset = keyof typeof MUSIC_PRESETS;\n"],"names":[],"mappings":"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"}}]
}