{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallButton.tsx"],"sourcesContent":["'use client';\n\nimport { motion } from 'framer-motion';\nimport { Phone } from 'lucide-react';\nimport { springs } from '@/components/motion/config';\n\ninterface VoiceCallButtonProps {\n  onClick: () => void;\n  disabled?: boolean;\n  size?: number;\n  className?: string;\n}\n\nexport function VoiceCallButton({\n  onClick,\n  disabled = false,\n  size = 20,\n  className = '',\n}: VoiceCallButtonProps) {\n  return (\n    <motion.button\n      onClick={onClick}\n      disabled={disabled}\n      className={`\n        relative flex items-center justify-center\n        text-foreground/70 hover:text-[hsl(var(--theme-primary))]\n        disabled:opacity-50 disabled:cursor-not-allowed\n        transition-colors duration-150\n        ${className}\n      `}\n      whileHover={disabled ? {} : { scale: 1.1 }}\n      whileTap={disabled ? {} : { scale: 0.95 }}\n      transition={springs.snappy}\n      aria-label=\"Start voice call with Claw AI\"\n    >\n      <Phone size={size} />\n    </motion.button>\n  );\n}\n\nexport default VoiceCallButton;\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,SAAS,gBAAgB,EAC9B,OAAO,EACP,WAAW,KAAK,EAChB,OAAO,EAAE,EACT,YAAY,EAAE,EACO;IACrB,qBACE,sYAAC,mVAAM,CAAC,MAAM;QACZ,SAAS;QACT,UAAU;QACV,WAAW,CAAC;;;;;QAKV,EAAE,UAAU;MACd,CAAC;QACD,YAAY,WAAW,CAAC,IAAI;YAAE,OAAO;QAAI;QACzC,UAAU,WAAW,CAAC,IAAI;YAAE,OAAO;QAAK;QACxC,YAAY,mJAAO,CAAC,MAAM;QAC1B,cAAW;kBAEX,cAAA,sYAAC,oSAAK;YAAC,MAAM;;;;;;;;;;;AAGnB;KAzBgB;uCA2BD"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallAvatar.tsx"],"sourcesContent":["'use client';\n\nimport { motion, useReducedMotion } from 'framer-motion';\nimport { cn } from '@/lib/utils';\n\ntype CallStatus = 'connecting' | 'connected' | 'listening' | 'speaking' | 'thinking' | 'ending';\n\ninterface VoiceCallAvatarProps {\n  status: CallStatus;\n  size?: number;\n  className?: string;\n}\n\nexport function VoiceCallAvatar({\n  status,\n  size = 160,\n  className,\n}: VoiceCallAvatarProps) {\n  const prefersReducedMotion = useReducedMotion();\n\n  const imageSize = Math.round(size * 0.875); // 140px at 160px size\n  const frameRadius = Math.round(size * 0.15); // 24px at 160px\n\n  const isActive = status === 'speaking' || status === 'listening' || status === 'thinking';\n  const isSpeaking = status === 'speaking';\n  const isConnecting = status === 'connecting';\n  const isEnding = status === 'ending';\n\n  return (\n    <div\n      className={cn('relative flex items-center justify-center', className)}\n      style={{ width: size, height: size }}\n    >\n      {/* Outer glow rings */}\n      <motion.div\n        className=\"absolute inset-0\"\n        style={{\n          background: `radial-gradient(circle, hsl(var(--theme-primary) / ${isActive ? 0.5 : 0.3}) 0%, transparent 70%)`,\n          margin: -size * 0.25,\n        }}\n        animate={\n          prefersReducedMotion\n            ? {}\n            : {\n                scale: isActive ? [1, 1.15, 1] : [1, 1.05, 1],\n                opacity: isActive ? [0.6, 0.3, 0.6] : [0.4, 0.2, 0.4],\n              }\n        }\n        transition={{\n          duration: isConnecting ? 1.5 : 2,\n          repeat: Infinity,\n          ease: 'easeInOut',\n        }}\n      />\n\n      {/* Secondary glow for speaking state */}\n      {isSpeaking && !prefersReducedMotion && (\n        <motion.div\n          className=\"absolute inset-0\"\n          style={{\n            background: 'radial-gradient(circle, hsl(var(--theme-accent) / 0.4) 0%, transparent 70%)',\n            margin: -size * 0.2,\n          }}\n          animate={{\n            scale: [1.1, 1.3, 1.1],\n            opacity: [0.5, 0.2, 0.5],\n          }}\n          transition={{\n            duration: 1.5,\n            repeat: Infinity,\n            ease: 'easeInOut',\n            delay: 0.1,\n          }}\n        />\n      )}\n\n      {/* Speaking ring expansion effect */}\n      {isSpeaking && !prefersReducedMotion && (\n        <motion.div\n          className=\"absolute inset-0 rounded-3xl border-2\"\n          style={{\n            borderColor: 'hsl(var(--theme-accent) / 0.5)',\n          }}\n          animate={{\n            scale: [1, 1.3, 1.5],\n            opacity: [0.5, 0.2, 0],\n          }}\n          transition={{\n            duration: 1.5,\n            repeat: Infinity,\n            ease: 'easeOut',\n          }}\n        />\n      )}\n\n      {/* Main avatar frame */}\n      <motion.div\n        className=\"relative overflow-hidden\"\n        style={{\n          width: size,\n          height: size,\n          borderRadius: frameRadius,\n          background: `linear-gradient(135deg, hsl(var(--theme-primary)) 0%, hsl(var(--theme-accent)) 100%)`,\n          boxShadow: isActive\n            ? `0 0 ${size * 0.5}px hsl(var(--theme-primary) / 0.4), 0 0 ${size * 0.75}px hsl(var(--theme-accent) / 0.2), inset 0 0 ${size * 0.25}px rgba(255, 255, 255, 0.2)`\n            : `0 0 ${size * 0.3}px hsl(var(--theme-primary) / 0.25), 0 0 ${size * 0.5}px hsl(var(--theme-accent) / 0.1), inset 0 0 ${size * 0.15}px rgba(255, 255, 255, 0.15)`,\n          padding: 3,\n        }}\n        animate={\n          prefersReducedMotion || isEnding\n            ? isEnding ? { opacity: 0.5, scale: 0.95 } : {}\n            : isActive\n            ? { scale: [1, 1.02, 1] }\n            : {}\n        }\n        transition={{\n          duration: 1.5,\n          repeat: isEnding ? 0 : Infinity,\n          ease: 'easeInOut',\n        }}\n      >\n        {/* Inner glass highlight */}\n        <div\n          className=\"absolute inset-0\"\n          style={{\n            background: 'radial-gradient(ellipse 80% 50% at 50% 20%, rgba(255, 255, 255, 0.35) 0%, transparent 50%)',\n            borderRadius: frameRadius,\n          }}\n        />\n\n        {/* Rotating shimmer for thinking state */}\n        {status === 'thinking' && !prefersReducedMotion && (\n          <motion.div\n            className=\"absolute inset-0 overflow-hidden\"\n            style={{ borderRadius: frameRadius }}\n            animate={{ rotate: [0, 360] }}\n            transition={{\n              duration: 4,\n              repeat: Infinity,\n              ease: 'linear',\n            }}\n          >\n            <div\n              className=\"absolute inset-0\"\n              style={{\n                background: 'conic-gradient(from 0deg, transparent 0%, rgba(255, 255, 255, 0.4) 10%, transparent 20%, transparent 100%)',\n              }}\n            />\n          </motion.div>\n        )}\n\n        {/* Profile image container */}\n        <div\n          className=\"relative overflow-hidden bg-black/20\"\n          style={{\n            width: '100%',\n            height: '100%',\n            borderRadius: frameRadius - 3,\n          }}\n        >\n          <motion.img\n            src=\"/openclaw-logo.png\"\n            alt=\"Claw AI\"\n            className=\"w-full h-full object-cover\"\n            animate={\n              prefersReducedMotion\n                ? {}\n                : isActive\n                ? { y: [0, -2, 0] }\n                : {}\n            }\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: 'easeInOut',\n            }}\n          />\n        </div>\n      </motion.div>\n\n      {/* Connecting pulse overlay */}\n      {isConnecting && !prefersReducedMotion && (\n        <motion.div\n          className=\"absolute inset-0\"\n          style={{\n            borderRadius: frameRadius,\n            background: 'rgba(255, 255, 255, 0.1)',\n          }}\n          animate={{\n            opacity: [0, 0.3, 0],\n          }}\n          transition={{\n            duration: 1.5,\n            repeat: Infinity,\n            ease: 'easeInOut',\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default VoiceCallAvatar;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallWaveform.tsx"],"sourcesContent":["'use client';\n\nimport { motion } from 'framer-motion';\nimport { memo, useMemo } from 'react';\n\ninterface VoiceCallWaveformProps {\n  audioLevels: number[];\n  isActive: boolean;\n  variant?: 'user' | 'ai';\n  barCount?: number;\n  className?: string;\n}\n\nconst WaveformBar = memo(function WaveformBar({\n  level,\n  index,\n  variant,\n  minHeight,\n  maxHeight,\n}: {\n  level: number;\n  index: number;\n  variant: 'user' | 'ai';\n  minHeight: number;\n  maxHeight: number;\n}) {\n  const height = minHeight + level * (maxHeight - minHeight);\n  const colorClass = variant === 'user'\n    ? 'bg-[hsl(var(--theme-primary))]'\n    : 'bg-[hsl(var(--theme-accent))]';\n\n  return (\n    <motion.div\n      className={`rounded-full ${colorClass}`}\n      style={{ width: 3 }}\n      initial={{ height: minHeight }}\n      animate={{ height }}\n      transition={{\n        type: 'spring',\n        stiffness: 300,\n        damping: 20,\n        mass: 0.5,\n      }}\n    />\n  );\n});\n\nexport const VoiceCallWaveform = memo(function VoiceCallWaveform({\n  audioLevels,\n  isActive,\n  variant = 'user',\n  barCount = 16,\n  className = '',\n}: VoiceCallWaveformProps) {\n  const minHeight = 6;\n  const maxHeight = 32;\n\n  // Normalize audio levels to match barCount\n  const normalizedLevels = useMemo(() => {\n    if (audioLevels.length === 0) {\n      return Array(barCount).fill(0);\n    }\n    if (audioLevels.length === barCount) {\n      return audioLevels;\n    }\n\n    // Interpolate or sample to match barCount\n    const result: number[] = [];\n    const ratio = audioLevels.length / barCount;\n\n    for (let i = 0; i < barCount; i++) {\n      const index = Math.floor(i * ratio);\n      result.push(audioLevels[Math.min(index, audioLevels.length - 1)] || 0);\n    }\n\n    return result;\n  }, [audioLevels, barCount]);\n\n  // Generate idle animation levels\n  const idleLevels = useMemo(() => {\n    return Array(barCount).fill(0).map((_, i) => {\n      // Create a subtle wave pattern\n      const phase = (i / barCount) * Math.PI * 2;\n      return 0.1 + Math.sin(phase) * 0.05;\n    });\n  }, [barCount]);\n\n  const displayLevels = isActive ? normalizedLevels : idleLevels;\n\n  return (\n    <motion.div\n      className={`flex items-center justify-center gap-[2px] ${className}`}\n      style={{ height: maxHeight }}\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      transition={{ duration: 0.2 }}\n    >\n      {displayLevels.map((level, index) => (\n        <WaveformBar\n          key={index}\n          level={level}\n          index={index}\n          variant={variant}\n          minHeight={minHeight}\n          maxHeight={maxHeight}\n        />\n      ))}\n    </motion.div>\n  );\n});\n\nexport default VoiceCallWaveform;\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAaA,MAAM,4BAAc,IAAA,8WAAI,EAAC,SAAS,YAAY,EAC5C,KAAK,EACL,KAAK,EACL,OAAO,EACP,SAAS,EACT,SAAS,EAOV;IACC,MAAM,SAAS,YAAY,QAAQ,CAAC,YAAY,SAAS;IACzD,MAAM,aAAa,YAAY,SAC3B,mCACA;IAEJ,qBACE,sYAAC,mVAAM,CAAC,GAAG;QACT,WAAW,CAAC,aAAa,EAAE,YAAY;QACvC,OAAO;YAAE,OAAO;QAAE;QAClB,SAAS;YAAE,QAAQ;QAAU;QAC7B,SAAS;YAAE;QAAO;QAClB,YAAY;YACV,MAAM;YACN,WAAW;YACX,SAAS;YACT,MAAM;QACR;;;;;;AAGN;KAhCM;AAkCC,MAAM,kCAAoB,GAAA,IAAA,8WAAI,WAAC,SAAS,kBAAkB,EAC/D,WAAW,EACX,QAAQ,EACR,UAAU,MAAM,EAChB,WAAW,EAAE,EACb,YAAY,EAAE,EACS;;IACvB,MAAM,YAAY;IAClB,MAAM,YAAY;IAElB,2CAA2C;IAC3C,MAAM,mBAAmB,IAAA,iXAAO;yEAAC;YAC/B,IAAI,YAAY,MAAM,KAAK,GAAG;gBAC5B,OAAO,MAAM,UAAU,IAAI,CAAC;YAC9B;YACA,IAAI,YAAY,MAAM,KAAK,UAAU;gBACnC,OAAO;YACT;YAEA,0CAA0C;YAC1C,MAAM,SAAmB,EAAE;YAC3B,MAAM,QAAQ,YAAY,MAAM,GAAG;YAEnC,IAAK,IAAI,IAAI,GAAG,IAAI,UAAU,IAAK;gBACjC,MAAM,QAAQ,KAAK,KAAK,CAAC,IAAI;gBAC7B,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,OAAO,YAAY,MAAM,GAAG,GAAG,IAAI;YACtE;YAEA,OAAO;QACT;wEAAG;QAAC;QAAa;KAAS;IAE1B,iCAAiC;IACjC,MAAM,aAAa,IAAA,iXAAO;mEAAC;YACzB,OAAO,MAAM,UAAU,IAAI,CAAC,GAAG,GAAG;2EAAC,CAAC,GAAG;oBACrC,+BAA+B;oBAC/B,MAAM,QAAQ,AAAC,IAAI,WAAY,KAAK,EAAE,GAAG;oBACzC,OAAO,MAAM,KAAK,GAAG,CAAC,SAAS;gBACjC;;QACF;kEAAG;QAAC;KAAS;IAEb,MAAM,gBAAgB,WAAW,mBAAmB;IAEpD,qBACE,sYAAC,mVAAM,CAAC,GAAG;QACT,WAAW,CAAC,2CAA2C,EAAE,WAAW;QACpE,OAAO;YAAE,QAAQ;QAAU;QAC3B,SAAS;YAAE,SAAS;QAAE;QACtB,SAAS;YAAE,SAAS;QAAE;QACtB,MAAM;YAAE,SAAS;QAAE;QACnB,YAAY;YAAE,UAAU;QAAI;kBAE3B,cAAc,GAAG,CAAC,CAAC,OAAO,sBACzB,sYAAC;gBAEC,OAAO;gBACP,OAAO;gBACP,SAAS;gBACT,WAAW;gBACX,WAAW;eALN;;;;;;;;;;AAUf;;uCAEe"}},
    {"offset": {"line": 467, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallControls.tsx"],"sourcesContent":["'use client';\n\nimport { motion } from 'framer-motion';\nimport { Mic, MicOff, Phone, Volume2, VolumeX } from 'lucide-react';\nimport { springs } from '@/components/motion/config';\n\ninterface VoiceCallControlsProps {\n  isMuted: boolean;\n  isSpeakerOn: boolean;\n  onToggleMute: () => void;\n  onToggleSpeaker: () => void;\n  onEndCall: () => void;\n  disabled?: boolean;\n  className?: string;\n}\n\ninterface ControlButtonProps {\n  onClick: () => void;\n  disabled?: boolean;\n  isActive?: boolean;\n  variant?: 'default' | 'end';\n  ariaLabel: string;\n  children: React.ReactNode;\n}\n\nfunction ControlButton({\n  onClick,\n  disabled = false,\n  isActive = false,\n  variant = 'default',\n  ariaLabel,\n  children,\n}: ControlButtonProps) {\n  const isEndButton = variant === 'end';\n\n  const baseStyles = isEndButton\n    ? {\n        background: 'rgba(239, 68, 68, 0.9)',\n        boxShadow: '0 0 20px rgba(239, 68, 68, 0.4)',\n      }\n    : {\n        background: isActive\n          ? 'rgba(255, 255, 255, 0.2)'\n          : 'rgba(255, 255, 255, 0.1)',\n        backdropFilter: 'blur(10px)',\n        border: '1px solid rgba(255, 255, 255, 0.15)',\n      };\n\n  const hoverStyles = isEndButton\n    ? {\n        background: 'rgba(220, 38, 38, 0.95)',\n        boxShadow: '0 0 40px rgba(239, 68, 68, 0.6)',\n      }\n    : {\n        background: 'rgba(255, 255, 255, 0.2)',\n      };\n\n  const size = isEndButton ? 72 : 64;\n\n  return (\n    <motion.button\n      onClick={onClick}\n      disabled={disabled}\n      className={`\n        relative flex items-center justify-center rounded-full\n        text-white disabled:opacity-50 disabled:cursor-not-allowed\n        transition-colors duration-150\n      `}\n      style={{\n        width: size,\n        height: size,\n        ...baseStyles,\n      }}\n      whileHover={disabled ? {} : {\n        scale: 1.1,\n        ...hoverStyles,\n      }}\n      whileTap={disabled ? {} : { scale: isEndButton ? 0.85 : 0.9 }}\n      transition={springs.snappy}\n      aria-label={ariaLabel}\n    >\n      {children}\n    </motion.button>\n  );\n}\n\nexport function VoiceCallControls({\n  isMuted,\n  isSpeakerOn,\n  onToggleMute,\n  onToggleSpeaker,\n  onEndCall,\n  disabled = false,\n  className = '',\n}: VoiceCallControlsProps) {\n  return (\n    <motion.div\n      className={`flex items-center justify-center gap-6 ${className}`}\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{\n        type: 'spring',\n        stiffness: 300,\n        damping: 25,\n        delay: 0.2,\n      }}\n    >\n      {/* Mute button */}\n      <ControlButton\n        onClick={onToggleMute}\n        disabled={disabled}\n        isActive={isMuted}\n        ariaLabel={isMuted ? 'Unmute microphone' : 'Mute microphone'}\n      >\n        {isMuted ? <MicOff size={24} /> : <Mic size={24} />}\n      </ControlButton>\n\n      {/* End call button */}\n      <ControlButton\n        onClick={onEndCall}\n        disabled={disabled}\n        variant=\"end\"\n        ariaLabel=\"End call\"\n      >\n        <Phone size={28} className=\"rotate-[135deg]\" />\n      </ControlButton>\n\n      {/* Speaker button */}\n      <ControlButton\n        onClick={onToggleSpeaker}\n        disabled={disabled}\n        isActive={!isSpeakerOn}\n        ariaLabel={isSpeakerOn ? 'Turn off speaker' : 'Turn on speaker'}\n      >\n        {isSpeakerOn ? <Volume2 size={24} /> : <VolumeX size={24} />}\n      </ControlButton>\n    </motion.div>\n  );\n}\n\nexport default VoiceCallControls;\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAJA;;;;;AAyBA,SAAS,cAAc,EACrB,OAAO,EACP,WAAW,KAAK,EAChB,WAAW,KAAK,EAChB,UAAU,SAAS,EACnB,SAAS,EACT,QAAQ,EACW;IACnB,MAAM,cAAc,YAAY;IAEhC,MAAM,aAAa,cACf;QACE,YAAY;QACZ,WAAW;IACb,IACA;QACE,YAAY,WACR,6BACA;QACJ,gBAAgB;QAChB,QAAQ;IACV;IAEJ,MAAM,cAAc,cAChB;QACE,YAAY;QACZ,WAAW;IACb,IACA;QACE,YAAY;IACd;IAEJ,MAAM,OAAO,cAAc,KAAK;IAEhC,qBACE,sYAAC,mVAAM,CAAC,MAAM;QACZ,SAAS;QACT,UAAU;QACV,WAAW,CAAC;;;;MAIZ,CAAC;QACD,OAAO;YACL,OAAO;YACP,QAAQ;YACR,GAAG,UAAU;QACf;QACA,YAAY,WAAW,CAAC,IAAI;YAC1B,OAAO;YACP,GAAG,WAAW;QAChB;QACA,UAAU,WAAW,CAAC,IAAI;YAAE,OAAO,cAAc,OAAO;QAAI;QAC5D,YAAY,mJAAO,CAAC,MAAM;QAC1B,cAAY;kBAEX;;;;;;AAGP;KA3DS;AA6DF,SAAS,kBAAkB,EAChC,OAAO,EACP,WAAW,EACX,YAAY,EACZ,eAAe,EACf,SAAS,EACT,WAAW,KAAK,EAChB,YAAY,EAAE,EACS;IACvB,qBACE,sYAAC,mVAAM,CAAC,GAAG;QACT,WAAW,CAAC,uCAAuC,EAAE,WAAW;QAChE,SAAS;YAAE,SAAS;YAAG,GAAG;QAAG;QAC7B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,YAAY;YACV,MAAM;YACN,WAAW;YACX,SAAS;YACT,OAAO;QACT;;0BAGA,sYAAC;gBACC,SAAS;gBACT,UAAU;gBACV,UAAU;gBACV,WAAW,UAAU,sBAAsB;0BAE1C,wBAAU,sYAAC,2SAAM;oBAAC,MAAM;;;;;yCAAS,sYAAC,8RAAG;oBAAC,MAAM;;;;;;;;;;;0BAI/C,sYAAC;gBACC,SAAS;gBACT,UAAU;gBACV,SAAQ;gBACR,WAAU;0BAEV,cAAA,sYAAC,oSAAK;oBAAC,MAAM;oBAAI,WAAU;;;;;;;;;;;0BAI7B,sYAAC;gBACC,SAAS;gBACT,UAAU;gBACV,UAAU,CAAC;gBACX,WAAW,cAAc,qBAAqB;0BAE7C,4BAAc,sYAAC,8SAAO;oBAAC,MAAM;;;;;yCAAS,sYAAC,8SAAO;oBAAC,MAAM;;;;;;;;;;;;;;;;;AAI9D;MApDgB;uCAsDD"}},
    {"offset": {"line": 634, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallStatus.tsx"],"sourcesContent":["'use client';\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useMemo } from 'react';\n\ntype CallStatus = 'connecting' | 'connected' | 'listening' | 'speaking' | 'thinking' | 'ending';\n\ninterface VoiceCallStatusProps {\n  status: CallStatus;\n  duration: number; // seconds\n  className?: string;\n}\n\nfunction formatDuration(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n}\n\nfunction getStatusText(status: CallStatus): string {\n  switch (status) {\n    case 'connecting':\n      return 'Connecting...';\n    case 'connected':\n      return 'Connected';\n    case 'listening':\n      return 'Listening...';\n    case 'speaking':\n      return 'Claw AI';\n    case 'thinking':\n      return 'Thinking...';\n    case 'ending':\n      return 'Call ended';\n    default:\n      return '';\n  }\n}\n\nexport function VoiceCallStatus({\n  status,\n  duration,\n  className = '',\n}: VoiceCallStatusProps) {\n  const formattedDuration = useMemo(() => formatDuration(duration), [duration]);\n  const statusText = getStatusText(status);\n  const showTimer = status !== 'connecting';\n\n  return (\n    <motion.div\n      className={`flex flex-col items-center gap-1 ${className}`}\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{\n        type: 'spring',\n        stiffness: 300,\n        damping: 25,\n        delay: 0.1,\n      }}\n    >\n      {/* Name / Status text */}\n      <AnimatePresence mode=\"wait\">\n        <motion.span\n          key={status}\n          className=\"text-white text-xl font-medium\"\n          initial={{ opacity: 0, y: -5 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: 5 }}\n          transition={{ duration: 0.15 }}\n        >\n          {statusText}\n        </motion.span>\n      </AnimatePresence>\n\n      {/* Timer */}\n      <AnimatePresence>\n        {showTimer && (\n          <motion.span\n            className=\"text-white/70 text-sm font-mono tabular-nums\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            {formattedDuration}\n          </motion.span>\n        )}\n      </AnimatePresence>\n\n      {/* Connecting dots animation */}\n      {status === 'connecting' && (\n        <motion.div\n          className=\"flex gap-1 mt-1\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n        >\n          {[0, 1, 2].map((i) => (\n            <motion.div\n              key={i}\n              className=\"w-1.5 h-1.5 rounded-full bg-white/60\"\n              animate={{\n                y: [0, -4, 0],\n                opacity: [0.6, 1, 0.6],\n              }}\n              transition={{\n                duration: 0.6,\n                repeat: Infinity,\n                delay: i * 0.15,\n                ease: 'easeInOut',\n              }}\n            />\n          ))}\n        </motion.div>\n      )}\n    </motion.div>\n  );\n}\n\nexport default VoiceCallStatus;\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AACA;;;AAHA;;;AAaA,SAAS,eAAe,OAAe;IACrC,MAAM,OAAO,KAAK,KAAK,CAAC,UAAU;IAClC,MAAM,OAAO,UAAU;IACvB,OAAO,GAAG,KAAK,QAAQ,GAAG,QAAQ,CAAC,GAAG,KAAK,CAAC,EAAE,KAAK,QAAQ,GAAG,QAAQ,CAAC,GAAG,MAAM;AAClF;AAEA,SAAS,cAAc,MAAkB;IACvC,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAEO,SAAS,gBAAgB,EAC9B,MAAM,EACN,QAAQ,EACR,YAAY,EAAE,EACO;;IACrB,MAAM,oBAAoB,IAAA,iXAAO;sDAAC,IAAM,eAAe;qDAAW;QAAC;KAAS;IAC5E,MAAM,aAAa,cAAc;IACjC,MAAM,YAAY,WAAW;IAE7B,qBACE,sYAAC,mVAAM,CAAC,GAAG;QACT,WAAW,CAAC,iCAAiC,EAAE,WAAW;QAC1D,SAAS;YAAE,SAAS;YAAG,GAAG,CAAC;QAAG;QAC9B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,YAAY;YACV,MAAM;YACN,WAAW;YACX,SAAS;YACT,OAAO;QACT;;0BAGA,sYAAC,2VAAe;gBAAC,MAAK;0BACpB,cAAA,sYAAC,mVAAM,CAAC,IAAI;oBAEV,WAAU;oBACV,SAAS;wBAAE,SAAS;wBAAG,GAAG,CAAC;oBAAE;oBAC7B,SAAS;wBAAE,SAAS;wBAAG,GAAG;oBAAE;oBAC5B,MAAM;wBAAE,SAAS;wBAAG,GAAG;oBAAE;oBACzB,YAAY;wBAAE,UAAU;oBAAK;8BAE5B;mBAPI;;;;;;;;;;0BAYT,sYAAC,2VAAe;0BACb,2BACC,sYAAC,mVAAM,CAAC,IAAI;oBACV,WAAU;oBACV,SAAS;wBAAE,SAAS;oBAAE;oBACtB,SAAS;wBAAE,SAAS;oBAAE;oBACtB,MAAM;wBAAE,SAAS;oBAAE;oBACnB,YAAY;wBAAE,UAAU;oBAAI;8BAE3B;;;;;;;;;;;YAMN,WAAW,8BACV,sYAAC,mVAAM,CAAC,GAAG;gBACT,WAAU;gBACV,SAAS;oBAAE,SAAS;gBAAE;gBACtB,SAAS;oBAAE,SAAS;gBAAE;0BAErB;oBAAC;oBAAG;oBAAG;iBAAE,CAAC,GAAG,CAAC,CAAC,kBACd,sYAAC,mVAAM,CAAC,GAAG;wBAET,WAAU;wBACV,SAAS;4BACP,GAAG;gCAAC;gCAAG,CAAC;gCAAG;6BAAE;4BACb,SAAS;gCAAC;gCAAK;gCAAG;6BAAI;wBACxB;wBACA,YAAY;4BACV,UAAU;4BACV,QAAQ;4BACR,OAAO,IAAI;4BACX,MAAM;wBACR;uBAXK;;;;;;;;;;;;;;;;AAkBnB;GA7EgB;KAAA;uCA+ED"}},
    {"offset": {"line": 815, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceCallScreen.tsx"],"sourcesContent":["'use client';\n\nimport { motion, AnimatePresence, useReducedMotion } from 'framer-motion';\nimport { useEffect } from 'react';\nimport { VoiceCallAvatar } from './VoiceCallAvatar';\nimport { VoiceCallStatus } from './VoiceCallStatus';\nimport { VoiceCallWaveform } from './VoiceCallWaveform';\nimport { VoiceCallControls } from './VoiceCallControls';\nimport { springs } from '@/components/motion/config';\n\ntype CallStatus = 'connecting' | 'connected' | 'listening' | 'speaking' | 'thinking' | 'ending';\n\n// Debug logging\nconst LOG_PREFIX = '[VoiceCallScreen]';\nconst log = {\n  info: (msg: string, data?: unknown) => console.log(`${LOG_PREFIX} ${msg}`, data ?? ''),\n  lifecycle: (event: string, data?: unknown) => console.log(`${LOG_PREFIX} [LIFECYCLE] ${event}`, data ?? ''),\n};\n\ninterface VoiceCallScreenProps {\n  isOpen: boolean;\n  onClose: () => void;\n  status: CallStatus;\n  duration: number;\n  isMuted: boolean;\n  isSpeakerOn: boolean;\n  userAudioLevels: number[];\n  aiAudioLevels: number[];\n  onToggleMute: () => void;\n  onToggleSpeaker: () => void;\n  onEndCall: () => void;\n}\n\nexport function VoiceCallScreen({\n  isOpen,\n  onClose,\n  status,\n  duration,\n  isMuted,\n  isSpeakerOn,\n  userAudioLevels,\n  aiAudioLevels,\n  onToggleMute,\n  onToggleSpeaker,\n  onEndCall,\n}: VoiceCallScreenProps) {\n  const prefersReducedMotion = useReducedMotion();\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    if (!isOpen) return;\n    log.lifecycle('Keyboard shortcuts registered', { isOpen });\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'Escape':\n          log.info('Escape key pressed - ending call');\n          onEndCall();\n          break;\n        case 'm':\n        case 'M':\n          log.info('M key pressed - toggling mute');\n          onToggleMute();\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => {\n      log.lifecycle('Keyboard shortcuts unregistered');\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isOpen, onEndCall, onToggleMute]);\n\n  // Close after ending\n  useEffect(() => {\n    if (status === 'ending') {\n      log.lifecycle('Status is ending, scheduling close (1500ms)');\n      const timer = setTimeout(() => {\n        log.lifecycle('Closing screen');\n        onClose();\n      }, 1500);\n      return () => clearTimeout(timer);\n    }\n  }, [status, onClose]);\n\n  // Log status changes\n  useEffect(() => {\n    log.lifecycle('Status changed', { status, duration, isOpen });\n  }, [status, duration, isOpen]);\n\n  // Determine which audio levels to show\n  const showUserWaveform = status === 'listening';\n  const showAiWaveform = status === 'speaking';\n  const waveformVariant = showUserWaveform ? 'user' : 'ai';\n  const waveformLevels = showUserWaveform ? userAudioLevels : aiAudioLevels;\n  const showWaveform = showUserWaveform || showAiWaveform;\n\n  const screenVariants = {\n    hidden: {\n      y: '100%',\n      opacity: 0,\n      filter: prefersReducedMotion ? 'blur(0px)' : 'blur(10px)',\n    },\n    visible: {\n      y: 0,\n      opacity: 1,\n      filter: 'blur(0px)',\n      transition: prefersReducedMotion\n        ? { duration: 0.15 }\n        : springs.smooth,\n    },\n    exit: {\n      y: '100%',\n      opacity: 0,\n      filter: prefersReducedMotion ? 'blur(0px)' : 'blur(10px)',\n      transition: {\n        duration: 0.3,\n        ease: [0.23, 1, 0.32, 1] as const,\n      },\n    },\n  };\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"fixed inset-0 z-50 flex items-center justify-center\"\n          initial=\"hidden\"\n          animate=\"visible\"\n          exit=\"exit\"\n          variants={screenVariants}\n        >\n          {/* Backdrop blur */}\n          <motion.div\n            className=\"absolute inset-0 bg-black/60\"\n            style={{\n              backdropFilter: 'blur(20px)',\n              WebkitBackdropFilter: 'blur(20px)',\n            }}\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.2 }}\n          />\n\n          {/* Glass container */}\n          <motion.div\n            className=\"relative w-full max-w-sm mx-4 overflow-hidden\"\n            style={{\n              background: 'linear-gradient(180deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%)',\n              backdropFilter: 'blur(40px) saturate(180%)',\n              WebkitBackdropFilter: 'blur(40px) saturate(180%)',\n              boxShadow: '0 -10px 40px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.15)',\n              border: '1px solid rgba(255, 255, 255, 0.1)',\n              borderRadius: 32,\n              padding: '48px 32px',\n            }}\n            initial={{ scale: 0.9, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            exit={{ scale: 0.9, opacity: 0 }}\n            transition={{\n              type: 'spring',\n              stiffness: 300,\n              damping: 25,\n              delay: 0.1,\n            }}\n          >\n            {/* Content stack */}\n            <div className=\"flex flex-col items-center gap-8\">\n              {/* Avatar */}\n              <motion.div\n                initial={{ scale: 0.8, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{\n                  type: 'spring',\n                  stiffness: 300,\n                  damping: 20,\n                  delay: 0.15,\n                }}\n              >\n                <VoiceCallAvatar status={status} size={160} />\n              </motion.div>\n\n              {/* Status and timer */}\n              <VoiceCallStatus status={status} duration={duration} />\n\n              {/* Waveform visualization */}\n              <div className=\"h-12 flex items-center justify-center\">\n                <AnimatePresence mode=\"wait\">\n                  {showWaveform ? (\n                    <motion.div\n                      key=\"waveform\"\n                      initial={{ opacity: 0, scale: 0.95 }}\n                      animate={{ opacity: 1, scale: 1 }}\n                      exit={{ opacity: 0, scale: 0.95 }}\n                      transition={{ duration: 0.2 }}\n                    >\n                      <VoiceCallWaveform\n                        audioLevels={waveformLevels}\n                        isActive={true}\n                        variant={waveformVariant}\n                        barCount={16}\n                      />\n                    </motion.div>\n                  ) : status === 'thinking' ? (\n                    <motion.div\n                      key=\"thinking\"\n                      className=\"flex gap-1\"\n                      initial={{ opacity: 0 }}\n                      animate={{ opacity: 1 }}\n                      exit={{ opacity: 0 }}\n                    >\n                      {[0, 1, 2, 3, 4].map((i) => (\n                        <motion.div\n                          key={i}\n                          className=\"w-3 h-3 rounded-full bg-[hsl(var(--theme-accent)/0.6)]\"\n                          animate={{\n                            scale: [1, 1.3, 1],\n                            opacity: [0.6, 1, 0.6],\n                          }}\n                          transition={{\n                            duration: 1,\n                            repeat: Infinity,\n                            delay: i * 0.15,\n                            ease: 'easeInOut',\n                          }}\n                        />\n                      ))}\n                    </motion.div>\n                  ) : (\n                    <motion.div\n                      key=\"idle\"\n                      className=\"h-8\"\n                      initial={{ opacity: 0 }}\n                      animate={{ opacity: 1 }}\n                      exit={{ opacity: 0 }}\n                    >\n                      <VoiceCallWaveform\n                        audioLevels={[]}\n                        isActive={false}\n                        variant=\"user\"\n                        barCount={16}\n                      />\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n\n              {/* Controls */}\n              <VoiceCallControls\n                isMuted={isMuted}\n                isSpeakerOn={isSpeakerOn}\n                onToggleMute={onToggleMute}\n                onToggleSpeaker={onToggleSpeaker}\n                onEndCall={onEndCall}\n                disabled={status === 'ending'}\n              />\n            </div>\n          </motion.div>\n\n          {/* Screen reader announcements */}\n          <div role=\"status\" aria-live=\"polite\" className=\"sr-only\">\n            {status === 'connecting' && <span key=\"connecting\">Call connecting</span>}\n            {status === 'connected' && <span key=\"connected\">Call connected. Duration: {duration} seconds</span>}\n            {status === 'speaking' && <span key=\"speaking\">Claw AI is speaking</span>}\n            {status === 'listening' && <span key=\"listening\">Claw AI is listening</span>}\n            {status === 'thinking' && <span key=\"thinking\">Claw AI is thinking</span>}\n            {status === 'ending' && <span key=\"ending\">Call ended. Duration: {Math.floor(duration / 60)} minutes {duration % 60} seconds</span>}\n          </div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n\nexport default VoiceCallScreen;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1283, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/useVoiceCall.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { Room, RoomEvent, Track, RemoteParticipant, LocalAudioTrack, createLocalAudioTrack } from 'livekit-client';\n\nexport type CallStatus = 'idle' | 'connecting' | 'connected' | 'listening' | 'speaking' | 'thinking' | 'ending';\n\n// Debug logging utility\nconst LOG_PREFIX = '[VoiceCall]';\nconst log = {\n  info: (msg: string, data?: unknown) => console.log(`${LOG_PREFIX} ${msg}`, data ?? ''),\n  warn: (msg: string, data?: unknown) => console.warn(`${LOG_PREFIX} ${msg}`, data ?? ''),\n  error: (msg: string, data?: unknown) => console.error(`${LOG_PREFIX} ${msg}`, data ?? ''),\n  state: (status: CallStatus, extra?: Record<string, unknown>) =>\n    console.log(`${LOG_PREFIX} [STATE] ${status}`, extra ?? ''),\n};\n\ninterface VoiceCallState {\n  status: CallStatus;\n  duration: number;\n  isMuted: boolean;\n  isSpeakerOn: boolean;\n  userAudioLevels: number[];\n  aiAudioLevels: number[];\n  error: string | null;\n}\n\ninterface VoiceCallActions {\n  startCall: () => Promise<void>;\n  endCall: () => void;\n  toggleMute: () => void;\n  toggleSpeaker: () => void;\n}\n\ninterface UseVoiceCallOptions {\n  onCallStart?: () => void;\n  onCallEnd?: (duration: number) => void;\n  onError?: (error: string) => void;\n}\n\nconst INITIAL_STATE: VoiceCallState = {\n  status: 'idle',\n  duration: 0,\n  isMuted: false,\n  isSpeakerOn: true,\n  userAudioLevels: [],\n  aiAudioLevels: [],\n  error: null,\n};\n\nexport function useVoiceCall(options: UseVoiceCallOptions = {}): [VoiceCallState, VoiceCallActions] {\n  const { onCallStart, onCallEnd, onError } = options;\n\n  const [state, setState] = useState<VoiceCallState>(INITIAL_STATE);\n  const durationIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const audioLevelIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const roomRef = useRef<Room | null>(null);\n  const localAudioTrackRef = useRef<LocalAudioTrack | null>(null);\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n\n  // Cleanup function\n  const cleanup = useCallback(async () => {\n    log.info('cleanup() - disconnecting from room and clearing intervals');\n\n    // Clear intervals\n    if (durationIntervalRef.current) {\n      clearInterval(durationIntervalRef.current);\n      durationIntervalRef.current = null;\n      log.info('Duration interval cleared');\n    }\n    if (audioLevelIntervalRef.current) {\n      clearInterval(audioLevelIntervalRef.current);\n      audioLevelIntervalRef.current = null;\n      log.info('Audio level interval cleared');\n    }\n\n    // Disconnect from room\n    if (roomRef.current) {\n      await roomRef.current.disconnect();\n      roomRef.current = null;\n      log.info('Room disconnected');\n    }\n\n    // Clean up local audio track\n    if (localAudioTrackRef.current) {\n      localAudioTrackRef.current.stop();\n      localAudioTrackRef.current = null;\n      log.info('Local audio track stopped');\n    }\n\n    // Clean up audio context\n    if (audioContextRef.current) {\n      await audioContextRef.current.close();\n      audioContextRef.current = null;\n      analyserRef.current = null;\n      log.info('Audio context closed');\n    }\n  }, []);\n\n  // Start duration timer\n  const startDurationTimer = useCallback(() => {\n    durationIntervalRef.current = setInterval(() => {\n      setState(prev => ({ ...prev, duration: prev.duration + 1 }));\n    }, 1000);\n  }, []);\n\n  // Monitor audio levels from WebRTC tracks\n  const startAudioLevelMonitoring = useCallback(() => {\n    audioLevelIntervalRef.current = setInterval(() => {\n      const room = roomRef.current;\n      if (!room) return;\n\n      // Get user's local audio level\n      const localParticipant = room.localParticipant;\n      const localAudioTrack = localParticipant?.audioTrackPublications.values().next().value?.track;\n      let userLevels: number[] = [];\n\n      if (localAudioTrack && analyserRef.current) {\n        const dataArray = new Uint8Array(analyserRef.current.frequencyBinCount);\n        analyserRef.current.getByteFrequencyData(dataArray);\n        // Convert to 16 bars\n        userLevels = Array.from({ length: 16 }, (_, i) => {\n          const index = Math.floor((i / 16) * dataArray.length);\n          return dataArray[index] / 255;\n        });\n      }\n\n      // Get AI agent's audio level\n      const remoteParticipants = Array.from(room.remoteParticipants.values());\n      const aiParticipant = remoteParticipants.find(p => p.identity === 'claw-ai-agent');\n      let aiLevels: number[] = [];\n\n      if (aiParticipant) {\n        const aiAudioPub = aiParticipant.audioTrackPublications.values().next().value;\n        if (aiAudioPub?.track && !aiAudioPub.isMuted) {\n          // Use a pulsing effect for AI audio since we can't easily get levels from remote tracks\n          const time = Date.now() / 1000;\n          const pulse = (Math.sin(time * 4) + 1) / 4 + 0.3; // Gentle pulse between 0.3-0.8\n          aiLevels = Array(16).fill(pulse);\n        }\n      }\n\n      setState(prev => ({\n        ...prev,\n        userAudioLevels: userLevels,\n        aiAudioLevels: aiLevels,\n      }));\n    }, 50);\n  }, []);\n\n  // Start call\n  const startCall = useCallback(async () => {\n    log.info('startCall() initiated');\n    try {\n      setState(prev => ({ ...prev, status: 'connecting', error: null }));\n      log.state('connecting');\n\n      // Generate room name (unique per call)\n      const roomName = `voice-call-${Date.now()}`;\n      const participantName = 'User';\n      const participantIdentity = `user-${Date.now()}`;\n\n      // Request access token from API\n      log.info('Requesting LiveKit token', { roomName, participantName });\n      const tokenResponse = await fetch('/api/livekit/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          roomName,\n          participantName,\n          participantIdentity,\n        }),\n      });\n\n      if (!tokenResponse.ok) {\n        throw new Error(`Token generation failed: ${tokenResponse.statusText}`);\n      }\n\n      const { token, url } = await tokenResponse.json();\n      log.info('Token received', { url });\n\n      // Create LiveKit room\n      const room = new Room();\n      roomRef.current = room;\n\n      // Set up event handlers\n      room.on(RoomEvent.Connected, () => {\n        log.info('Room connected');\n        setState(prev => ({ ...prev, status: 'connected' }));\n        log.state('connected');\n        startDurationTimer();\n        startAudioLevelMonitoring();\n        onCallStart?.();\n      });\n\n      room.on(RoomEvent.Disconnected, () => {\n        log.info('Room disconnected');\n        cleanup();\n      });\n\n      room.on(RoomEvent.ParticipantConnected, (participant: RemoteParticipant) => {\n        log.info('Participant connected', { identity: participant.identity });\n        if (participant.identity === 'claw-ai-agent') {\n          setState(prev => ({ ...prev, status: 'listening' }));\n          log.state('listening', { reason: 'AI agent joined' });\n        }\n      });\n\n      room.on(RoomEvent.TrackSubscribed, (track, publication, participant) => {\n        log.info('Track subscribed', {\n          kind: track.kind,\n          participant: participant.identity\n        });\n\n        if (track.kind === 'audio' && participant.identity === 'claw-ai-agent') {\n          // AI agent is speaking\n          setState(prev => ({ ...prev, status: 'speaking' }));\n          log.state('speaking', { reason: 'AI audio track active' });\n        }\n      });\n\n      room.on(RoomEvent.TrackUnsubscribed, (track, publication, participant) => {\n        log.info('Track unsubscribed', {\n          kind: track.kind,\n          participant: participant.identity\n        });\n\n        if (track.kind === 'audio' && participant.identity === 'claw-ai-agent') {\n          // AI agent stopped speaking\n          setState(prev => ({ ...prev, status: 'listening' }));\n          log.state('listening', { reason: 'AI audio track inactive' });\n        }\n      });\n\n      // Create local audio track\n      log.info('Creating local audio track');\n      const localAudioTrack = await createLocalAudioTrack({\n        echoCancellation: true,\n        noiseSuppression: true,\n        autoGainControl: true,\n      });\n      localAudioTrackRef.current = localAudioTrack;\n\n      // Set up audio level analysis\n      const audioContext = new AudioContext();\n      audioContextRef.current = audioContext;\n      const source = audioContext.createMediaStreamSource(localAudioTrack.mediaStream!);\n      const analyser = audioContext.createAnalyser();\n      analyser.fftSize = 32; // 16 bars\n      source.connect(analyser);\n      analyserRef.current = analyser;\n\n      // Connect to room\n      log.info('Connecting to LiveKit room', { url, roomName });\n      await room.connect(url, token);\n\n      // Publish local audio track\n      await room.localParticipant.publishTrack(localAudioTrack, {\n        source: Track.Source.Microphone,\n      });\n      log.info('Local audio track published');\n\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to connect';\n      log.error('startCall failed', { error: errorMessage });\n      setState(prev => ({ ...prev, status: 'idle', error: errorMessage }));\n      await cleanup();\n      onError?.(errorMessage);\n    }\n  }, [startDurationTimer, startAudioLevelMonitoring, onCallStart, onError, cleanup]);\n\n  // End call\n  const endCall = useCallback(async () => {\n    const finalDuration = state.duration;\n    log.info('endCall() initiated', { finalDuration });\n    setState(prev => ({ ...prev, status: 'ending' }));\n    log.state('ending');\n\n    await cleanup();\n    log.info('Cleanup complete, scheduling state reset (1500ms)');\n\n    setTimeout(() => {\n      setState(INITIAL_STATE);\n      log.state('idle', { reason: 'call ended', totalDuration: finalDuration });\n      onCallEnd?.(finalDuration);\n    }, 1500);\n  }, [state.duration, cleanup, onCallEnd]);\n\n  // Toggle mute\n  const toggleMute = useCallback(() => {\n    const room = roomRef.current;\n    const localAudioTrack = localAudioTrackRef.current;\n\n    if (room && localAudioTrack) {\n      const newMuted = !state.isMuted;\n      log.info('toggleMute', { isMuted: newMuted });\n\n      // Mute/unmute the track\n      if (newMuted) {\n        localAudioTrack.mute();\n      } else {\n        localAudioTrack.unmute();\n      }\n\n      setState(prev => ({ ...prev, isMuted: newMuted }));\n    } else {\n      // Fallback to state-only toggle if room not connected\n      setState(prev => {\n        const newMuted = !prev.isMuted;\n        log.info('toggleMute (fallback)', { isMuted: newMuted });\n        return { ...prev, isMuted: newMuted };\n      });\n    }\n  }, [state.isMuted]);\n\n  // Toggle speaker\n  const toggleSpeaker = useCallback(() => {\n    const room = roomRef.current;\n\n    if (room) {\n      const newSpeakerOn = !state.isSpeakerOn;\n      log.info('toggleSpeaker', { isSpeakerOn: newSpeakerOn });\n\n      // Enable/disable audio output for remote participants\n      // Note: setVolume is not available on RemoteTrack, so we toggle the track enabled state\n      room.remoteParticipants.forEach((participant) => {\n        participant.audioTrackPublications.forEach((publication) => {\n          if (publication.track) {\n            // Access the underlying media element if attached\n            const attachedElements = publication.track.attachedElements;\n            if (attachedElements && attachedElements.length > 0) {\n              attachedElements.forEach((el) => {\n                if (el instanceof HTMLAudioElement || el instanceof HTMLVideoElement) {\n                  el.muted = !newSpeakerOn;\n                }\n              });\n            }\n          }\n        });\n      });\n\n      setState(prev => ({ ...prev, isSpeakerOn: newSpeakerOn }));\n    } else {\n      // Fallback to state-only toggle if room not connected\n      setState(prev => {\n        const newSpeakerOn = !prev.isSpeakerOn;\n        log.info('toggleSpeaker (fallback)', { isSpeakerOn: newSpeakerOn });\n        return { ...prev, isSpeakerOn: newSpeakerOn };\n      });\n    }\n  }, [state.isSpeakerOn]);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      // Wrap async cleanup in void function for useEffect compatibility\n      void cleanup();\n    };\n  }, [cleanup]);\n\n  const actions: VoiceCallActions = {\n    startCall,\n    endCall,\n    toggleMute,\n    toggleSpeaker,\n  };\n\n  return [state, actions];\n}\n\nexport default useVoiceCall;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1759, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceAmbientGlow.tsx"],"sourcesContent":["'use client';\n\nimport { motion, useReducedMotion } from 'framer-motion';\nimport { useMemo } from 'react';\n\ntype VoiceState = 'idle' | 'listening' | 'processing' | 'speaking';\n\ninterface VoiceAmbientGlowProps {\n  state: VoiceState;\n  intensity?: number; // 0-1, for audio level reactivity\n  className?: string;\n}\n\n// Debug logging\nconst LOG_PREFIX = '[VoiceAmbientGlow]';\nconst log = {\n  state: (state: VoiceState, intensity: number) =>\n    console.log(`${LOG_PREFIX} state=${state} intensity=${intensity.toFixed(2)}`),\n};\n\nexport function VoiceAmbientGlow({\n  state,\n  intensity = 0.5,\n  className = ''\n}: VoiceAmbientGlowProps) {\n  const prefersReducedMotion = useReducedMotion();\n\n  // Color configurations for each state\n  const stateColors = useMemo(() => ({\n    idle: {\n      primary: 'rgba(255, 255, 255, 0.02)',\n      secondary: 'rgba(255, 255, 255, 0.01)',\n      glow: 'transparent',\n    },\n    listening: {\n      primary: 'rgba(34, 197, 94, 0.15)', // Green\n      secondary: 'rgba(34, 197, 94, 0.08)',\n      glow: 'rgba(34, 197, 94, 0.3)',\n    },\n    processing: {\n      primary: 'rgba(251, 191, 36, 0.12)', // Amber\n      secondary: 'rgba(251, 191, 36, 0.06)',\n      glow: 'rgba(251, 191, 36, 0.2)',\n    },\n    speaking: {\n      primary: 'rgba(251, 146, 60, 0.18)', // Orange\n      secondary: 'rgba(251, 146, 60, 0.10)',\n      glow: 'rgba(251, 146, 60, 0.35)',\n    },\n  }), []);\n\n  const colors = stateColors[state];\n\n  // Height varies with state and intensity\n  const baseHeight = state === 'idle' ? 0 : state === 'listening' ? 30 : state === 'processing' ? 40 : 50;\n  const dynamicHeight = baseHeight + (intensity * 20);\n\n  // Log state changes (throttled in production)\n  // log.state(state, intensity);\n\n  return (\n    <motion.div\n      className={`pointer-events-none fixed inset-x-0 bottom-0 z-40 ${className}`}\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n    >\n      {/* Primary glow layer */}\n      <motion.div\n        className=\"absolute inset-x-0 bottom-0\"\n        animate={{\n          height: `${dynamicHeight}vh`,\n          background: `linear-gradient(to top, ${colors.primary}, ${colors.secondary}, transparent)`,\n        }}\n        transition={prefersReducedMotion ? { duration: 0.1 } : {\n          type: 'spring',\n          stiffness: 100,\n          damping: 20,\n        }}\n      />\n\n      {/* Secondary pulse layer for speaking state */}\n      {state === 'speaking' && (\n        <motion.div\n          className=\"absolute inset-x-0 bottom-0\"\n          initial={{ height: '20vh', opacity: 0 }}\n          animate={{\n            height: ['20vh', '35vh', '20vh'],\n            opacity: [0.3, 0.6, 0.3],\n          }}\n          transition={prefersReducedMotion ? { duration: 0 } : {\n            duration: 2,\n            repeat: Infinity,\n            ease: 'easeInOut',\n          }}\n          style={{\n            background: `radial-gradient(ellipse 80% 50% at 50% 100%, ${colors.glow}, transparent)`,\n          }}\n        />\n      )}\n\n      {/* Listening pulse - subtle green */}\n      {state === 'listening' && (\n        <motion.div\n          className=\"absolute inset-x-0 bottom-0\"\n          initial={{ height: '15vh', opacity: 0 }}\n          animate={{\n            height: ['15vh', '25vh', '15vh'],\n            opacity: [0.2, 0.4, 0.2],\n          }}\n          transition={prefersReducedMotion ? { duration: 0 } : {\n            duration: 1.5,\n            repeat: Infinity,\n            ease: 'easeInOut',\n          }}\n          style={{\n            background: `radial-gradient(ellipse 70% 40% at 50% 100%, ${colors.glow}, transparent)`,\n          }}\n        />\n      )}\n\n      {/* Processing shimmer */}\n      {state === 'processing' && (\n        <motion.div\n          className=\"absolute inset-x-0 bottom-0 h-[30vh]\"\n          animate={{\n            opacity: [0.3, 0.6, 0.3],\n          }}\n          transition={prefersReducedMotion ? { duration: 0 } : {\n            duration: 1,\n            repeat: Infinity,\n            ease: 'easeInOut',\n          }}\n          style={{\n            background: `radial-gradient(ellipse 60% 40% at 50% 100%, ${colors.glow}, transparent)`,\n          }}\n        />\n      )}\n\n      {/* Bottom edge highlight */}\n      {state !== 'idle' && (\n        <motion.div\n          className=\"absolute inset-x-0 bottom-0 h-1\"\n          initial={{ scaleX: 0, opacity: 0 }}\n          animate={{ scaleX: 1, opacity: 0.6 }}\n          exit={{ scaleX: 0, opacity: 0 }}\n          transition={{ duration: 0.3 }}\n          style={{\n            background: `linear-gradient(90deg, transparent, ${colors.glow}, transparent)`,\n          }}\n        />\n      )}\n    </motion.div>\n  );\n}\n\nexport default VoiceAmbientGlow;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1981, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/VoiceOverlay.tsx"],"sourcesContent":["'use client';\n\nimport { motion, AnimatePresence, useReducedMotion } from 'framer-motion';\nimport { useEffect, useCallback } from 'react';\nimport { Plus, ArrowUp, Square, X } from 'lucide-react';\nimport { VoiceAmbientGlow } from './VoiceAmbientGlow';\nimport { ClawAIAvatar } from '@/components/claw-ai/ClawAIAvatar';\n\nexport type VoiceOverlayState = 'idle' | 'listening' | 'processing' | 'speaking';\n\ninterface VoiceOverlayProps {\n  isOpen: boolean;\n  state: VoiceOverlayState;\n  onTapAnywhere: () => void;\n  onClose: () => void;\n  onAttach?: () => void;\n  audioIntensity?: number;\n  transcript?: string;\n  response?: string;\n  className?: string;\n}\n\n// Debug logging\nconst LOG_PREFIX = '[VoiceOverlay]';\nconst log = {\n  info: (msg: string, data?: unknown) => console.log(`${LOG_PREFIX} ${msg}`, data ?? ''),\n  action: (action: string) => console.log(`${LOG_PREFIX} [ACTION] ${action}`),\n};\n\n// Status text for each state\nconst STATUS_TEXT: Record<VoiceOverlayState, string> = {\n  idle: 'Tap to start',\n  listening: 'Ready and listening',\n  processing: 'Just a sec...',\n  speaking: 'Tap anywhere to interrupt',\n};\n\nexport function VoiceOverlay({\n  isOpen,\n  state,\n  onTapAnywhere,\n  onClose,\n  onAttach,\n  audioIntensity = 0.5,\n  transcript,\n  response,\n  className = '',\n}: VoiceOverlayProps) {\n  const prefersReducedMotion = useReducedMotion();\n\n  // Handle tap anywhere on the overlay\n  const handleOverlayTap = useCallback((e: React.MouseEvent | React.TouchEvent) => {\n    const target = e.target as HTMLElement;\n    if (target.closest('[data-control-button]')) {\n      return;\n    }\n\n    log.action(`tap_anywhere state=${state}`);\n\n    if (state === 'listening' || state === 'speaking') {\n      onTapAnywhere();\n    }\n  }, [state, onTapAnywhere]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    if (!isOpen) return;\n    log.info('Keyboard shortcuts registered');\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'Escape':\n          log.action('escape_pressed');\n          onClose();\n          break;\n        case ' ': // Spacebar\n          e.preventDefault();\n          log.action('spacebar_pressed');\n          if (state === 'listening' || state === 'speaking') {\n            onTapAnywhere();\n          }\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => {\n      log.info('Keyboard shortcuts unregistered');\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isOpen, state, onTapAnywhere, onClose]);\n\n  const getCenterButton = () => {\n    switch (state) {\n      case 'listening':\n        return { icon: ArrowUp, label: 'Send' };\n      case 'speaking':\n      case 'processing':\n        return { icon: Square, label: 'Stop' };\n      default:\n        return { icon: ArrowUp, label: 'Send' };\n    }\n  };\n\n  const centerButton = getCenterButton();\n\n  // Determine if avatar should be \"active\" (pulsing)\n  const isAvatarActive = state === 'speaking' || state === 'processing';\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className={`fixed inset-0 z-[60] flex flex-col ${className}`}\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.3 }}\n          onClick={handleOverlayTap}\n          style={{\n            background: 'linear-gradient(180deg, rgba(15, 23, 42, 0.98) 0%, rgba(15, 23, 42, 0.95) 100%)',\n          }}\n        >\n          {/* Ambient glow at bottom */}\n          <VoiceAmbientGlow state={state} intensity={audioIntensity} />\n\n          {/* Main content - centered */}\n          <div className=\"flex-1 flex flex-col items-center justify-center px-6\">\n            {/* Avatar with glow effect */}\n            <motion.div\n              className=\"relative mb-8\"\n              initial={{ scale: 0.8, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              transition={{\n                type: 'spring',\n                stiffness: 300,\n                damping: 25,\n                delay: 0.1,\n              }}\n            >\n              {/* Glow ring behind avatar */}\n              <motion.div\n                className=\"absolute inset-0 rounded-full\"\n                animate={{\n                  boxShadow: state === 'speaking'\n                    ? '0 0 60px 20px rgba(251, 146, 60, 0.3)'\n                    : state === 'listening'\n                    ? '0 0 40px 15px rgba(34, 197, 94, 0.2)'\n                    : state === 'processing'\n                    ? '0 0 50px 18px rgba(251, 191, 36, 0.25)'\n                    : '0 0 20px 10px rgba(255, 255, 255, 0.05)',\n                  scale: state === 'speaking' ? [1, 1.1, 1] : 1,\n                }}\n                transition={{\n                  boxShadow: { duration: 0.5 },\n                  scale: { duration: 1.5, repeat: Infinity, ease: 'easeInOut' },\n                }}\n                style={{ transform: 'translate(-10%, -10%)', width: '120%', height: '120%' }}\n              />\n              <ClawAIAvatar size={120} isActive={isAvatarActive} />\n            </motion.div>\n\n            {/* Name */}\n            <motion.h2\n              className=\"text-white text-2xl font-semibold mb-2\"\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.2 }}\n            >\n              Claw AI\n            </motion.h2>\n\n            {/* Status text */}\n            <motion.div\n              key={state}\n              className=\"text-center mb-6\"\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -10 }}\n              transition={{ duration: 0.2 }}\n            >\n              <span className=\"text-white/50 text-base\">\n                {STATUS_TEXT[state]}\n              </span>\n            </motion.div>\n\n            {/* Live transcript/response display */}\n            <AnimatePresence mode=\"wait\">\n              {(transcript || response) && (\n                <motion.div\n                  className=\"max-w-sm text-center px-4\"\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -10 }}\n                >\n                  {state === 'listening' && transcript && (\n                    <p className=\"text-white/70 text-sm italic\">\"{transcript}\"</p>\n                  )}\n                  {(state === 'speaking' || state === 'processing') && response && (\n                    <p className=\"text-white/80 text-sm leading-relaxed line-clamp-4\">\n                      {response}\n                    </p>\n                  )}\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n\n          {/* Bottom control area */}\n          <div className=\"pb-10 px-4\">\n            {/* Control pill */}\n            <motion.div\n              className=\"flex items-center justify-center gap-2 mx-auto w-fit\"\n              initial={{ y: 30, opacity: 0 }}\n              animate={{ y: 0, opacity: 1 }}\n              exit={{ y: 30, opacity: 0 }}\n              transition={prefersReducedMotion ? { duration: 0.1 } : {\n                type: 'spring',\n                stiffness: 300,\n                damping: 25,\n                delay: 0.15,\n              }}\n              style={{\n                background: 'rgba(255, 255, 255, 0.08)',\n                backdropFilter: 'blur(20px)',\n                WebkitBackdropFilter: 'blur(20px)',\n                borderRadius: 40,\n                padding: '8px 12px',\n                border: '1px solid rgba(255, 255, 255, 0.1)',\n              }}\n            >\n              {/* Attach button (optional) */}\n              {onAttach && (\n                <motion.button\n                  data-control-button\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    log.action('attach_clicked');\n                    onAttach();\n                  }}\n                  className=\"w-12 h-12 rounded-full flex items-center justify-center text-white/70 hover:text-white transition-colors\"\n                  style={{ background: 'rgba(255, 255, 255, 0.1)' }}\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  aria-label=\"Attach file\"\n                >\n                  <Plus size={20} />\n                </motion.button>\n              )}\n\n              {/* Center action button */}\n              <motion.button\n                data-control-button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  log.action(`center_button_clicked state=${state}`);\n                  onTapAnywhere();\n                }}\n                className=\"w-14 h-14 rounded-full flex items-center justify-center\"\n                style={{ background: 'rgba(255, 255, 255, 0.95)' }}\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.9 }}\n                aria-label={centerButton.label}\n              >\n                <centerButton.icon size={22} className=\"text-gray-800\" />\n              </motion.button>\n\n              {/* Close button */}\n              <motion.button\n                data-control-button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  log.action('close_clicked');\n                  onClose();\n                }}\n                className=\"w-12 h-12 rounded-full flex items-center justify-center text-white/70 hover:text-white transition-colors\"\n                style={{ background: 'rgba(255, 255, 255, 0.1)' }}\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                aria-label=\"Close voice mode\"\n              >\n                <X size={20} />\n              </motion.button>\n            </motion.div>\n          </div>\n\n          {/* Screen reader announcements */}\n          <div role=\"status\" aria-live=\"polite\" className=\"sr-only\">\n            {state === 'listening' && 'Listening for your voice'}\n            {state === 'processing' && 'Processing your message'}\n            {state === 'speaking' && 'Claw AI is speaking. Tap to interrupt.'}\n          </div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n\nexport default VoiceOverlay;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2469, "column": 0}, "map": {"version":3,"sources":["file:///Users/jamesspalding/OpenClaw-OS/src/components/voice-call/index.ts"],"sourcesContent":["// Original voice call components (FaceTime-style)\nexport { VoiceCallButton } from './VoiceCallButton';\nexport { VoiceCallAvatar } from './VoiceCallAvatar';\nexport { VoiceCallWaveform } from './VoiceCallWaveform';\nexport { VoiceCallControls } from './VoiceCallControls';\nexport { VoiceCallStatus } from './VoiceCallStatus';\nexport { VoiceCallScreen } from './VoiceCallScreen';\nexport { useVoiceCall } from './useVoiceCall';\nexport type { CallStatus } from './useVoiceCall';\n\n// New voice mode components (Claude-style ambient)\nexport { VoiceAmbientGlow } from './VoiceAmbientGlow';\nexport { VoiceOverlay } from './VoiceOverlay';\nexport type { VoiceOverlayState } from './VoiceOverlay';\n"],"names":[],"mappings":";AAAA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,mDAAmD;AACnD;AACA"}}]
}